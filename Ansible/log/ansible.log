2023-06-05 15:44:03,819 p=148370 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 15:44:03,830 p=148370 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 15:44:06,382 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:44:06,420 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:06,453 p=148370 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 15:44:09,033 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 15:44:09,218 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 15:44:09,239 p=148370 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 15:44:12,833 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:13,254 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:44:13,272 p=148370 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 15:44:14,585 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:14,619 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:44:14,633 p=148370 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 15:44:16,322 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:16,370 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:44:16,390 p=148370 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 15:44:17,133 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:17,181 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:44:17,204 p=148370 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 15:44:18,606 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 15:44:18,638 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 15:44:20,089 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-05 15:44:20,179 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-05 15:44:20,217 p=148370 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 15:44:22,655 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-05 15:44:22,659 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-05 15:44:22,681 p=148370 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 15:44:26,262 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:26,457 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:44:26,476 p=148370 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 15:44:27,943 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:27,957 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:44:27,998 p=148370 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-05 15:44:30,485 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 15:44:30,497 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 15:44:30,522 p=148370 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-05 15:44:34,247 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:34,275 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:44:34,291 p=148370 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-05 15:44:35,110 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 15:44:35,145 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 15:44:35,880 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 15:44:35,885 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 15:44:35,911 p=148370 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-05 15:44:37,266 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:37,346 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:44:37,365 p=148370 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-05 15:44:37,411 p=148370 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-05 15:44:37,418 p=148370 u=morteza n=ansible | TASK [nginx : check if www dir exists {{ instance.name }}] ***************************************************************************************************
2023-06-05 15:44:38,211 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:44:38,215 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:38,231 p=148370 u=morteza n=ansible | TASK [nginx : get certificates] ******************************************************************************************************************************
2023-06-05 15:44:38,250 p=148370 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 15:44:42,317 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:42,326 p=148370 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 15:44:43,817 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:44:43,960 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:43,984 p=148370 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 15:44:45,973 p=148370 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 15:44:46,060 p=148370 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 15:44:46,118 p=148370 u=morteza n=ansible | RUNNING HANDLER [nginx : reload nginx] ***********************************************************************************************************************
2023-06-05 15:44:48,012 p=148370 u=morteza n=ansible | fatal: [app2.sudoer.net]: FAILED! => {"changed": false, "msg": "Unable to start service nginx: Job for nginx.service failed because the control process exited with error code.\nSee \"systemctl status nginx.service\" and \"journalctl -xe\" for details.\n"}
2023-06-05 15:44:48,018 p=148370 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 15:44:48,027 p=148370 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 15:44:48,027 p=148370 u=morteza n=ansible | app1.sudoer.net            : ok=19   changed=2    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-06-05 15:44:48,027 p=148370 u=morteza n=ansible | app2.sudoer.net            : ok=19   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-06-05 15:45:38,362 p=148870 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 15:45:38,374 p=148870 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 15:45:40,502 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:45:40,511 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:45:40,536 p=148870 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 15:45:43,124 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 15:45:43,282 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 15:45:43,303 p=148870 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 15:45:46,878 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:45:47,084 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:45:47,093 p=148870 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 15:45:48,318 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:45:48,384 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:45:48,407 p=148870 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 15:45:50,152 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:45:50,299 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:45:50,324 p=148870 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 15:45:51,111 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:45:51,117 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:45:51,124 p=148870 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 15:45:52,628 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 15:45:52,723 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 15:45:53,996 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-05 15:45:54,193 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-05 15:45:54,226 p=148870 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 15:45:56,880 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-05 15:45:56,963 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-05 15:45:56,985 p=148870 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 15:46:00,657 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:46:00,720 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:46:00,734 p=148870 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 15:46:02,194 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:46:02,222 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:46:02,238 p=148870 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-05 15:46:04,647 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 15:46:04,655 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 15:46:04,665 p=148870 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-05 15:46:08,368 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:46:08,700 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:46:08,708 p=148870 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-05 15:46:09,489 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 15:46:09,543 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 15:46:10,247 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 15:46:10,366 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 15:46:10,395 p=148870 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-05 15:46:11,763 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:46:11,793 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:46:11,814 p=148870 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-05 15:46:11,855 p=148870 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-05 15:46:11,863 p=148870 u=morteza n=ansible | TASK [nginx : check if www dir exists {{ instance.name }}] ***************************************************************************************************
2023-06-05 15:46:12,583 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:46:12,629 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:46:12,651 p=148870 u=morteza n=ansible | TASK [nginx : get certificates] ******************************************************************************************************************************
2023-06-05 15:46:12,673 p=148870 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 15:46:12,680 p=148870 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 15:46:12,688 p=148870 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 15:46:14,010 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:46:14,091 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:46:14,120 p=148870 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 15:46:15,462 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:46:15,600 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:46:15,695 p=148870 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 15:46:15,695 p=148870 u=morteza n=ansible | app1.sudoer.net            : ok=18   changed=0    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-06-05 15:46:15,695 p=148870 u=morteza n=ansible | app2.sudoer.net            : ok=18   changed=0    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-06-05 15:53:10,512 p=150135 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 15:53:10,524 p=150135 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 15:53:12,857 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:12,952 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:12,996 p=150135 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 15:53:15,478 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 15:53:15,602 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 15:53:15,625 p=150135 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 15:53:19,240 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:19,398 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:19,419 p=150135 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 15:53:20,677 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:20,680 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:20,702 p=150135 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 15:53:22,481 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:22,484 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:22,508 p=150135 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 15:53:23,264 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:23,305 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:23,327 p=150135 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 15:53:24,775 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 15:53:24,802 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 15:53:26,186 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-05 15:53:26,221 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-05 15:53:26,263 p=150135 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 15:53:29,051 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-05 15:53:29,801 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-05 15:53:29,811 p=150135 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 15:53:33,442 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:33,794 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:33,802 p=150135 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 15:53:35,303 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:35,334 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:35,365 p=150135 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-05 15:53:37,801 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 15:53:37,862 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 15:53:37,883 p=150135 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-05 15:53:41,444 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:41,829 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:41,852 p=150135 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-05 15:53:42,647 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 15:53:42,678 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 15:53:43,549 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 15:53:43,623 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 15:53:43,653 p=150135 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-05 15:53:44,973 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:45,091 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:45,115 p=150135 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-05 15:53:45,156 p=150135 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-05 15:53:45,163 p=150135 u=morteza n=ansible | TASK [nginx : check if www dir exists {{ instance.name }}] ***************************************************************************************************
2023-06-05 15:53:45,904 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:45,980 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:46,001 p=150135 u=morteza n=ansible | TASK [nginx : get certificates] ******************************************************************************************************************************
2023-06-05 15:53:46,020 p=150135 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 15:53:46,029 p=150135 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 15:53:46,036 p=150135 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 15:53:47,347 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:47,510 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:47,535 p=150135 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 15:53:49,060 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:49,169 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:49,206 p=150135 u=morteza n=ansible | TASK [php-fpm : Install the latest version packages] *********************************************************************************************************
2023-06-05 15:54:07,562 p=150135 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 15:54:07,855 p=150135 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 15:54:07,878 p=150135 u=morteza n=ansible | TASK [php-fpm : Update all packages] *************************************************************************************************************************
2023-06-05 15:54:11,367 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:54:11,832 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:54:11,872 p=150135 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-05 15:54:11,908 p=150135 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'localhost', 'db_charset': 'utf8'})
2023-06-05 15:54:11,915 p=150135 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-05 15:54:12,672 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:54:12,714 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:54:12,738 p=150135 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-05 15:54:13,535 p=150135 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 15:54:13,581 p=150135 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 15:54:13,607 p=150135 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-05 15:54:18,949 p=150135 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 15:54:19,109 p=150135 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 15:54:19,137 p=150135 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-05 15:54:20,139 p=150135 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 15:54:20,143 p=150135 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 15:54:20,168 p=150135 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-05 15:54:22,006 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 15:54:22,010 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 15:54:22,028 p=150135 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-05 15:54:23,295 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 15:54:23,296 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 15:54:23,318 p=150135 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-05 15:54:25,043 p=150135 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 15:54:25,078 p=150135 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 15:54:25,145 p=150135 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 15:54:25,145 p=150135 u=morteza n=ansible | app1.sudoer.net            : ok=28   changed=5    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-06-05 15:54:25,145 p=150135 u=morteza n=ansible | app2.sudoer.net            : ok=28   changed=5    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-06-05 15:56:00,038 p=150995 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 15:56:00,050 p=150995 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 15:56:00,769 p=150995 u=morteza n=ansible |  [ERROR]: User interrupted execution

2023-06-05 15:56:05,908 p=151020 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 15:56:05,920 p=151020 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 15:56:07,888 p=151020 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:56:07,998 p=151020 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:56:08,048 p=151020 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 15:56:10,491 p=151020 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 15:56:10,613 p=151020 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 15:56:10,663 p=151020 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 15:56:14,501 p=151020 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:56:14,742 p=151020 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:56:14,764 p=151020 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 15:56:16,018 p=151020 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:56:16,076 p=151020 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:56:16,099 p=151020 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 15:56:18,097 p=151020 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 15:56:18,100 p=151020 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 15:56:18,121 p=151020 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 15:56:19,011 p=151020 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:56:19,050 p=151020 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:56:19,070 p=151020 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 15:56:20,453 p=151020 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 15:56:20,511 p=151020 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 15:56:21,830 p=151020 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-05 15:56:21,971 p=151020 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-05 15:56:22,059 p=151020 u=morteza n=ansible | RUNNING HANDLER [iptables : restart iptables] ****************************************************************************************************************
2023-06-05 15:56:23,413 p=151020 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 15:56:23,495 p=151020 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 15:56:23,524 p=151020 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 15:56:23,524 p=151020 u=morteza n=ansible | app1.sudoer.net            : ok=8    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 15:56:23,525 p=151020 u=morteza n=ansible | app2.sudoer.net            : ok=8    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 15:56:42,482 p=151246 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 15:56:42,494 p=151246 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 15:56:44,577 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:56:44,706 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:56:44,738 p=151246 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 15:56:47,351 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 15:56:47,730 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 15:56:47,751 p=151246 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 15:56:51,329 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:56:51,469 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:56:51,492 p=151246 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 15:56:52,724 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:56:52,726 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:56:52,747 p=151246 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 15:56:54,411 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:56:54,429 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:56:54,454 p=151246 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 15:56:55,219 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:56:55,250 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:56:55,270 p=151246 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 15:56:56,626 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 15:56:56,846 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 15:56:57,886 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-05 15:56:58,289 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-05 15:56:58,325 p=151246 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 15:57:00,730 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-05 15:57:00,743 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-05 15:57:00,755 p=151246 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 15:57:04,345 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:57:04,711 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:57:04,719 p=151246 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 15:57:06,184 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:57:06,186 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:57:06,261 p=151246 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-05 15:57:08,654 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 15:57:08,752 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 15:57:08,782 p=151246 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-05 15:57:12,403 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:57:12,555 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:57:12,579 p=151246 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-05 15:57:13,353 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 15:57:13,455 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 15:57:14,064 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 15:57:14,226 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 15:57:14,259 p=151246 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-05 15:57:15,583 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:57:15,765 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:57:15,789 p=151246 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-05 15:57:15,830 p=151246 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-05 15:57:15,838 p=151246 u=morteza n=ansible | TASK [nginx : check if www dir exists {{ instance.name }}] ***************************************************************************************************
2023-06-05 15:57:16,643 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:57:16,683 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:57:16,704 p=151246 u=morteza n=ansible | TASK [nginx : get certificates] ******************************************************************************************************************************
2023-06-05 15:57:16,725 p=151246 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 15:57:16,733 p=151246 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 15:57:16,741 p=151246 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 15:57:18,134 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:57:18,185 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:57:18,209 p=151246 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 15:57:19,580 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:57:19,673 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:57:19,713 p=151246 u=morteza n=ansible | TASK [php-fpm : Install the latest version packages] *********************************************************************************************************
2023-06-05 15:57:22,193 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 15:57:22,246 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 15:57:22,268 p=151246 u=morteza n=ansible | TASK [php-fpm : Update all packages] *************************************************************************************************************************
2023-06-05 15:57:25,783 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:57:26,106 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:57:26,146 p=151246 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-05 15:57:26,184 p=151246 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'localhost', 'db_charset': 'utf8'})
2023-06-05 15:57:26,191 p=151246 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-05 15:57:26,940 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:57:26,980 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:57:26,992 p=151246 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-05 15:57:27,807 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:57:27,834 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:57:27,855 p=151246 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-05 15:57:27,879 p=151246 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 15:57:27,886 p=151246 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 15:57:27,893 p=151246 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-05 15:57:28,750 p=151246 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 15:57:28,845 p=151246 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 15:57:28,869 p=151246 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-05 15:57:30,914 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 15:57:30,916 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 15:57:30,940 p=151246 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-05 15:57:32,328 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 15:57:32,331 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 15:57:32,353 p=151246 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-05 15:57:33,745 p=151246 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 15:57:33,880 p=151246 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 15:57:33,946 p=151246 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 15:57:33,946 p=151246 u=morteza n=ansible | app1.sudoer.net            : ok=27   changed=2    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-06-05 15:57:33,946 p=151246 u=morteza n=ansible | app2.sudoer.net            : ok=27   changed=2    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-06-05 16:11:20,893 p=152713 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 16:11:20,905 p=152713 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 16:11:23,798 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:11:24,033 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:11:24,082 p=152713 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 16:11:26,661 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 16:11:26,795 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 16:11:26,815 p=152713 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 16:11:30,350 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:11:30,508 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:11:30,530 p=152713 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 16:11:31,842 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:11:31,856 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:11:31,878 p=152713 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 16:11:33,554 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:11:33,562 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:11:33,589 p=152713 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 16:11:34,444 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:11:34,453 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:11:34,476 p=152713 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 16:11:35,943 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 16:11:35,950 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 16:11:37,342 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-05 16:11:37,449 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-05 16:11:37,491 p=152713 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 16:11:39,937 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-05 16:11:39,980 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-05 16:11:39,995 p=152713 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 16:11:43,861 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:11:43,863 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:11:43,882 p=152713 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 16:11:45,260 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:11:45,396 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:11:45,432 p=152713 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-05 16:11:47,777 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 16:11:47,823 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 16:11:47,836 p=152713 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-05 16:11:51,439 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:11:51,479 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:11:51,500 p=152713 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-05 16:11:52,326 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 16:11:52,328 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 16:11:53,123 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 16:11:53,160 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 16:11:53,187 p=152713 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-05 16:11:54,518 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:11:54,560 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:11:54,582 p=152713 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-05 16:11:54,625 p=152713 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-05 16:11:54,632 p=152713 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 16:11:55,993 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:11:56,090 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:11:56,113 p=152713 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 16:11:57,832 p=152713 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:11:57,889 p=152713 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:11:57,930 p=152713 u=morteza n=ansible | TASK [php-fpm : Install the latest version packages] *********************************************************************************************************
2023-06-05 16:12:00,362 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 16:12:00,415 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 16:12:00,440 p=152713 u=morteza n=ansible | TASK [php-fpm : Update all packages] *************************************************************************************************************************
2023-06-05 16:12:04,209 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:12:04,283 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:12:04,313 p=152713 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-05 16:12:04,352 p=152713 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'localhost', 'db_charset': 'utf8'})
2023-06-05 16:12:04,358 p=152713 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-05 16:12:05,160 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:12:05,217 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:12:05,238 p=152713 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-05 16:12:06,026 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:12:06,095 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:12:06,119 p=152713 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-05 16:12:06,144 p=152713 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 16:12:06,152 p=152713 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 16:12:06,161 p=152713 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-05 16:12:07,070 p=152713 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:12:07,120 p=152713 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:12:07,145 p=152713 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-05 16:12:09,001 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 16:12:09,003 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 16:12:09,026 p=152713 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-05 16:12:10,484 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 16:12:10,485 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 16:12:10,492 p=152713 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-05 16:12:11,883 p=152713 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:12:11,931 p=152713 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:12:11,985 p=152713 u=morteza n=ansible | RUNNING HANDLER [nginx : reload nginx] ***********************************************************************************************************************
2023-06-05 16:12:13,786 p=152713 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:12:13,852 p=152713 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:12:13,887 p=152713 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 16:12:13,887 p=152713 u=morteza n=ansible | app1.sudoer.net            : ok=27   changed=4    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-06-05 16:12:13,888 p=152713 u=morteza n=ansible | app2.sudoer.net            : ok=27   changed=4    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-06-05 16:14:40,604 p=153485 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 16:14:40,617 p=153485 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 16:14:43,730 p=153485 u=morteza n=ansible | fatal: [db.sudoer.net]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host db.sudoer.net port 22: No route to host", "unreachable": true}
2023-06-05 16:14:43,733 p=153485 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 16:14:43,734 p=153485 u=morteza n=ansible | db.sudoer.net              : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 16:14:45,936 p=153493 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 16:14:45,948 p=153493 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 16:14:45,986 p=153493 u=morteza n=ansible | fatal: [db.sudoer.net]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host db.sudoer.net port 22: Connection refused", "unreachable": true}
2023-06-05 16:14:45,987 p=153493 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 16:14:45,987 p=153493 u=morteza n=ansible | db.sudoer.net              : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 16:14:47,438 p=153501 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 16:14:47,451 p=153501 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 16:14:50,254 p=153501 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:14:50,270 p=153501 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 16:15:06,642 p=153501 u=morteza n=ansible | changed: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 16:15:06,662 p=153501 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 16:15:10,443 p=153501 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:15:10,467 p=153501 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 16:15:11,736 p=153501 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:15:11,762 p=153501 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 16:15:13,689 p=153501 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 16:15:13,712 p=153501 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 16:15:14,537 p=153501 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 16:15:14,559 p=153501 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 16:15:16,115 p=153501 u=morteza n=ansible | changed: [db.sudoer.net] => (item=setup.sh)
2023-06-05 16:15:17,684 p=153501 u=morteza n=ansible | changed: [db.sudoer.net] => (item=config)
2023-06-05 16:15:17,718 p=153501 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 16:15:24,224 p=153501 u=morteza n=ansible | changed: [db.sudoer.net] => (item=['fail2ban'])
2023-06-05 16:15:24,246 p=153501 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 16:15:28,198 p=153501 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:15:28,218 p=153501 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 16:15:29,837 p=153501 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 16:15:29,870 p=153501 u=morteza n=ansible | TASK [mariadb : set sysctl] **********************************************************************************************************************************
2023-06-05 16:15:30,731 p=153501 u=morteza n=ansible | changed: [db.sudoer.net] => (item={'name': 'net.ipv4.ip_forward', 'value': '0'})
2023-06-05 16:15:30,754 p=153501 u=morteza n=ansible | TASK [mariadb : Install the latest version packages] *********************************************************************************************************
2023-06-05 16:15:48,530 p=153501 u=morteza n=ansible | changed: [db.sudoer.net] => (item=['mariadb-server', 'mariadb-client', 'python3-mysqldb', 'percona-toolkit'])
2023-06-05 16:15:48,552 p=153501 u=morteza n=ansible | TASK [mariadb : Update all packages] *************************************************************************************************************************
2023-06-05 16:15:52,706 p=153501 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:15:52,721 p=153501 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 16:15:53,487 p=153501 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:15:53,505 p=153501 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 16:15:53,536 p=153501 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:15:53,544 p=153501 u=morteza n=ansible | TASK [mariadb : Removes anonymous users] *********************************************************************************************************************
2023-06-05 16:15:54,440 p=153501 u=morteza n=ansible | ok: [db.sudoer.net] => (item=127.0.0.1)
2023-06-05 16:15:55,290 p=153501 u=morteza n=ansible | ok: [db.sudoer.net] => (item=localhost)
2023-06-05 16:15:55,320 p=153501 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ instance.name }}] ***********************************************************************************************************
2023-06-05 16:15:56,864 p=153501 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 16:15:56,886 p=153501 u=morteza n=ansible | TASK [mariadb : Update MariaDB root password] ****************************************************************************************************************
2023-06-05 16:15:57,651 p=153501 u=morteza n=ansible | changed: [db.sudoer.net] => (item=127.0.0.1)
2023-06-05 16:15:58,446 p=153501 u=morteza n=ansible | changed: [db.sudoer.net] => (item=localhost)
2023-06-05 16:15:58,467 p=153501 u=morteza n=ansible | TASK [mariadb : configuring instances] ***********************************************************************************************************************
2023-06-05 16:15:58,501 p=153501 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/database.yml for db.sudoer.net => (item={'name': 'sudoer_net'})
2023-06-05 16:15:58,509 p=153501 u=morteza n=ansible | TASK [mariadb : Create databases sudoer_net] *****************************************************************************************************************
2023-06-05 16:15:59,355 p=153501 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 16:15:59,374 p=153501 u=morteza n=ansible | TASK [mariadb : configuring users] ***************************************************************************************************************************
2023-06-05 16:15:59,403 p=153501 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/users.yml for db.sudoer.net => (item={'name': 'sudoer_user', 'priv': ['sudoer_net.*:ALL,GRANT']})
2023-06-05 16:15:59,412 p=153501 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 16:16:00,128 p=153501 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:16:00,151 p=153501 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 16:16:00,191 p=153501 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:16:00,199 p=153501 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf sudoer_user] *******************************************************************************************************************
2023-06-05 16:16:01,712 p=153501 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 16:16:01,735 p=153501 u=morteza n=ansible | TASK [mariadb : Create database user "sudoer_user"] **********************************************************************************************************
2023-06-05 16:16:02,541 p=153501 u=morteza n=ansible | changed: [db.sudoer.net] => (item=sudoer_net.*:ALL,GRANT)
2023-06-05 16:16:02,583 p=153501 u=morteza n=ansible | RUNNING HANDLER [iptables : restart iptables] ****************************************************************************************************************
2023-06-05 16:16:03,951 p=153501 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 16:16:03,972 p=153501 u=morteza n=ansible | RUNNING HANDLER [fail2ban : restart fail2ban] ****************************************************************************************************************
2023-06-05 16:16:05,962 p=153501 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 16:16:05,998 p=153501 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 16:16:05,998 p=153501 u=morteza n=ansible | db.sudoer.net              : ok=27   changed=15   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 16:16:10,918 p=153809 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 16:16:10,933 p=153809 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 16:16:13,548 p=153809 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:16:13,565 p=153809 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:16:13,608 p=153809 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 16:16:28,659 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 16:16:30,310 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 16:16:30,321 p=153809 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 16:16:36,052 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:16:36,315 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:16:36,337 p=153809 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 16:16:37,638 p=153809 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:16:37,696 p=153809 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:16:37,721 p=153809 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 16:16:39,792 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:16:39,895 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:16:39,916 p=153809 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 16:16:40,782 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:16:40,940 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:16:40,952 p=153809 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 16:16:42,553 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 16:16:42,645 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 16:16:44,145 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=config)
2023-06-05 16:16:44,347 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=config)
2023-06-05 16:16:44,387 p=153809 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 16:16:50,231 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-05 16:16:51,303 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-05 16:16:51,327 p=153809 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 16:16:55,102 p=153809 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:16:55,348 p=153809 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:16:55,367 p=153809 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 16:16:57,026 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:16:57,049 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:16:57,087 p=153809 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-05 16:17:10,747 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 16:17:11,069 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 16:17:11,080 p=153809 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-05 16:17:14,839 p=153809 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:17:15,035 p=153809 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:17:15,061 p=153809 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-05 16:17:15,870 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 16:17:15,895 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 16:17:16,605 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 16:17:16,677 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 16:17:16,706 p=153809 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-05 16:17:18,284 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:17:18,356 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:17:18,378 p=153809 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-05 16:17:18,421 p=153809 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-05 16:17:18,428 p=153809 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 16:17:20,001 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:17:20,090 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:17:20,105 p=153809 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 16:17:21,712 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:17:21,735 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:17:21,771 p=153809 u=morteza n=ansible | TASK [php-fpm : Install the latest version packages] *********************************************************************************************************
2023-06-05 16:17:40,069 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 16:17:40,954 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 16:17:40,978 p=153809 u=morteza n=ansible | TASK [php-fpm : Update all packages] *************************************************************************************************************************
2023-06-05 16:17:44,747 p=153809 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:17:44,782 p=153809 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:17:44,820 p=153809 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-05 16:17:44,858 p=153809 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'localhost', 'db_charset': 'utf8'})
2023-06-05 16:17:44,864 p=153809 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-05 16:17:45,630 p=153809 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:17:45,653 p=153809 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:17:45,680 p=153809 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-05 16:17:46,480 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:17:46,480 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:17:46,487 p=153809 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-05 16:17:51,930 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:17:52,008 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:17:52,025 p=153809 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-05 16:17:52,988 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:17:53,004 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:17:53,022 p=153809 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-05 16:17:54,521 p=153809 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 16:17:54,623 p=153809 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 16:17:54,647 p=153809 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-05 16:17:55,896 p=153809 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 16:17:55,897 p=153809 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 16:17:55,906 p=153809 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-05 16:17:57,618 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:17:57,622 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:17:57,679 p=153809 u=morteza n=ansible | RUNNING HANDLER [iptables : restart iptables] ****************************************************************************************************************
2023-06-05 16:17:59,123 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:17:59,249 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:17:59,267 p=153809 u=morteza n=ansible | RUNNING HANDLER [fail2ban : restart fail2ban] ****************************************************************************************************************
2023-06-05 16:18:01,003 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:18:01,300 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:18:01,320 p=153809 u=morteza n=ansible | RUNNING HANDLER [nginx : reload nginx] ***********************************************************************************************************************
2023-06-05 16:18:02,843 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:18:02,886 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:18:02,920 p=153809 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 16:18:02,920 p=153809 u=morteza n=ansible | app1.sudoer.net            : ok=30   changed=20   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 16:18:02,920 p=153809 u=morteza n=ansible | app2.sudoer.net            : ok=30   changed=20   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 16:22:37,191 p=155251 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 16:22:37,203 p=155251 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 16:22:38,934 p=155251 u=morteza n=ansible |  [ERROR]: User interrupted execution

2023-06-05 16:22:44,635 p=155281 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 16:22:44,648 p=155281 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 16:22:46,566 p=155281 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:22:46,936 p=155281 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:22:47,016 p=155281 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-05 16:22:47,054 p=155281 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'db.sudoer.net', 'db_charset': 'utf8'})
2023-06-05 16:22:47,061 p=155281 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-05 16:22:47,950 p=155281 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:22:47,987 p=155281 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:22:48,011 p=155281 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-05 16:22:49,045 p=155281 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:22:49,096 p=155281 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:22:49,114 p=155281 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-05 16:22:49,133 p=155281 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 16:22:49,140 p=155281 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 16:22:49,148 p=155281 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-05 16:22:50,014 p=155281 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:22:50,094 p=155281 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:22:50,117 p=155281 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-05 16:22:51,903 p=155281 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 16:22:51,908 p=155281 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 16:22:51,926 p=155281 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-05 16:22:53,451 p=155281 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 16:22:53,455 p=155281 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 16:22:53,479 p=155281 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-05 16:22:55,325 p=155281 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:22:55,441 p=155281 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:22:55,506 p=155281 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 16:22:55,507 p=155281 u=morteza n=ansible | app1.sudoer.net            : ok=8    changed=2    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-06-05 16:22:55,507 p=155281 u=morteza n=ansible | app2.sudoer.net            : ok=8    changed=2    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-06-05 16:54:26,523 p=158078 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 16:54:26,536 p=158078 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 16:54:28,417 p=158078 u=morteza n=ansible |  [ERROR]: User interrupted execution

2023-06-05 16:54:33,561 p=158139 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 16:54:33,573 p=158139 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 16:54:34,064 p=158139 u=morteza n=ansible |  [ERROR]: User interrupted execution

2023-06-05 16:54:36,417 p=158149 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 16:54:36,430 p=158149 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 16:54:38,525 p=158149 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:54:38,554 p=158149 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 16:54:42,685 p=158149 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 16:54:42,698 p=158149 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 16:54:47,548 p=158149 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:54:47,563 p=158149 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 16:54:48,794 p=158149 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:54:48,815 p=158149 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 16:54:50,393 p=158149 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:54:50,402 p=158149 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 16:54:51,367 p=158149 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:54:51,389 p=158149 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 16:54:52,783 p=158149 u=morteza n=ansible | ok: [db.sudoer.net] => (item=setup.sh)
2023-06-05 16:54:54,017 p=158149 u=morteza n=ansible | ok: [db.sudoer.net] => (item=config)
2023-06-05 16:54:54,053 p=158149 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 16:54:56,714 p=158149 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['fail2ban'])
2023-06-05 16:54:56,737 p=158149 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 16:55:01,601 p=158149 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:55:01,615 p=158149 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 16:55:02,989 p=158149 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:55:03,022 p=158149 u=morteza n=ansible | TASK [mariadb : set sysctl] **********************************************************************************************************************************
2023-06-05 16:55:04,227 p=158149 u=morteza n=ansible | ok: [db.sudoer.net] => (item={'name': 'net.ipv4.ip_forward', 'value': '0'})
2023-06-05 16:55:04,252 p=158149 u=morteza n=ansible | TASK [mariadb : Install the latest version packages] *********************************************************************************************************
2023-06-05 16:55:06,699 p=158149 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['mariadb-server', 'mariadb-client', 'python3-mysqldb', 'percona-toolkit'])
2023-06-05 16:55:06,722 p=158149 u=morteza n=ansible | TASK [mariadb : Update all packages] *************************************************************************************************************************
2023-06-05 16:55:10,782 p=158149 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:55:10,803 p=158149 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 16:55:11,541 p=158149 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:55:11,562 p=158149 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 16:55:11,581 p=158149 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 16:55:11,588 p=158149 u=morteza n=ansible | TASK [mariadb : Removes anonymous users] *********************************************************************************************************************
2023-06-05 16:55:12,529 p=158149 u=morteza n=ansible | ok: [db.sudoer.net] => (item=127.0.0.1)
2023-06-05 16:55:13,307 p=158149 u=morteza n=ansible | ok: [db.sudoer.net] => (item=localhost)
2023-06-05 16:55:13,336 p=158149 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ instance.name }}] ***********************************************************************************************************
2023-06-05 16:55:13,354 p=158149 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 16:55:13,362 p=158149 u=morteza n=ansible | TASK [mariadb : Update MariaDB root password] ****************************************************************************************************************
2023-06-05 16:55:13,381 p=158149 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=127.0.0.1) 
2023-06-05 16:55:13,382 p=158149 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=localhost) 
2023-06-05 16:55:13,383 p=158149 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 16:55:13,388 p=158149 u=morteza n=ansible | TASK [mariadb : configuring instances] ***********************************************************************************************************************
2023-06-05 16:55:13,408 p=158149 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/database.yml for db.sudoer.net => (item={'name': 'sudoer_net'})
2023-06-05 16:55:13,415 p=158149 u=morteza n=ansible | TASK [mariadb : Create databases sudoer_net] *****************************************************************************************************************
2023-06-05 16:55:14,356 p=158149 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:55:14,379 p=158149 u=morteza n=ansible | TASK [mariadb : configuring users] ***************************************************************************************************************************
2023-06-05 16:55:14,406 p=158149 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/users.yml for db.sudoer.net => (item={'name': 'sudoer_user', 'priv': ['sudoer_net.*:ALL,GRANT']})
2023-06-05 16:55:14,414 p=158149 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 16:55:15,216 p=158149 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:55:15,238 p=158149 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 16:55:15,258 p=158149 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 16:55:15,268 p=158149 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf sudoer_user] *******************************************************************************************************************
2023-06-05 16:55:15,281 p=158149 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 16:55:15,289 p=158149 u=morteza n=ansible | TASK [mariadb : Create database user "sudoer_user"] **********************************************************************************************************
2023-06-05 16:55:15,304 p=158149 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=sudoer_net.*:ALL,GRANT) 
2023-06-05 16:55:15,305 p=158149 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 16:55:15,328 p=158149 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 16:55:15,328 p=158149 u=morteza n=ansible | db.sudoer.net              : ok=19   changed=0    unreachable=0    failed=0    skipped=6    rescued=0    ignored=0   
2023-06-05 16:56:47,058 p=158486 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 16:56:47,071 p=158486 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 16:56:49,410 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:56:49,445 p=158486 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 16:56:52,037 p=158486 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 16:56:52,064 p=158486 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 16:56:56,107 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:56:56,128 p=158486 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 16:56:57,455 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:56:57,479 p=158486 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 16:56:59,114 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:56:59,139 p=158486 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 16:56:59,928 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:56:59,955 p=158486 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 16:57:01,292 p=158486 u=morteza n=ansible | ok: [db.sudoer.net] => (item=setup.sh)
2023-06-05 16:57:02,980 p=158486 u=morteza n=ansible | ok: [db.sudoer.net] => (item=config)
2023-06-05 16:57:03,017 p=158486 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 16:57:05,770 p=158486 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['fail2ban'])
2023-06-05 16:57:05,791 p=158486 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 16:57:10,521 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:57:10,538 p=158486 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 16:57:11,944 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:57:11,976 p=158486 u=morteza n=ansible | TASK [mariadb : set sysctl] **********************************************************************************************************************************
2023-06-05 16:57:12,898 p=158486 u=morteza n=ansible | ok: [db.sudoer.net] => (item={'name': 'net.ipv4.ip_forward', 'value': '0'})
2023-06-05 16:57:12,920 p=158486 u=morteza n=ansible | TASK [mariadb : Install the latest version packages] *********************************************************************************************************
2023-06-05 16:57:15,704 p=158486 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['mariadb-server', 'mariadb-client', 'python3-mysqldb', 'percona-toolkit'])
2023-06-05 16:57:15,727 p=158486 u=morteza n=ansible | TASK [mariadb : Update all packages] *************************************************************************************************************************
2023-06-05 16:57:19,542 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:57:19,562 p=158486 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 16:57:20,297 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:57:20,323 p=158486 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 16:57:20,346 p=158486 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 16:57:20,354 p=158486 u=morteza n=ansible | TASK [mariadb : Removes anonymous users] *********************************************************************************************************************
2023-06-05 16:57:21,256 p=158486 u=morteza n=ansible | ok: [db.sudoer.net] => (item=127.0.0.1)
2023-06-05 16:57:22,021 p=158486 u=morteza n=ansible | ok: [db.sudoer.net] => (item=localhost)
2023-06-05 16:57:22,055 p=158486 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ instance.name }}] ***********************************************************************************************************
2023-06-05 16:57:22,071 p=158486 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 16:57:22,078 p=158486 u=morteza n=ansible | TASK [mariadb : Update MariaDB root password] ****************************************************************************************************************
2023-06-05 16:57:22,098 p=158486 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=127.0.0.1) 
2023-06-05 16:57:22,099 p=158486 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=localhost) 
2023-06-05 16:57:22,100 p=158486 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 16:57:22,106 p=158486 u=morteza n=ansible | TASK [mariadb : configuring instances] ***********************************************************************************************************************
2023-06-05 16:57:22,127 p=158486 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/database.yml for db.sudoer.net => (item={'name': 'sudoer_net'})
2023-06-05 16:57:22,134 p=158486 u=morteza n=ansible | TASK [mariadb : Create databases sudoer_net] *****************************************************************************************************************
2023-06-05 16:57:23,077 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:57:23,097 p=158486 u=morteza n=ansible | TASK [mariadb : configuring users] ***************************************************************************************************************************
2023-06-05 16:57:23,137 p=158486 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/users.yml for db.sudoer.net => (item={'name': 'sudoer_user', 'priv': ['sudoer_net.*:ALL,GRANT']})
2023-06-05 16:57:23,145 p=158486 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 16:57:23,919 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:57:23,942 p=158486 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 16:57:23,977 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:57:23,984 p=158486 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf sudoer_user] *******************************************************************************************************************
2023-06-05 16:57:25,622 p=158486 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 16:57:25,647 p=158486 u=morteza n=ansible | TASK [mariadb : Create database user "sudoer_user"] **********************************************************************************************************
2023-06-05 16:57:26,443 p=158486 u=morteza n=ansible | changed: [db.sudoer.net] => (item=sudoer_net.*:ALL,GRANT)
2023-06-05 16:57:26,497 p=158486 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 16:57:26,497 p=158486 u=morteza n=ansible | db.sudoer.net              : ok=22   changed=2    unreachable=0    failed=0    skipped=3    rescued=0    ignored=0   
2023-06-05 17:22:59,045 p=160123 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 17:22:59,057 p=160123 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:23:01,415 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:01,451 p=160123 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:23:04,308 p=160123 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:23:04,333 p=160123 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:23:08,469 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:08,490 p=160123 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 17:23:09,727 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:09,733 p=160123 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 17:23:11,436 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:11,457 p=160123 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 17:23:12,177 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:12,199 p=160123 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 17:23:13,530 p=160123 u=morteza n=ansible | ok: [db.sudoer.net] => (item=setup.sh)
2023-06-05 17:23:14,835 p=160123 u=morteza n=ansible | ok: [db.sudoer.net] => (item=config)
2023-06-05 17:23:14,851 p=160123 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:23:17,442 p=160123 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:23:17,464 p=160123 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 17:23:21,302 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:21,321 p=160123 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 17:23:22,853 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:22,883 p=160123 u=morteza n=ansible | TASK [mariadb : set sysctl] **********************************************************************************************************************************
2023-06-05 17:23:23,699 p=160123 u=morteza n=ansible | ok: [db.sudoer.net] => (item={'name': 'net.ipv4.ip_forward', 'value': '0'})
2023-06-05 17:23:23,719 p=160123 u=morteza n=ansible | TASK [mariadb : Install the latest version packages] *********************************************************************************************************
2023-06-05 17:23:26,191 p=160123 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['mariadb-server', 'mariadb-client', 'python3-mysqldb', 'percona-toolkit'])
2023-06-05 17:23:26,208 p=160123 u=morteza n=ansible | TASK [mariadb : Update all packages] *************************************************************************************************************************
2023-06-05 17:23:30,041 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:30,063 p=160123 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 17:23:30,848 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:30,870 p=160123 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 17:23:30,896 p=160123 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:23:30,905 p=160123 u=morteza n=ansible | TASK [mariadb : Removes anonymous users] *********************************************************************************************************************
2023-06-05 17:23:31,821 p=160123 u=morteza n=ansible | ok: [db.sudoer.net] => (item=127.0.0.1)
2023-06-05 17:23:32,603 p=160123 u=morteza n=ansible | ok: [db.sudoer.net] => (item=localhost)
2023-06-05 17:23:32,632 p=160123 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ instance.name }}] ***********************************************************************************************************
2023-06-05 17:23:32,645 p=160123 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:23:32,652 p=160123 u=morteza n=ansible | TASK [mariadb : Update MariaDB root password] ****************************************************************************************************************
2023-06-05 17:23:32,667 p=160123 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=127.0.0.1) 
2023-06-05 17:23:32,668 p=160123 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=localhost) 
2023-06-05 17:23:32,669 p=160123 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:23:32,675 p=160123 u=morteza n=ansible | TASK [mariadb : configuring instances] ***********************************************************************************************************************
2023-06-05 17:23:32,693 p=160123 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/database.yml for db.sudoer.net => (item={'name': 'sudoer_net'})
2023-06-05 17:23:32,701 p=160123 u=morteza n=ansible | TASK [mariadb : Create databases sudoer_net] *****************************************************************************************************************
2023-06-05 17:23:33,562 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:33,582 p=160123 u=morteza n=ansible | TASK [mariadb : configuring users] ***************************************************************************************************************************
2023-06-05 17:23:33,622 p=160123 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/users.yml for db.sudoer.net => (item={'name': 'sudoer_user', 'priv': ['sudoer_net.*:ALL,GRANT']})
2023-06-05 17:23:33,630 p=160123 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 17:23:34,337 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:34,358 p=160123 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 17:23:34,394 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:34,401 p=160123 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf sudoer_user] *******************************************************************************************************************
2023-06-05 17:23:36,268 p=160123 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 17:23:36,276 p=160123 u=morteza n=ansible | TASK [mariadb : Create database user "sudoer_user"] **********************************************************************************************************
2023-06-05 17:23:37,063 p=160123 u=morteza n=ansible | changed: [db.sudoer.net] => (item=sudoer_net.*:ALL,GRANT)
2023-06-05 17:23:37,105 p=160123 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 17:23:37,105 p=160123 u=morteza n=ansible | db.sudoer.net              : ok=22   changed=2    unreachable=0    failed=0    skipped=3    rescued=0    ignored=0   
2023-06-05 17:25:03,095 p=160580 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 17:25:03,109 p=160580 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:25:05,797 p=160580 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:05,803 p=160580 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:05,904 p=160580 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 17:25:05,904 p=160580 u=morteza n=ansible | app1.sudoer.net            : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 17:25:05,904 p=160580 u=morteza n=ansible | app2.sudoer.net            : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 17:25:09,520 p=160614 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 17:25:09,532 p=160614 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:25:11,510 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:11,514 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:11,534 p=160614 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:25:14,819 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:25:15,091 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:25:15,113 p=160614 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:25:18,651 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:18,765 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:18,786 p=160614 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 17:25:19,924 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:20,032 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:20,053 p=160614 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 17:25:21,916 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:21,948 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:21,965 p=160614 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 17:25:22,771 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:22,973 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:22,995 p=160614 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 17:25:24,475 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 17:25:24,526 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 17:25:25,864 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-05 17:25:25,871 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-05 17:25:25,898 p=160614 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:25:28,271 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:25:28,377 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:25:28,403 p=160614 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 17:25:32,105 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:32,145 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:32,156 p=160614 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 17:25:33,553 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:33,564 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:33,603 p=160614 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-05 17:25:35,985 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 17:25:36,084 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 17:25:36,106 p=160614 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-05 17:25:39,679 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:39,914 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:39,938 p=160614 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-05 17:25:40,818 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 17:25:40,858 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 17:25:41,548 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 17:25:41,603 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 17:25:41,631 p=160614 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-05 17:25:43,084 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:43,088 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:43,111 p=160614 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-05 17:25:43,154 p=160614 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-05 17:25:43,162 p=160614 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 17:25:44,496 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:44,561 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:44,584 p=160614 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 17:25:45,955 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:46,041 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:46,083 p=160614 u=morteza n=ansible | TASK [php-fpm : Install the latest version packages] *********************************************************************************************************
2023-06-05 17:25:48,409 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 17:25:48,526 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 17:25:48,545 p=160614 u=morteza n=ansible | TASK [php-fpm : Update all packages] *************************************************************************************************************************
2023-06-05 17:25:52,026 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:52,180 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:52,219 p=160614 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-05 17:25:52,256 p=160614 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'db.sudoer.net', 'db_charset': 'utf8'})
2023-06-05 17:25:52,263 p=160614 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-05 17:25:53,078 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:53,087 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:53,111 p=160614 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-05 17:25:53,873 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:53,894 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:53,912 p=160614 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-05 17:25:53,930 p=160614 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 17:25:53,938 p=160614 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 17:25:53,947 p=160614 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-05 17:25:54,790 p=160614 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:25:54,847 p=160614 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:25:54,870 p=160614 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-05 17:25:56,569 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 17:25:56,573 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 17:25:56,595 p=160614 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-05 17:25:58,013 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 17:25:58,015 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 17:25:58,036 p=160614 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-05 17:25:59,774 p=160614 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:25:59,835 p=160614 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:25:59,896 p=160614 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 17:25:59,896 p=160614 u=morteza n=ansible | app1.sudoer.net            : ok=26   changed=2    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-06-05 17:25:59,896 p=160614 u=morteza n=ansible | app2.sudoer.net            : ok=26   changed=2    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-06-05 17:32:12,571 p=161714 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 17:32:12,583 p=161714 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:32:14,961 p=161714 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:32:14,975 p=161714 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:32:15,033 p=161714 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-05 17:32:15,069 p=161714 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'db.sudoer.net', 'db_charset': 'utf8'})
2023-06-05 17:32:15,077 p=161714 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-05 17:32:15,978 p=161714 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:32:15,992 p=161714 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:32:16,010 p=161714 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-05 17:32:16,956 p=161714 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:32:16,978 p=161714 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:32:16,988 p=161714 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-05 17:32:17,010 p=161714 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 17:32:17,019 p=161714 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 17:32:17,026 p=161714 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-05 17:32:17,043 p=161714 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 17:32:17,051 p=161714 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 17:32:17,058 p=161714 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-05 17:32:18,754 p=161714 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 17:32:18,757 p=161714 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 17:32:18,776 p=161714 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-05 17:32:20,202 p=161714 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 17:32:20,204 p=161714 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 17:32:20,228 p=161714 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-05 17:32:21,639 p=161714 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:32:21,702 p=161714 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:32:21,766 p=161714 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 17:32:21,766 p=161714 u=morteza n=ansible | app1.sudoer.net            : ok=7    changed=0    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-06-05 17:32:21,766 p=161714 u=morteza n=ansible | app2.sudoer.net            : ok=7    changed=0    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-06-05 17:32:28,134 p=161863 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 17:32:28,146 p=161863 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:32:30,170 p=161863 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:32:30,321 p=161863 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:32:30,370 p=161863 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:32:32,818 p=161863 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:32:32,905 p=161863 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:32:32,926 p=161863 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:32:36,570 p=161863 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:32:36,673 p=161863 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:32:36,695 p=161863 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 17:32:37,929 p=161863 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:32:38,012 p=161863 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:32:38,017 p=161863 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 17:32:39,621 p=161863 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:32:39,647 p=161863 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:32:39,659 p=161863 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 17:32:40,431 p=161863 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:32:40,434 p=161863 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:32:40,458 p=161863 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 17:32:41,874 p=161863 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 17:32:41,892 p=161863 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 17:32:43,217 p=161863 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-05 17:32:43,345 p=161863 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-05 17:32:43,385 p=161863 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:32:45,803 p=161863 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:32:45,834 p=161863 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:32:45,853 p=161863 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 17:32:49,360 p=161863 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:32:49,624 p=161863 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:32:49,649 p=161863 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 17:32:50,430 p=161863 u=morteza n=ansible |  [ERROR]: User interrupted execution

2023-06-05 17:33:28,365 p=162131 u=morteza n=ansible | [WARNING]: While constructing a mapping from /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/playbooks/all.yml, line 3, column 1, found a duplicate
dict key (include). Using last defined value only.

2023-06-05 17:33:28,366 p=162131 u=morteza n=ansible | ERROR! A playbook must be a list of plays, got a <class 'ansible.parsing.yaml.objects.AnsibleMapping'> instead: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/playbooks/all.yml

The error appears to be in '/home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/playbooks/all.yml': line 3, column 1, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:


include: db.yml
^ here

2023-06-05 17:34:30,810 p=162300 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 17:34:30,821 p=162300 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:34:33,136 p=162300 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:34:33,163 p=162300 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:34:35,758 p=162300 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:34:35,780 p=162300 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:34:36,461 p=162300 u=morteza n=ansible |  [ERROR]: User interrupted execution

2023-06-05 17:37:34,258 p=162495 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 17:37:34,270 p=162495 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:37:36,971 p=162495 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:37:37,013 p=162495 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:37:51,712 p=162495 u=morteza n=ansible | changed: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:37:51,736 p=162495 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:37:55,260 p=162495 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:37:55,270 p=162495 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 17:37:56,506 p=162495 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:37:56,529 p=162495 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 17:37:58,367 p=162495 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 17:37:58,381 p=162495 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 17:37:59,194 p=162495 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 17:37:59,217 p=162495 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 17:38:00,743 p=162495 u=morteza n=ansible |  [ERROR]: User interrupted execution

2023-06-05 17:38:27,849 p=162611 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 17:38:27,861 p=162611 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:38:29,870 p=162611 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:38:29,893 p=162611 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:38:32,521 p=162611 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:38:32,543 p=162611 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:38:36,252 p=162611 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:38:36,267 p=162611 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 17:38:37,504 p=162611 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:38:37,529 p=162611 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 17:38:39,144 p=162611 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:38:39,162 p=162611 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 17:38:39,826 p=162611 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:38:39,853 p=162611 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 17:38:41,502 p=162611 u=morteza n=ansible | changed: [db.sudoer.net] => (item=setup.sh)
2023-06-05 17:38:42,942 p=162611 u=morteza n=ansible | changed: [db.sudoer.net] => (item=config)
2023-06-05 17:38:42,975 p=162611 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:38:49,154 p=162611 u=morteza n=ansible | changed: [db.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:38:49,177 p=162611 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 17:38:53,018 p=162611 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:38:53,035 p=162611 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 17:38:54,548 p=162611 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 17:38:54,579 p=162611 u=morteza n=ansible | TASK [mariadb : set sysctl] **********************************************************************************************************************************
2023-06-05 17:38:55,439 p=162611 u=morteza n=ansible | changed: [db.sudoer.net] => (item={'name': 'net.ipv4.ip_forward', 'value': '0'})
2023-06-05 17:38:55,450 p=162611 u=morteza n=ansible | TASK [mariadb : Install the latest version packages] *********************************************************************************************************
2023-06-05 17:39:12,307 p=162611 u=morteza n=ansible | changed: [db.sudoer.net] => (item=['mariadb-server', 'mariadb-client', 'python3-mysqldb', 'percona-toolkit'])
2023-06-05 17:39:12,329 p=162611 u=morteza n=ansible | TASK [mariadb : Update all packages] *************************************************************************************************************************
2023-06-05 17:39:15,908 p=162611 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:39:15,929 p=162611 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 17:39:16,599 p=162611 u=morteza n=ansible |  [ERROR]: User interrupted execution

2023-06-05 17:42:40,969 p=163053 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 17:42:40,981 p=163053 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:42:43,258 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:42:43,285 p=163053 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:47:48,457 p=163053 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:47:48,468 p=163053 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:47:52,388 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:47:52,401 p=163053 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 17:47:53,556 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:47:53,569 p=163053 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 17:47:55,090 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:47:55,113 p=163053 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 17:47:55,807 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:47:55,815 p=163053 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 17:47:57,003 p=163053 u=morteza n=ansible | ok: [db.sudoer.net] => (item=setup.sh)
2023-06-05 17:47:58,211 p=163053 u=morteza n=ansible | ok: [db.sudoer.net] => (item=config)
2023-06-05 17:47:58,244 p=163053 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:48:01,212 p=163053 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:48:01,233 p=163053 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 17:48:04,925 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:48:04,930 p=163053 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 17:48:06,285 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:48:06,313 p=163053 u=morteza n=ansible | TASK [mariadb : set sysctl] **********************************************************************************************************************************
2023-06-05 17:48:07,094 p=163053 u=morteza n=ansible | ok: [db.sudoer.net] => (item={'name': 'net.ipv4.ip_forward', 'value': '0'})
2023-06-05 17:48:07,113 p=163053 u=morteza n=ansible | TASK [mariadb : Install the latest version packages] *********************************************************************************************************
2023-06-05 17:48:09,373 p=163053 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['mariadb-server', 'mariadb-client', 'python3-mysqldb', 'percona-toolkit'])
2023-06-05 17:48:09,381 p=163053 u=morteza n=ansible | TASK [mariadb : Update all packages] *************************************************************************************************************************
2023-06-05 17:48:13,146 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:48:13,165 p=163053 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 17:48:13,840 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:48:13,856 p=163053 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 17:48:13,893 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:48:13,899 p=163053 u=morteza n=ansible | TASK [mariadb : Removes anonymous users] *********************************************************************************************************************
2023-06-05 17:48:14,773 p=163053 u=morteza n=ansible | ok: [db.sudoer.net] => (item=127.0.0.1)
2023-06-05 17:48:15,495 p=163053 u=morteza n=ansible | ok: [db.sudoer.net] => (item=localhost)
2023-06-05 17:48:15,508 p=163053 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ instance.name }}] ***********************************************************************************************************
2023-06-05 17:48:17,036 p=163053 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 17:48:17,059 p=163053 u=morteza n=ansible | TASK [mariadb : Update MariaDB root password] ****************************************************************************************************************
2023-06-05 17:48:17,766 p=163053 u=morteza n=ansible | changed: [db.sudoer.net] => (item=127.0.0.1)
2023-06-05 17:48:18,459 p=163053 u=morteza n=ansible | changed: [db.sudoer.net] => (item=localhost)
2023-06-05 17:48:18,485 p=163053 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ user.name }}] ***************************************************************************************************************
2023-06-05 17:48:19,975 p=163053 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 17:48:20,000 p=163053 u=morteza n=ansible | TASK [mariadb : configuring instances] ***********************************************************************************************************************
2023-06-05 17:48:20,032 p=163053 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/database.yml for db.sudoer.net => (item={'name': 'sudoer_net'})
2023-06-05 17:48:20,041 p=163053 u=morteza n=ansible | TASK [mariadb : Create databases sudoer_net] *****************************************************************************************************************
2023-06-05 17:48:21,159 p=163053 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 17:48:21,165 p=163053 u=morteza n=ansible | TASK [mariadb : configuring users] ***************************************************************************************************************************
2023-06-05 17:48:21,192 p=163053 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/users.yml for db.sudoer.net => (item={'name': 'sudoer_user', 'priv': ['sudoer_net.*:ALL,GRANT']})
2023-06-05 17:48:21,200 p=163053 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 17:48:21,874 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:48:21,880 p=163053 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 17:48:21,916 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:48:21,924 p=163053 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf sudoer_user] *******************************************************************************************************************
2023-06-05 17:48:23,226 p=163053 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 17:48:23,253 p=163053 u=morteza n=ansible | TASK [mariadb : Create database user "sudoer_user"] **********************************************************************************************************
2023-06-05 17:48:23,963 p=163053 u=morteza n=ansible | changed: [db.sudoer.net] => (item=sudoer_net.*:ALL,GRANT)
2023-06-05 17:48:24,025 p=163053 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 17:48:24,037 p=163053 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:48:26,343 p=163053 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:48:26,413 p=163053 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:48:26,449 p=163053 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:48:40,446 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:48:42,034 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:48:42,046 p=163053 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:48:47,563 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:48:48,161 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:48:48,172 p=163053 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 17:48:49,287 p=163053 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:48:49,379 p=163053 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:48:49,400 p=163053 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 17:48:51,279 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:48:51,340 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:48:51,359 p=163053 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 17:48:52,044 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:48:52,084 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:48:52,096 p=163053 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 17:48:53,746 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 17:48:53,846 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 17:48:55,312 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=config)
2023-06-05 17:48:55,492 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=config)
2023-06-05 17:48:55,534 p=163053 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:49:01,184 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:49:01,544 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:49:01,570 p=163053 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 17:49:05,108 p=163053 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:49:05,206 p=163053 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:49:05,225 p=163053 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 17:49:06,787 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:49:06,917 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:49:06,955 p=163053 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-05 17:49:20,005 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 17:49:20,640 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 17:49:20,650 p=163053 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-05 17:49:24,141 p=163053 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:49:24,187 p=163053 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:49:24,193 p=163053 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-05 17:49:24,962 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 17:49:24,964 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 17:49:25,723 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 17:49:25,727 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 17:49:25,737 p=163053 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-05 17:49:27,336 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:49:27,395 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:49:27,407 p=163053 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-05 17:49:27,445 p=163053 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-05 17:49:27,453 p=163053 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 17:49:29,012 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:49:29,022 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:49:29,030 p=163053 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 17:49:30,561 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:49:30,693 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:49:30,725 p=163053 u=morteza n=ansible | TASK [php-fpm : Install the latest version packages] *********************************************************************************************************
2023-06-05 17:49:48,151 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 17:49:49,822 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 17:49:49,848 p=163053 u=morteza n=ansible | TASK [php-fpm : Update all packages] *************************************************************************************************************************
2023-06-05 17:49:53,310 p=163053 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:49:53,761 p=163053 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:49:53,796 p=163053 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-05 17:49:53,838 p=163053 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'db.sudoer.net', 'db_charset': 'utf8'})
2023-06-05 17:49:53,845 p=163053 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-05 17:49:54,562 p=163053 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:49:54,616 p=163053 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:49:54,629 p=163053 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-05 17:49:55,366 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:49:55,400 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:49:55,408 p=163053 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-05 17:50:00,599 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:50:00,741 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:50:00,763 p=163053 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-05 17:50:01,718 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:50:01,722 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:50:01,743 p=163053 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-05 17:50:03,154 p=163053 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 17:50:03,155 p=163053 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 17:50:03,167 p=163053 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-05 17:50:04,274 p=163053 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 17:50:04,275 p=163053 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 17:50:04,288 p=163053 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-05 17:50:05,831 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:50:05,905 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:50:05,955 p=163053 u=morteza n=ansible | RUNNING HANDLER [iptables : restart iptables] ****************************************************************************************************************
2023-06-05 17:50:07,371 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:50:07,375 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:50:07,383 p=163053 u=morteza n=ansible | RUNNING HANDLER [fail2ban : restart fail2ban] ****************************************************************************************************************
2023-06-05 17:50:08,824 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:50:09,436 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:50:09,444 p=163053 u=morteza n=ansible | RUNNING HANDLER [nginx : reload nginx] ***********************************************************************************************************************
2023-06-05 17:50:10,949 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:50:11,071 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:50:11,113 p=163053 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 17:50:11,113 p=163053 u=morteza n=ansible | app1.sudoer.net            : ok=30   changed=20   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 17:50:11,113 p=163053 u=morteza n=ansible | app2.sudoer.net            : ok=30   changed=20   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 17:50:11,113 p=163053 u=morteza n=ansible | db.sudoer.net              : ok=26   changed=6    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 17:51:27,312 p=164487 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 17:51:27,323 p=164487 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:51:29,555 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:51:29,571 p=164487 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:51:32,314 p=164487 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:51:32,338 p=164487 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:51:36,600 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:51:36,610 p=164487 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 17:51:37,804 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:51:37,823 p=164487 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 17:51:39,349 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:51:39,355 p=164487 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 17:51:40,010 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:51:40,017 p=164487 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 17:51:41,257 p=164487 u=morteza n=ansible | ok: [db.sudoer.net] => (item=setup.sh)
2023-06-05 17:51:42,367 p=164487 u=morteza n=ansible | ok: [db.sudoer.net] => (item=config)
2023-06-05 17:51:42,386 p=164487 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:51:44,766 p=164487 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:51:44,776 p=164487 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 17:51:48,335 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:51:48,349 p=164487 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 17:51:49,661 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:51:49,683 p=164487 u=morteza n=ansible | TASK [mariadb : set sysctl] **********************************************************************************************************************************
2023-06-05 17:51:50,457 p=164487 u=morteza n=ansible | ok: [db.sudoer.net] => (item={'name': 'net.ipv4.ip_forward', 'value': '0'})
2023-06-05 17:51:50,464 p=164487 u=morteza n=ansible | TASK [mariadb : Install the latest version packages] *********************************************************************************************************
2023-06-05 17:51:52,728 p=164487 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['mariadb-server', 'mariadb-client', 'python3-mysqldb', 'percona-toolkit'])
2023-06-05 17:51:52,749 p=164487 u=morteza n=ansible | TASK [mariadb : Update all packages] *************************************************************************************************************************
2023-06-05 17:51:56,451 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:51:56,473 p=164487 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 17:51:57,231 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:51:57,249 p=164487 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 17:51:57,271 p=164487 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:51:57,277 p=164487 u=morteza n=ansible | TASK [mariadb : Removes anonymous users] *********************************************************************************************************************
2023-06-05 17:51:58,146 p=164487 u=morteza n=ansible | ok: [db.sudoer.net] => (item=127.0.0.1)
2023-06-05 17:51:58,844 p=164487 u=morteza n=ansible | ok: [db.sudoer.net] => (item=localhost)
2023-06-05 17:51:58,874 p=164487 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ instance.name }}] ***********************************************************************************************************
2023-06-05 17:51:58,890 p=164487 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:51:58,896 p=164487 u=morteza n=ansible | TASK [mariadb : Update MariaDB root password] ****************************************************************************************************************
2023-06-05 17:51:58,913 p=164487 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=127.0.0.1) 
2023-06-05 17:51:58,914 p=164487 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=localhost) 
2023-06-05 17:51:58,915 p=164487 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:51:58,922 p=164487 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ user.name }}] ***************************************************************************************************************
2023-06-05 17:52:00,249 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:52:00,266 p=164487 u=morteza n=ansible | TASK [mariadb : configuring instances] ***********************************************************************************************************************
2023-06-05 17:52:00,293 p=164487 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/database.yml for db.sudoer.net => (item={'name': 'sudoer_net'})
2023-06-05 17:52:00,302 p=164487 u=morteza n=ansible | TASK [mariadb : Create databases sudoer_net] *****************************************************************************************************************
2023-06-05 17:52:01,172 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:52:01,188 p=164487 u=morteza n=ansible | TASK [mariadb : configuring users] ***************************************************************************************************************************
2023-06-05 17:52:01,220 p=164487 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/users.yml for db.sudoer.net => (item={'name': 'sudoer_user', 'priv': ['sudoer_net.*:ALL,GRANT']})
2023-06-05 17:52:01,228 p=164487 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 17:52:01,934 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:52:01,942 p=164487 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 17:52:01,957 p=164487 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:52:01,967 p=164487 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf sudoer_user] *******************************************************************************************************************
2023-06-05 17:52:01,981 p=164487 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:52:01,989 p=164487 u=morteza n=ansible | TASK [mariadb : Create database user "sudoer_user"] **********************************************************************************************************
2023-06-05 17:52:02,007 p=164487 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=sudoer_net.*:ALL,GRANT) 
2023-06-05 17:52:02,008 p=164487 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:52:02,041 p=164487 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 17:52:02,051 p=164487 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:52:04,185 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:04,350 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:04,391 p=164487 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:52:06,675 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:52:06,852 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:52:06,860 p=164487 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:52:10,257 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:10,679 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:10,699 p=164487 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 17:52:11,709 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:11,858 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:11,873 p=164487 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 17:52:13,338 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:13,370 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:13,390 p=164487 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 17:52:14,179 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:14,180 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:14,199 p=164487 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 17:52:15,432 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 17:52:15,526 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 17:52:16,638 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-05 17:52:16,859 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-05 17:52:16,893 p=164487 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:52:19,131 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:52:19,612 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:52:19,622 p=164487 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 17:52:23,061 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:23,290 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:23,311 p=164487 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 17:52:24,646 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:24,721 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:24,742 p=164487 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-05 17:52:27,062 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 17:52:27,083 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 17:52:27,097 p=164487 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-05 17:52:30,893 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:30,928 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:30,948 p=164487 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-05 17:52:31,641 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 17:52:31,697 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 17:52:32,421 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 17:52:32,475 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 17:52:32,485 p=164487 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-05 17:52:33,765 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:33,813 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:33,820 p=164487 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-05 17:52:33,860 p=164487 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-05 17:52:33,867 p=164487 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 17:52:35,077 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:35,168 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:35,178 p=164487 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 17:52:36,470 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:36,498 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:36,527 p=164487 u=morteza n=ansible | TASK [php-fpm : Install the latest version packages] *********************************************************************************************************
2023-06-05 17:52:38,891 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 17:52:39,057 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 17:52:39,077 p=164487 u=morteza n=ansible | TASK [php-fpm : Update all packages] *************************************************************************************************************************
2023-06-05 17:52:42,631 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:43,619 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:43,635 p=164487 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-05 17:52:43,675 p=164487 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'db.sudoer.net', 'db_charset': 'utf8'})
2023-06-05 17:52:43,682 p=164487 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-05 17:52:44,497 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:44,513 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:44,525 p=164487 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-05 17:52:45,289 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:45,315 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:45,325 p=164487 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-05 17:52:45,345 p=164487 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 17:52:45,357 p=164487 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 17:52:45,369 p=164487 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-05 17:52:45,389 p=164487 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 17:52:45,399 p=164487 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 17:52:45,411 p=164487 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-05 17:52:46,392 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 17:52:46,396 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 17:52:46,413 p=164487 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-05 17:52:47,345 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 17:52:47,347 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 17:52:47,356 p=164487 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-05 17:52:48,669 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:48,726 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:48,788 p=164487 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 17:52:48,788 p=164487 u=morteza n=ansible | app1.sudoer.net            : ok=25   changed=0    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-06-05 17:52:48,788 p=164487 u=morteza n=ansible | app2.sudoer.net            : ok=25   changed=0    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-06-05 17:52:48,788 p=164487 u=morteza n=ansible | db.sudoer.net              : ok=20   changed=0    unreachable=0    failed=0    skipped=6    rescued=0    ignored=0   
2023-06-05 17:55:55,341 p=165484 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 17:55:55,354 p=165484 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:55:57,789 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:55:57,817 p=165484 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:56:00,437 p=165484 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:56:00,458 p=165484 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:56:04,250 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:56:04,268 p=165484 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 17:56:05,566 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:56:05,577 p=165484 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 17:56:07,164 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:56:07,171 p=165484 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 17:56:07,822 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:56:07,828 p=165484 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 17:56:09,303 p=165484 u=morteza n=ansible | ok: [db.sudoer.net] => (item=setup.sh)
2023-06-05 17:56:10,555 p=165484 u=morteza n=ansible | ok: [db.sudoer.net] => (item=config)
2023-06-05 17:56:10,588 p=165484 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:56:13,419 p=165484 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:56:13,440 p=165484 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 17:56:17,145 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:56:17,166 p=165484 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 17:56:18,523 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:56:18,557 p=165484 u=morteza n=ansible | TASK [mariadb : set sysctl] **********************************************************************************************************************************
2023-06-05 17:56:19,449 p=165484 u=morteza n=ansible | ok: [db.sudoer.net] => (item={'name': 'net.ipv4.ip_forward', 'value': '0'})
2023-06-05 17:56:19,473 p=165484 u=morteza n=ansible | TASK [mariadb : Install the latest version packages] *********************************************************************************************************
2023-06-05 17:56:21,848 p=165484 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['mariadb-server', 'mariadb-client', 'python3-mysqldb', 'percona-toolkit'])
2023-06-05 17:56:21,873 p=165484 u=morteza n=ansible | TASK [mariadb : Update all packages] *************************************************************************************************************************
2023-06-05 17:56:26,040 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:56:26,061 p=165484 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 17:56:26,767 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:56:26,788 p=165484 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 17:56:26,809 p=165484 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:56:26,817 p=165484 u=morteza n=ansible | TASK [mariadb : Removes anonymous users] *********************************************************************************************************************
2023-06-05 17:56:27,687 p=165484 u=morteza n=ansible | ok: [db.sudoer.net] => (item=127.0.0.1)
2023-06-05 17:56:28,473 p=165484 u=morteza n=ansible | ok: [db.sudoer.net] => (item=localhost)
2023-06-05 17:56:28,502 p=165484 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ instance.name }}] ***********************************************************************************************************
2023-06-05 17:56:28,517 p=165484 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:56:28,525 p=165484 u=morteza n=ansible | TASK [mariadb : Update MariaDB root password] ****************************************************************************************************************
2023-06-05 17:56:28,541 p=165484 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=127.0.0.1) 
2023-06-05 17:56:28,542 p=165484 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=localhost) 
2023-06-05 17:56:28,543 p=165484 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:56:28,550 p=165484 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ user.name }}] ***************************************************************************************************************
2023-06-05 17:56:29,837 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:56:29,844 p=165484 u=morteza n=ansible | TASK [mariadb : configuring instances] ***********************************************************************************************************************
2023-06-05 17:56:29,874 p=165484 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/database.yml for db.sudoer.net => (item={'name': 'sudoer_net'})
2023-06-05 17:56:29,886 p=165484 u=morteza n=ansible | TASK [mariadb : Create databases sudoer_net] *****************************************************************************************************************
2023-06-05 17:56:30,770 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:56:30,790 p=165484 u=morteza n=ansible | TASK [mariadb : configuring users] ***************************************************************************************************************************
2023-06-05 17:56:30,829 p=165484 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/users.yml for db.sudoer.net => (item={'name': 'sudoer_user', 'priv': ['sudoer_net.*:ALL,GRANT']})
2023-06-05 17:56:30,837 p=165484 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 17:56:31,528 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:56:31,534 p=165484 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 17:56:31,554 p=165484 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:56:31,562 p=165484 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf sudoer_user] *******************************************************************************************************************
2023-06-05 17:56:31,576 p=165484 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:56:31,584 p=165484 u=morteza n=ansible | TASK [mariadb : Create database user "sudoer_user"] **********************************************************************************************************
2023-06-05 17:56:31,605 p=165484 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=sudoer_net.*:ALL,GRANT) 
2023-06-05 17:56:31,606 p=165484 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:56:31,634 p=165484 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 17:56:31,644 p=165484 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:56:33,716 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:56:34,015 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:56:34,041 p=165484 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:56:36,639 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:56:36,892 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:56:36,916 p=165484 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:56:40,577 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:56:41,109 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:56:41,115 p=165484 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 17:56:42,401 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:56:42,495 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:56:42,515 p=165484 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 17:56:43,870 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:56:43,902 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:56:43,911 p=165484 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 17:56:44,639 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:56:44,669 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:56:44,676 p=165484 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 17:56:45,972 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 17:56:46,052 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 17:56:47,285 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-05 17:56:47,412 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-05 17:56:47,437 p=165484 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:56:49,756 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:56:49,858 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:56:49,879 p=165484 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 17:56:53,355 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:56:53,525 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:56:53,545 p=165484 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 17:56:54,846 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:56:54,905 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:56:54,931 p=165484 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-05 17:56:57,522 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 17:56:57,636 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 17:56:57,659 p=165484 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-05 17:57:01,163 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:57:01,174 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:57:01,190 p=165484 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-05 17:57:01,962 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 17:57:01,964 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 17:57:02,620 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 17:57:02,708 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 17:57:02,718 p=165484 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-05 17:57:04,027 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:57:04,174 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:57:04,192 p=165484 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-05 17:57:04,277 p=165484 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-05 17:57:04,289 p=165484 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 17:57:05,719 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:57:05,813 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:57:05,837 p=165484 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 17:57:07,244 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:57:07,326 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:57:07,340 p=165484 u=morteza n=ansible | TASK [php-fpm : Install the latest version packages] *********************************************************************************************************
2023-06-05 17:57:09,718 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 17:57:09,730 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 17:57:09,753 p=165484 u=morteza n=ansible | TASK [php-fpm : Update all packages] *************************************************************************************************************************
2023-06-05 17:57:13,271 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:57:13,324 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:57:13,356 p=165484 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-05 17:57:13,404 p=165484 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'db.sudoer.net', 'db_charset': 'utf8'})
2023-06-05 17:57:13,411 p=165484 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-05 17:57:14,171 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:57:14,185 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:57:14,207 p=165484 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-05 17:57:14,923 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:57:14,947 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:57:14,966 p=165484 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-05 17:57:14,988 p=165484 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 17:57:14,997 p=165484 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 17:57:15,005 p=165484 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-05 17:57:15,019 p=165484 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 17:57:15,026 p=165484 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 17:57:15,033 p=165484 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-05 17:57:16,096 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 17:57:16,101 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 17:57:16,125 p=165484 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-05 17:57:17,207 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 17:57:17,211 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 17:57:17,226 p=165484 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-05 17:57:18,627 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:57:18,631 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:57:18,692 p=165484 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 17:57:18,692 p=165484 u=morteza n=ansible | app1.sudoer.net            : ok=25   changed=0    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-06-05 17:57:18,692 p=165484 u=morteza n=ansible | app2.sudoer.net            : ok=25   changed=0    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-06-05 17:57:18,692 p=165484 u=morteza n=ansible | db.sudoer.net              : ok=20   changed=0    unreachable=0    failed=0    skipped=6    rescued=0    ignored=0   
2023-06-06 07:56:05,569 p=198186 u=morteza n=ansible | PLAY [lb] ****************************************************************************************************************************************************
2023-06-06 07:56:05,580 p=198186 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 07:56:08,317 p=198186 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 07:56:08,335 p=198186 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-06 07:56:22,625 p=198186 u=morteza n=ansible | changed: [lb.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 07:56:22,644 p=198186 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-06 07:56:28,037 p=198186 u=morteza n=ansible | changed: [lb.sudoer.net]
2023-06-06 07:56:28,057 p=198186 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-06 07:56:29,320 p=198186 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 07:56:29,332 p=198186 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-06 07:56:31,178 p=198186 u=morteza n=ansible | changed: [lb.sudoer.net]
2023-06-06 07:56:31,195 p=198186 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-06 07:56:32,045 p=198186 u=morteza n=ansible | changed: [lb.sudoer.net]
2023-06-06 07:56:32,070 p=198186 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-06 07:56:33,470 p=198186 u=morteza n=ansible | changed: [lb.sudoer.net] => (item=setup.sh)
2023-06-06 07:56:34,864 p=198186 u=morteza n=ansible | changed: [lb.sudoer.net] => (item=config)
2023-06-06 07:56:34,905 p=198186 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-06 07:56:41,000 p=198186 u=morteza n=ansible | changed: [lb.sudoer.net] => (item=['fail2ban'])
2023-06-06 07:56:41,014 p=198186 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-06 07:56:44,748 p=198186 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 07:56:44,767 p=198186 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-06 07:56:46,265 p=198186 u=morteza n=ansible | changed: [lb.sudoer.net]
2023-06-06 07:56:46,290 p=198186 u=morteza n=ansible | TASK [loadbalancer : Install the latest version packages] ****************************************************************************************************
2023-06-06 07:57:00,164 p=198186 u=morteza n=ansible | changed: [lb.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-06 07:57:00,189 p=198186 u=morteza n=ansible | TASK [loadbalancer : Update all packages] ********************************************************************************************************************
2023-06-06 07:57:03,682 p=198186 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 07:57:03,696 p=198186 u=morteza n=ansible | TASK [loadbalancer : nginx config for {{ instance.domain }}] *************************************************************************************************
2023-06-06 07:57:05,181 p=198186 u=morteza n=ansible | fatal: [lb.sudoer.net]: FAILED! => {"changed": false, "checksum": "a36942e1edd6bf22179260b1367bfac69a58ac8b", "msg": "Destination directory /etc/systemd/system/nginx.service.d does not exist"}
2023-06-06 07:57:05,185 p=198186 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-06 07:57:05,218 p=198186 u=morteza n=ansible | lb.sudoer.net              : ok=12   changed=8    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-06-06 07:59:29,550 p=198634 u=morteza n=ansible | PLAY [lb] ****************************************************************************************************************************************************
2023-06-06 07:59:29,561 p=198634 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 07:59:31,892 p=198634 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 07:59:31,915 p=198634 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-06 07:59:34,368 p=198634 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 07:59:34,381 p=198634 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-06 07:59:37,987 p=198634 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 07:59:38,004 p=198634 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-06 07:59:39,165 p=198634 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 07:59:39,177 p=198634 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-06 07:59:40,678 p=198634 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 07:59:40,694 p=198634 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-06 07:59:41,363 p=198634 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 07:59:41,384 p=198634 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-06 07:59:42,950 p=198634 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=setup.sh)
2023-06-06 07:59:44,265 p=198634 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=config)
2023-06-06 07:59:44,295 p=198634 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-06 07:59:46,643 p=198634 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['fail2ban'])
2023-06-06 07:59:46,660 p=198634 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-06 07:59:50,177 p=198634 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 07:59:50,233 p=198634 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-06 07:59:51,513 p=198634 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 07:59:51,537 p=198634 u=morteza n=ansible | TASK [loadbalancer : Install the latest version packages] ****************************************************************************************************
2023-06-06 07:59:53,762 p=198634 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-06 07:59:53,779 p=198634 u=morteza n=ansible | TASK [loadbalancer : Update all packages] ********************************************************************************************************************
2023-06-06 07:59:57,165 p=198634 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 07:59:57,183 p=198634 u=morteza n=ansible | TASK [loadbalancer : nginx config for {{ instance.domain }}] *************************************************************************************************
2023-06-06 07:59:58,804 p=198634 u=morteza n=ansible | fatal: [lb.sudoer.net]: FAILED! => {"changed": false, "checksum": "a36942e1edd6bf22179260b1367bfac69a58ac8b", "msg": "Destination directory /etc/systemd/system/nginx.service.d does not exist"}
2023-06-06 07:59:58,807 p=198634 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-06 07:59:58,808 p=198634 u=morteza n=ansible | lb.sudoer.net              : ok=12   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-06-06 08:05:09,198 p=199085 u=morteza n=ansible | PLAY [lb] ****************************************************************************************************************************************************
2023-06-06 08:05:09,219 p=199085 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 08:05:11,567 p=199085 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:05:11,593 p=199085 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:05:14,984 p=199085 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 08:05:15,001 p=199085 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-06 08:05:18,431 p=199085 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:05:18,446 p=199085 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-06 08:05:19,592 p=199085 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:05:19,609 p=199085 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-06 08:05:21,131 p=199085 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:05:21,150 p=199085 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-06 08:05:21,844 p=199085 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:05:21,865 p=199085 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-06 08:05:23,254 p=199085 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=setup.sh)
2023-06-06 08:05:24,551 p=199085 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=config)
2023-06-06 08:05:24,581 p=199085 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:05:26,817 p=199085 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['fail2ban'])
2023-06-06 08:05:26,836 p=199085 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-06 08:05:30,466 p=199085 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:05:30,485 p=199085 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-06 08:05:31,871 p=199085 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:05:31,896 p=199085 u=morteza n=ansible | TASK [loadbalancer : Install the latest version packages] ****************************************************************************************************
2023-06-06 08:05:34,272 p=199085 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-06 08:05:34,296 p=199085 u=morteza n=ansible | TASK [loadbalancer : Update all packages] ********************************************************************************************************************
2023-06-06 08:05:37,724 p=199085 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:05:37,745 p=199085 u=morteza n=ansible | TASK [loadbalancer : Create directory if it does not exist] **************************************************************************************************
2023-06-06 08:05:38,460 p=199085 u=morteza n=ansible | changed: [lb.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-06 08:05:39,145 p=199085 u=morteza n=ansible | changed: [lb.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-06 08:05:39,169 p=199085 u=morteza n=ansible | TASK [loadbalancer : nginx config override] ******************************************************************************************************************
2023-06-06 08:05:40,841 p=199085 u=morteza n=ansible | changed: [lb.sudoer.net]
2023-06-06 08:05:40,856 p=199085 u=morteza n=ansible | TASK [loadbalancer : nginx config conf.d] ********************************************************************************************************************
2023-06-06 08:05:41,066 p=199085 u=morteza n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: . unexpected '}'
2023-06-06 08:05:41,068 p=199085 u=morteza n=ansible | fatal: [lb.sudoer.net]: FAILED! => {"changed": false, "msg": "AnsibleError: template error while templating string: unexpected '}'. String: upstream backend {\n{% for backend in LB_BACKEND }\n    server backend.ip;\n{% endfor }\n}\n    \nserver {\n    if ($host !~ ^({{ LB_DOMAIN }}|www.{{ LB_DOMAIN }})$ ) {\n        return 444;\n    }\n    if ($request_method !~ ^(GET|HEAD|POST)$ ) {\n        return 444;\n    }\n    listen 80;\n    server_name www.{{ LB_DOMAIN }} {{ LB_DOMAIN }};\n\n    root {{ instance.root }};\n    access_log /var/log/nginx/{{ LB_DOMAIN }}.access.log;\n    error_log /var/log/nginx/{{ LB_DOMAIN }}.error.log;\n\n    location = /favicon.ico {\n        log_not_found off;\n        access_log off;\n    }\n\n    location = /robots.txt {\n        allow all;\n        log_not_found off;\n        access_log off;\n    }\n\t\n    location / {\n\t\t\t\tproxy_pass http://backend;\n    }\n    \n}\n\n. unexpected '}'"}
2023-06-06 08:05:41,073 p=199085 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-06 08:05:41,074 p=199085 u=morteza n=ansible | lb.sudoer.net              : ok=14   changed=2    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-06-06 08:07:41,461 p=199320 u=morteza n=ansible | PLAY [lb] ****************************************************************************************************************************************************
2023-06-06 08:07:41,474 p=199320 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 08:07:43,779 p=199320 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:07:43,801 p=199320 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:07:46,544 p=199320 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 08:07:46,569 p=199320 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-06 08:07:49,983 p=199320 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:07:50,000 p=199320 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-06 08:07:51,230 p=199320 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:07:51,255 p=199320 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-06 08:07:52,858 p=199320 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:07:52,880 p=199320 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-06 08:07:53,579 p=199320 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:07:53,597 p=199320 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-06 08:07:54,827 p=199320 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=setup.sh)
2023-06-06 08:07:56,076 p=199320 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=config)
2023-06-06 08:07:56,109 p=199320 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:07:58,360 p=199320 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['fail2ban'])
2023-06-06 08:07:58,369 p=199320 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-06 08:08:01,642 p=199320 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:08:01,648 p=199320 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-06 08:08:02,959 p=199320 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:08:02,992 p=199320 u=morteza n=ansible | TASK [loadbalancer : Install the latest version packages] ****************************************************************************************************
2023-06-06 08:08:05,419 p=199320 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-06 08:08:05,442 p=199320 u=morteza n=ansible | TASK [loadbalancer : Update all packages] ********************************************************************************************************************
2023-06-06 08:08:08,736 p=199320 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:08:08,759 p=199320 u=morteza n=ansible | TASK [loadbalancer : Create directory if it does not exist] **************************************************************************************************
2023-06-06 08:08:09,509 p=199320 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-06 08:08:10,220 p=199320 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-06 08:08:10,235 p=199320 u=morteza n=ansible | TASK [loadbalancer : nginx config override] ******************************************************************************************************************
2023-06-06 08:08:11,553 p=199320 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:08:11,576 p=199320 u=morteza n=ansible | TASK [loadbalancer : nginx config conf.d] ********************************************************************************************************************
2023-06-06 08:08:11,731 p=199320 u=morteza n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ansible.errors.AnsibleUndefinedVariable: 'instance' is undefined. 'instance' is undefined
2023-06-06 08:08:11,732 p=199320 u=morteza n=ansible | fatal: [lb.sudoer.net]: FAILED! => {"changed": false, "msg": "AnsibleUndefinedVariable: 'instance' is undefined. 'instance' is undefined"}
2023-06-06 08:08:11,737 p=199320 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-06 08:08:11,737 p=199320 u=morteza n=ansible | lb.sudoer.net              : ok=14   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-06-06 08:08:37,177 p=199514 u=morteza n=ansible | PLAY [lb] ****************************************************************************************************************************************************
2023-06-06 08:08:37,189 p=199514 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 08:08:39,107 p=199514 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:08:39,143 p=199514 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:08:41,505 p=199514 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 08:08:41,530 p=199514 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-06 08:08:44,758 p=199514 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:08:44,775 p=199514 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-06 08:08:45,971 p=199514 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:08:45,977 p=199514 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-06 08:08:47,360 p=199514 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:08:47,366 p=199514 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-06 08:08:48,053 p=199514 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:08:48,076 p=199514 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-06 08:08:49,301 p=199514 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=setup.sh)
2023-06-06 08:08:50,529 p=199514 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=config)
2023-06-06 08:08:50,559 p=199514 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:08:52,753 p=199514 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['fail2ban'])
2023-06-06 08:08:52,767 p=199514 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-06 08:08:56,039 p=199514 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:08:56,059 p=199514 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-06 08:08:57,297 p=199514 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:08:57,323 p=199514 u=morteza n=ansible | TASK [loadbalancer : Install the latest version packages] ****************************************************************************************************
2023-06-06 08:08:59,525 p=199514 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-06 08:08:59,539 p=199514 u=morteza n=ansible | TASK [loadbalancer : Update all packages] ********************************************************************************************************************
2023-06-06 08:09:02,880 p=199514 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:09:02,898 p=199514 u=morteza n=ansible | TASK [loadbalancer : Create directory if it does not exist] **************************************************************************************************
2023-06-06 08:09:03,640 p=199514 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-06 08:09:04,356 p=199514 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-06 08:09:04,372 p=199514 u=morteza n=ansible | TASK [loadbalancer : nginx config override] ******************************************************************************************************************
2023-06-06 08:09:05,646 p=199514 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:09:05,656 p=199514 u=morteza n=ansible | TASK [loadbalancer : nginx config conf.d] ********************************************************************************************************************
2023-06-06 08:09:07,276 p=199514 u=morteza n=ansible | changed: [lb.sudoer.net]
2023-06-06 08:09:07,310 p=199514 u=morteza n=ansible | RUNNING HANDLER [loadbalancer : reload nginx] ****************************************************************************************************************
2023-06-06 08:09:08,883 p=199514 u=morteza n=ansible | fatal: [lb.sudoer.net]: FAILED! => {"changed": false, "msg": "Unable to reload service nginx: Job for nginx.service failed.\nSee \"systemctl status nginx.service\" and \"journalctl -xe\" for details.\n"}
2023-06-06 08:09:08,888 p=199514 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-06 08:09:08,888 p=199514 u=morteza n=ansible | lb.sudoer.net              : ok=15   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-06-06 08:10:58,999 p=199736 u=morteza n=ansible | PLAY [lb] ****************************************************************************************************************************************************
2023-06-06 08:10:59,013 p=199736 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 08:11:01,297 p=199736 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:11:01,315 p=199736 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:11:03,909 p=199736 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 08:11:03,924 p=199736 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-06 08:11:07,295 p=199736 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:11:07,317 p=199736 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-06 08:11:08,445 p=199736 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:11:08,453 p=199736 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-06 08:11:09,962 p=199736 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:11:09,983 p=199736 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-06 08:11:10,726 p=199736 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:11:10,742 p=199736 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-06 08:11:12,061 p=199736 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=setup.sh)
2023-06-06 08:11:13,350 p=199736 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=config)
2023-06-06 08:11:13,385 p=199736 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:11:15,708 p=199736 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['fail2ban'])
2023-06-06 08:11:15,720 p=199736 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-06 08:11:19,109 p=199736 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:11:19,133 p=199736 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-06 08:11:20,672 p=199736 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:11:20,695 p=199736 u=morteza n=ansible | TASK [loadbalancer : Install the latest version packages] ****************************************************************************************************
2023-06-06 08:11:22,877 p=199736 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-06 08:11:22,896 p=199736 u=morteza n=ansible | TASK [loadbalancer : Update all packages] ********************************************************************************************************************
2023-06-06 08:11:26,254 p=199736 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:11:26,263 p=199736 u=morteza n=ansible | TASK [loadbalancer : Create directory if it does not exist] **************************************************************************************************
2023-06-06 08:11:26,953 p=199736 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-06 08:11:27,688 p=199736 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-06 08:11:27,706 p=199736 u=morteza n=ansible | TASK [loadbalancer : nginx config override] ******************************************************************************************************************
2023-06-06 08:11:28,986 p=199736 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:11:29,005 p=199736 u=morteza n=ansible | TASK [loadbalancer : nginx config conf.d] ********************************************************************************************************************
2023-06-06 08:11:30,597 p=199736 u=morteza n=ansible | changed: [lb.sudoer.net]
2023-06-06 08:11:30,634 p=199736 u=morteza n=ansible | RUNNING HANDLER [loadbalancer : reload nginx] ****************************************************************************************************************
2023-06-06 08:11:32,190 p=199736 u=morteza n=ansible | fatal: [lb.sudoer.net]: FAILED! => {"changed": false, "msg": "Unable to reload service nginx: Job for nginx.service failed.\nSee \"systemctl status nginx.service\" and \"journalctl -xe\" for details.\n"}
2023-06-06 08:11:32,212 p=199736 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-06 08:11:32,213 p=199736 u=morteza n=ansible | lb.sudoer.net              : ok=15   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-06-06 08:12:09,104 p=199924 u=morteza n=ansible | PLAY [lb] ****************************************************************************************************************************************************
2023-06-06 08:12:09,117 p=199924 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 08:12:11,150 p=199924 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:12:11,175 p=199924 u=morteza n=ansible | TASK [loadbalancer : Install the latest version packages] ****************************************************************************************************
2023-06-06 08:12:13,954 p=199924 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-06 08:12:13,975 p=199924 u=morteza n=ansible | TASK [loadbalancer : Update all packages] ********************************************************************************************************************
2023-06-06 08:12:17,500 p=199924 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:12:17,521 p=199924 u=morteza n=ansible | TASK [loadbalancer : Create directory if it does not exist] **************************************************************************************************
2023-06-06 08:12:18,348 p=199924 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-06 08:12:18,979 p=199924 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-06 08:12:19,006 p=199924 u=morteza n=ansible | TASK [loadbalancer : nginx config override] ******************************************************************************************************************
2023-06-06 08:12:20,375 p=199924 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:12:20,387 p=199924 u=morteza n=ansible | TASK [loadbalancer : nginx config conf.d] ********************************************************************************************************************
2023-06-06 08:12:21,916 p=199924 u=morteza n=ansible | changed: [lb.sudoer.net]
2023-06-06 08:12:21,941 p=199924 u=morteza n=ansible | RUNNING HANDLER [loadbalancer : reload nginx] ****************************************************************************************************************
2023-06-06 08:12:23,503 p=199924 u=morteza n=ansible | changed: [lb.sudoer.net]
2023-06-06 08:12:23,527 p=199924 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-06 08:12:23,528 p=199924 u=morteza n=ansible | lb.sudoer.net              : ok=7    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-06 08:12:55,797 p=200090 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-06 08:12:55,811 p=200090 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 08:12:59,265 p=200090 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:12:59,286 p=200090 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:13:53,668 p=200090 u=morteza n=ansible | changed: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 08:13:53,677 p=200090 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-06 08:14:29,829 p=200090 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-06 08:14:29,849 p=200090 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-06 08:14:31,501 p=200090 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:14:31,522 p=200090 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-06 08:14:34,370 p=200090 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-06 08:14:34,390 p=200090 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-06 08:14:35,873 p=200090 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-06 08:14:35,896 p=200090 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-06 08:14:38,471 p=200090 u=morteza n=ansible | changed: [db.sudoer.net] => (item=setup.sh)
2023-06-06 08:14:40,990 p=200090 u=morteza n=ansible | changed: [db.sudoer.net] => (item=config)
2023-06-06 08:14:41,023 p=200090 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:14:47,949 p=200090 u=morteza n=ansible | changed: [db.sudoer.net] => (item=['fail2ban'])
2023-06-06 08:14:47,972 p=200090 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-06 08:14:52,322 p=200090 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:14:52,328 p=200090 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-06 08:14:54,973 p=200090 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-06 08:14:54,993 p=200090 u=morteza n=ansible | TASK [mariadb : set sysctl] **********************************************************************************************************************************
2023-06-06 08:14:56,316 p=200090 u=morteza n=ansible | changed: [db.sudoer.net] => (item={'name': 'net.ipv4.ip_forward', 'value': '0'})
2023-06-06 08:14:56,330 p=200090 u=morteza n=ansible | TASK [mariadb : Install the latest version packages] *********************************************************************************************************
2023-06-06 08:15:14,362 p=200090 u=morteza n=ansible | changed: [db.sudoer.net] => (item=['mariadb-server', 'mariadb-client', 'python3-mysqldb', 'percona-toolkit'])
2023-06-06 08:15:14,389 p=200090 u=morteza n=ansible | TASK [mariadb : Update all packages] *************************************************************************************************************************
2023-06-06 08:15:18,817 p=200090 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:15:18,831 p=200090 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-06 08:15:19,955 p=200090 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:15:19,973 p=200090 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-06 08:15:20,018 p=200090 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:15:20,024 p=200090 u=morteza n=ansible | TASK [mariadb : Removes anonymous users] *********************************************************************************************************************
2023-06-06 08:15:21,335 p=200090 u=morteza n=ansible | ok: [db.sudoer.net] => (item=127.0.0.1)
2023-06-06 08:15:22,477 p=200090 u=morteza n=ansible | ok: [db.sudoer.net] => (item=localhost)
2023-06-06 08:15:22,505 p=200090 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ instance.name }}] ***********************************************************************************************************
2023-06-06 08:15:25,102 p=200090 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-06 08:15:25,121 p=200090 u=morteza n=ansible | TASK [mariadb : Update MariaDB root password] ****************************************************************************************************************
2023-06-06 08:15:26,527 p=200090 u=morteza n=ansible | changed: [db.sudoer.net] => (item=127.0.0.1)
2023-06-06 08:15:27,738 p=200090 u=morteza n=ansible | changed: [db.sudoer.net] => (item=localhost)
2023-06-06 08:15:27,774 p=200090 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ user.name }}] ***************************************************************************************************************
2023-06-06 08:15:30,349 p=200090 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-06 08:15:30,369 p=200090 u=morteza n=ansible | TASK [mariadb : configuring instances] ***********************************************************************************************************************
2023-06-06 08:15:30,417 p=200090 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/database.yml for db.sudoer.net => (item={'name': 'sudoer_net'})
2023-06-06 08:15:30,427 p=200090 u=morteza n=ansible | TASK [mariadb : Create databases sudoer_net] *****************************************************************************************************************
2023-06-06 08:15:31,776 p=200090 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-06 08:15:31,802 p=200090 u=morteza n=ansible | TASK [mariadb : configuring users] ***************************************************************************************************************************
2023-06-06 08:15:31,831 p=200090 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/users.yml for db.sudoer.net => (item={'name': 'sudoer_user', 'priv': ['sudoer_net.*:ALL,GRANT']})
2023-06-06 08:15:31,840 p=200090 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-06 08:15:33,005 p=200090 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:15:33,020 p=200090 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-06 08:15:33,069 p=200090 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:15:33,077 p=200090 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf sudoer_user] *******************************************************************************************************************
2023-06-06 08:15:35,546 p=200090 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-06 08:15:35,570 p=200090 u=morteza n=ansible | TASK [mariadb : Create database user "sudoer_user"] **********************************************************************************************************
2023-06-06 08:15:36,832 p=200090 u=morteza n=ansible | changed: [db.sudoer.net] => (item=sudoer_net.*:ALL,GRANT)
2023-06-06 08:15:36,867 p=200090 u=morteza n=ansible | RUNNING HANDLER [iptables : restart iptables] ****************************************************************************************************************
2023-06-06 08:15:38,601 p=200090 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-06 08:15:38,615 p=200090 u=morteza n=ansible | RUNNING HANDLER [fail2ban : restart fail2ban] ****************************************************************************************************************
2023-06-06 08:15:40,902 p=200090 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-06 08:15:40,935 p=200090 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-06 08:15:40,950 p=200090 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 08:15:43,367 p=200090 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:15:43,636 p=200090 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:15:43,681 p=200090 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:16:00,962 p=200090 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 08:16:48,029 p=200090 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 08:16:48,037 p=200090 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-06 08:16:54,925 p=200090 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:16:56,165 p=200090 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:16:56,179 p=200090 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-06 08:16:57,342 p=200090 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:16:57,476 p=200090 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:16:57,486 p=200090 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-06 08:16:59,050 p=200090 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:16:59,241 p=200090 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:16:59,254 p=200090 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-06 08:16:59,997 p=200090 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:17:00,056 p=200090 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:17:00,063 p=200090 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-06 08:17:01,593 p=200090 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=setup.sh)
2023-06-06 08:17:01,709 p=200090 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=setup.sh)
2023-06-06 08:17:03,003 p=200090 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=config)
2023-06-06 08:17:03,312 p=200090 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=config)
2023-06-06 08:17:03,350 p=200090 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:17:10,292 p=200090 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-06 08:17:11,776 p=200090 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-06 08:17:11,796 p=200090 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-06 08:17:15,866 p=200090 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:17:17,043 p=200090 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:17:17,059 p=200090 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-06 08:17:18,510 p=200090 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:17:18,735 p=200090 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:17:18,763 p=200090 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-06 08:17:33,983 p=200090 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-06 08:17:37,010 p=200090 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-06 08:17:37,025 p=200090 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-06 08:17:41,198 p=200090 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:17:42,614 p=200090 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:17:42,627 p=200090 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-06 08:17:43,378 p=200090 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-06 08:17:43,438 p=200090 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-06 08:17:44,097 p=200090 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-06 08:17:44,231 p=200090 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-06 08:17:44,255 p=200090 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-06 08:17:45,729 p=200090 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:17:45,919 p=200090 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:17:45,930 p=200090 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-06 08:17:45,980 p=200090 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-06 08:17:45,988 p=200090 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-06 08:17:47,499 p=200090 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:17:47,679 p=200090 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:17:47,691 p=200090 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-06 08:17:49,133 p=200090 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:17:49,265 p=200090 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:17:49,306 p=200090 u=morteza n=ansible | TASK [php-fpm : Install the latest version packages] *********************************************************************************************************
2023-06-06 08:18:10,309 p=200090 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-06 08:18:15,010 p=200090 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-06 08:18:15,023 p=200090 u=morteza n=ansible | TASK [php-fpm : Update all packages] *************************************************************************************************************************
2023-06-06 08:18:19,044 p=200090 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:18:20,237 p=200090 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:18:20,269 p=200090 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-06 08:18:20,316 p=200090 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'db.sudoer.net', 'db_charset': 'utf8'})
2023-06-06 08:18:20,325 p=200090 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-06 08:18:21,041 p=200090 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:18:21,139 p=200090 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:18:21,151 p=200090 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-06 08:18:21,873 p=200090 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:18:22,002 p=200090 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:18:22,014 p=200090 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-06 08:18:27,515 p=200090 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:18:28,039 p=200090 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:18:28,065 p=200090 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-06 08:18:28,969 p=200090 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:18:29,199 p=200090 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:18:29,222 p=200090 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-06 08:18:31,352 p=200090 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-06 08:18:31,358 p=200090 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-06 08:18:31,379 p=200090 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-06 08:18:32,865 p=200090 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-06 08:18:32,866 p=200090 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-06 08:18:32,881 p=200090 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-06 08:18:34,360 p=200090 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:18:34,835 p=200090 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:18:34,892 p=200090 u=morteza n=ansible | RUNNING HANDLER [iptables : restart iptables] ****************************************************************************************************************
2023-06-06 08:18:36,123 p=200090 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:18:36,401 p=200090 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:18:36,413 p=200090 u=morteza n=ansible | RUNNING HANDLER [fail2ban : restart fail2ban] ****************************************************************************************************************
2023-06-06 08:18:38,303 p=200090 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:18:38,479 p=200090 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:18:38,484 p=200090 u=morteza n=ansible | RUNNING HANDLER [nginx : reload nginx] ***********************************************************************************************************************
2023-06-06 08:18:40,006 p=200090 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:18:40,583 p=200090 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:18:40,627 p=200090 u=morteza n=ansible | PLAY [lb] ****************************************************************************************************************************************************
2023-06-06 08:18:40,635 p=200090 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 08:18:42,554 p=200090 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:18:42,580 p=200090 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:18:44,802 p=200090 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 08:18:44,816 p=200090 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-06 08:18:48,207 p=200090 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:18:48,227 p=200090 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-06 08:18:49,230 p=200090 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:18:49,249 p=200090 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-06 08:18:50,467 p=200090 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:18:50,481 p=200090 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-06 08:18:51,104 p=200090 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:18:51,127 p=200090 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-06 08:18:52,329 p=200090 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=setup.sh)
2023-06-06 08:18:53,556 p=200090 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=config)
2023-06-06 08:18:53,582 p=200090 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:18:55,719 p=200090 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['fail2ban'])
2023-06-06 08:18:55,739 p=200090 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-06 08:18:59,514 p=200090 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:18:59,530 p=200090 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-06 08:19:00,782 p=200090 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:19:00,798 p=200090 u=morteza n=ansible | TASK [loadbalancer : Install the latest version packages] ****************************************************************************************************
2023-06-06 08:19:03,037 p=200090 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-06 08:19:03,053 p=200090 u=morteza n=ansible | TASK [loadbalancer : Update all packages] ********************************************************************************************************************
2023-06-06 08:19:06,438 p=200090 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:19:06,452 p=200090 u=morteza n=ansible | TASK [loadbalancer : Create directory if it does not exist] **************************************************************************************************
2023-06-06 08:19:07,130 p=200090 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-06 08:19:07,776 p=200090 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-06 08:19:07,795 p=200090 u=morteza n=ansible | TASK [loadbalancer : nginx config override] ******************************************************************************************************************
2023-06-06 08:19:08,977 p=200090 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:19:08,985 p=200090 u=morteza n=ansible | TASK [loadbalancer : nginx config conf.d] ********************************************************************************************************************
2023-06-06 08:19:10,180 p=200090 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:19:10,225 p=200090 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-06 08:19:10,225 p=200090 u=morteza n=ansible | app1.sudoer.net            : ok=30   changed=20   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-06 08:19:10,225 p=200090 u=morteza n=ansible | app2.sudoer.net            : ok=30   changed=20   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-06 08:19:10,225 p=200090 u=morteza n=ansible | db.sudoer.net              : ok=28   changed=17   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-06 08:19:10,225 p=200090 u=morteza n=ansible | lb.sudoer.net              : ok=15   changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-06 08:19:15,047 p=201644 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-06 08:19:15,061 p=201644 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 08:19:17,634 p=201644 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:19:17,653 p=201644 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:19:21,001 p=201644 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 08:19:21,011 p=201644 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-06 08:19:25,490 p=201644 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:19:25,511 p=201644 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-06 08:19:27,187 p=201644 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:19:27,204 p=201644 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-06 08:19:29,469 p=201644 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:19:29,482 p=201644 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-06 08:19:30,541 p=201644 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:19:30,556 p=201644 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-06 08:19:32,573 p=201644 u=morteza n=ansible | ok: [db.sudoer.net] => (item=setup.sh)
2023-06-06 08:19:34,600 p=201644 u=morteza n=ansible | ok: [db.sudoer.net] => (item=config)
2023-06-06 08:19:34,629 p=201644 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:19:37,823 p=201644 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['fail2ban'])
2023-06-06 08:19:37,853 p=201644 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-06 08:19:42,322 p=201644 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:19:42,332 p=201644 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-06 08:19:44,348 p=201644 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:19:44,367 p=201644 u=morteza n=ansible | TASK [mariadb : set sysctl] **********************************************************************************************************************************
2023-06-06 08:19:45,608 p=201644 u=morteza n=ansible | ok: [db.sudoer.net] => (item={'name': 'net.ipv4.ip_forward', 'value': '0'})
2023-06-06 08:19:45,622 p=201644 u=morteza n=ansible | TASK [mariadb : Install the latest version packages] *********************************************************************************************************
2023-06-06 08:19:48,697 p=201644 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['mariadb-server', 'mariadb-client', 'python3-mysqldb', 'percona-toolkit'])
2023-06-06 08:19:48,709 p=201644 u=morteza n=ansible | TASK [mariadb : Update all packages] *************************************************************************************************************************
2023-06-06 08:19:52,973 p=201644 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:19:52,981 p=201644 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-06 08:19:54,116 p=201644 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:19:54,128 p=201644 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-06 08:19:54,153 p=201644 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 08:19:54,165 p=201644 u=morteza n=ansible | TASK [mariadb : Removes anonymous users] *********************************************************************************************************************
2023-06-06 08:19:55,473 p=201644 u=morteza n=ansible | ok: [db.sudoer.net] => (item=127.0.0.1)
2023-06-06 08:19:56,613 p=201644 u=morteza n=ansible | ok: [db.sudoer.net] => (item=localhost)
2023-06-06 08:19:56,634 p=201644 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ instance.name }}] ***********************************************************************************************************
2023-06-06 08:19:56,652 p=201644 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 08:19:56,661 p=201644 u=morteza n=ansible | TASK [mariadb : Update MariaDB root password] ****************************************************************************************************************
2023-06-06 08:19:56,684 p=201644 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=127.0.0.1) 
2023-06-06 08:19:56,685 p=201644 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=localhost) 
2023-06-06 08:19:56,685 p=201644 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 08:19:56,695 p=201644 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ user.name }}] ***************************************************************************************************************
2023-06-06 08:19:58,722 p=201644 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:19:58,736 p=201644 u=morteza n=ansible | TASK [mariadb : configuring instances] ***********************************************************************************************************************
2023-06-06 08:19:58,779 p=201644 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/database.yml for db.sudoer.net => (item={'name': 'sudoer_net'})
2023-06-06 08:19:58,792 p=201644 u=morteza n=ansible | TASK [mariadb : Create databases sudoer_net] *****************************************************************************************************************
2023-06-06 08:20:00,036 p=201644 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:20:00,050 p=201644 u=morteza n=ansible | TASK [mariadb : configuring users] ***************************************************************************************************************************
2023-06-06 08:20:00,083 p=201644 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/users.yml for db.sudoer.net => (item={'name': 'sudoer_user', 'priv': ['sudoer_net.*:ALL,GRANT']})
2023-06-06 08:20:00,092 p=201644 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-06 08:20:01,225 p=201644 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:20:01,249 p=201644 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-06 08:20:01,266 p=201644 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 08:20:01,274 p=201644 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf sudoer_user] *******************************************************************************************************************
2023-06-06 08:20:01,289 p=201644 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 08:20:01,298 p=201644 u=morteza n=ansible | TASK [mariadb : Create database user "sudoer_user"] **********************************************************************************************************
2023-06-06 08:20:01,315 p=201644 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=sudoer_net.*:ALL,GRANT) 
2023-06-06 08:20:01,316 p=201644 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 08:20:01,343 p=201644 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-06 08:20:01,353 p=201644 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 08:20:03,713 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:20:03,792 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:20:03,819 p=201644 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:20:06,576 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 08:20:07,403 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 08:20:07,429 p=201644 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-06 08:20:11,795 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:20:13,410 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:20:13,432 p=201644 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-06 08:20:14,612 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:20:14,796 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:20:14,807 p=201644 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-06 08:20:16,314 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:20:16,476 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:20:16,500 p=201644 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-06 08:20:17,287 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:20:17,442 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:20:17,448 p=201644 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-06 08:20:18,696 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-06 08:20:18,951 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-06 08:20:19,908 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-06 08:20:20,320 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-06 08:20:20,352 p=201644 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:20:22,976 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-06 08:20:24,124 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-06 08:20:24,149 p=201644 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-06 08:20:28,030 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:20:29,503 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:20:29,516 p=201644 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-06 08:20:30,858 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:20:30,987 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:20:31,019 p=201644 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-06 08:20:33,454 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-06 08:20:34,371 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-06 08:20:34,387 p=201644 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-06 08:20:38,509 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:20:39,963 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:20:39,971 p=201644 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-06 08:20:40,670 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-06 08:20:40,846 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-06 08:20:41,330 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-06 08:20:41,571 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-06 08:20:41,587 p=201644 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-06 08:20:42,886 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:20:43,071 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:20:43,085 p=201644 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-06 08:20:43,131 p=201644 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-06 08:20:43,138 p=201644 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-06 08:20:44,570 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:20:44,621 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:20:44,636 p=201644 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-06 08:20:46,052 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:20:46,074 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:20:46,096 p=201644 u=morteza n=ansible | TASK [php-fpm : Install the latest version packages] *********************************************************************************************************
2023-06-06 08:20:48,599 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-06 08:20:49,637 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-06 08:20:49,646 p=201644 u=morteza n=ansible | TASK [php-fpm : Update all packages] *************************************************************************************************************************
2023-06-06 08:20:53,789 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:20:55,664 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:20:55,687 p=201644 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-06 08:20:55,736 p=201644 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'db.sudoer.net', 'db_charset': 'utf8'})
2023-06-06 08:20:55,746 p=201644 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-06 08:20:56,534 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:20:56,611 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:20:56,619 p=201644 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-06 08:20:57,320 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:20:57,412 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:20:57,425 p=201644 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-06 08:20:57,451 p=201644 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-06 08:20:57,466 p=201644 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-06 08:20:57,481 p=201644 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-06 08:20:57,506 p=201644 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-06 08:20:57,517 p=201644 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-06 08:20:57,530 p=201644 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-06 08:20:58,955 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-06 08:20:58,967 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-06 08:20:58,975 p=201644 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-06 08:21:00,277 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-06 08:21:00,310 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-06 08:21:00,334 p=201644 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-06 08:21:01,785 p=201644 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:21:01,927 p=201644 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:21:01,985 p=201644 u=morteza n=ansible | PLAY [lb] ****************************************************************************************************************************************************
2023-06-06 08:21:01,993 p=201644 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 08:21:04,076 p=201644 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:21:04,101 p=201644 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:21:06,371 p=201644 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 08:21:06,388 p=201644 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-06 08:21:09,926 p=201644 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:21:09,936 p=201644 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-06 08:21:10,998 p=201644 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:21:11,013 p=201644 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-06 08:21:12,251 p=201644 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:21:12,262 p=201644 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-06 08:21:12,886 p=201644 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:21:12,896 p=201644 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-06 08:21:14,129 p=201644 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=setup.sh)
2023-06-06 08:21:15,362 p=201644 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=config)
2023-06-06 08:21:15,379 p=201644 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:21:17,657 p=201644 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['fail2ban'])
2023-06-06 08:21:17,669 p=201644 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-06 08:21:20,995 p=201644 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:21:21,003 p=201644 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-06 08:21:22,262 p=201644 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:21:22,286 p=201644 u=morteza n=ansible | TASK [loadbalancer : Install the latest version packages] ****************************************************************************************************
2023-06-06 08:21:24,530 p=201644 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-06 08:21:24,546 p=201644 u=morteza n=ansible | TASK [loadbalancer : Update all packages] ********************************************************************************************************************
2023-06-06 08:21:27,954 p=201644 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:21:27,962 p=201644 u=morteza n=ansible | TASK [loadbalancer : Create directory if it does not exist] **************************************************************************************************
2023-06-06 08:21:28,622 p=201644 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-06 08:21:29,331 p=201644 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-06 08:21:29,343 p=201644 u=morteza n=ansible | TASK [loadbalancer : nginx config override] ******************************************************************************************************************
2023-06-06 08:21:30,634 p=201644 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:21:30,646 p=201644 u=morteza n=ansible | TASK [loadbalancer : nginx config conf.d] ********************************************************************************************************************
2023-06-06 08:21:31,860 p=201644 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:21:31,896 p=201644 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-06 08:21:31,896 p=201644 u=morteza n=ansible | app1.sudoer.net            : ok=25   changed=0    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-06-06 08:21:31,896 p=201644 u=morteza n=ansible | app2.sudoer.net            : ok=25   changed=0    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-06-06 08:21:31,896 p=201644 u=morteza n=ansible | db.sudoer.net              : ok=20   changed=0    unreachable=0    failed=0    skipped=6    rescued=0    ignored=0   
2023-06-06 08:21:31,896 p=201644 u=morteza n=ansible | lb.sudoer.net              : ok=15   changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-06 08:30:16,905 p=204064 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-06 08:30:16,917 p=204064 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 08:30:19,958 p=204064 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:30:19,980 p=204064 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:30:22,976 p=204064 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 08:30:22,995 p=204064 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-06 08:30:27,385 p=204064 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:30:27,397 p=204064 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-06 08:30:29,109 p=204064 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:30:29,131 p=204064 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-06 08:30:31,460 p=204064 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:30:31,483 p=204064 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-06 08:30:32,592 p=204064 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:30:32,604 p=204064 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-06 08:30:34,553 p=204064 u=morteza n=ansible | ok: [db.sudoer.net] => (item=setup.sh)
2023-06-06 08:30:36,495 p=204064 u=morteza n=ansible | ok: [db.sudoer.net] => (item=config)
2023-06-06 08:30:36,515 p=204064 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:30:39,568 p=204064 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['fail2ban'])
2023-06-06 08:30:39,582 p=204064 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-06 08:30:44,077 p=204064 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:30:44,097 p=204064 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-06 08:30:46,135 p=204064 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:30:46,153 p=204064 u=morteza n=ansible | TASK [mariadb : set sysctl] **********************************************************************************************************************************
2023-06-06 08:30:47,432 p=204064 u=morteza n=ansible | ok: [db.sudoer.net] => (item={'name': 'net.ipv4.ip_forward', 'value': '0'})
2023-06-06 08:30:47,445 p=204064 u=morteza n=ansible | TASK [mariadb : Install the latest version packages] *********************************************************************************************************
2023-06-06 08:30:50,331 p=204064 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['mariadb-server', 'mariadb-client', 'python3-mysqldb', 'percona-toolkit'])
2023-06-06 08:30:50,342 p=204064 u=morteza n=ansible | TASK [mariadb : Update all packages] *************************************************************************************************************************
2023-06-06 08:30:54,514 p=204064 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:30:54,525 p=204064 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-06 08:30:55,686 p=204064 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:30:55,711 p=204064 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-06 08:30:55,731 p=204064 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 08:30:55,739 p=204064 u=morteza n=ansible | TASK [mariadb : Removes anonymous users] *********************************************************************************************************************
2023-06-06 08:30:57,122 p=204064 u=morteza n=ansible | ok: [db.sudoer.net] => (item=127.0.0.1)
2023-06-06 08:30:58,221 p=204064 u=morteza n=ansible | ok: [db.sudoer.net] => (item=localhost)
2023-06-06 08:30:58,243 p=204064 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ instance.name }}] ***********************************************************************************************************
2023-06-06 08:30:58,261 p=204064 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 08:30:58,268 p=204064 u=morteza n=ansible | TASK [mariadb : Update MariaDB root password] ****************************************************************************************************************
2023-06-06 08:30:58,287 p=204064 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=127.0.0.1) 
2023-06-06 08:30:58,289 p=204064 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=localhost) 
2023-06-06 08:30:58,290 p=204064 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 08:30:58,298 p=204064 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ user.name }}] ***************************************************************************************************************
2023-06-06 08:31:00,356 p=204064 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:31:00,374 p=204064 u=morteza n=ansible | TASK [mariadb : configuring instances] ***********************************************************************************************************************
2023-06-06 08:31:00,402 p=204064 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/database.yml for db.sudoer.net => (item={'name': 'sudoer_net'})
2023-06-06 08:31:00,413 p=204064 u=morteza n=ansible | TASK [mariadb : Create databases sudoer_net] *****************************************************************************************************************
2023-06-06 08:31:01,741 p=204064 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:31:01,762 p=204064 u=morteza n=ansible | TASK [mariadb : configuring users] ***************************************************************************************************************************
2023-06-06 08:31:01,794 p=204064 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/users.yml for db.sudoer.net => (item={'name': 'sudoer_user', 'priv': ['sudoer_net.*:ALL,GRANT']})
2023-06-06 08:31:01,802 p=204064 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-06 08:31:02,912 p=204064 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:31:02,924 p=204064 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-06 08:31:02,949 p=204064 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 08:31:02,959 p=204064 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf sudoer_user] *******************************************************************************************************************
2023-06-06 08:31:02,974 p=204064 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 08:31:02,983 p=204064 u=morteza n=ansible | TASK [mariadb : Create database user "sudoer_user"] **********************************************************************************************************
2023-06-06 08:31:03,004 p=204064 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=sudoer_net.*:ALL,GRANT) 
2023-06-06 08:31:03,006 p=204064 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 08:31:03,038 p=204064 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-06 08:31:03,049 p=204064 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 08:31:05,256 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:31:05,389 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:31:05,425 p=204064 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:31:07,877 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 08:31:08,444 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 08:31:08,452 p=204064 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-06 08:31:12,484 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:31:13,529 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:31:13,543 p=204064 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-06 08:31:14,651 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:31:14,813 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:31:14,830 p=204064 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-06 08:31:16,082 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:31:16,272 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:31:16,295 p=204064 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-06 08:31:17,065 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:31:17,090 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:31:17,105 p=204064 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-06 08:31:18,444 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-06 08:31:18,495 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-06 08:31:19,633 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-06 08:31:19,885 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-06 08:31:19,919 p=204064 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:31:22,314 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-06 08:31:22,899 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-06 08:31:22,917 p=204064 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-06 08:31:26,678 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:31:28,167 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:31:28,182 p=204064 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-06 08:31:29,669 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:31:29,780 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:31:29,800 p=204064 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-06 08:31:32,346 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-06 08:31:32,845 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-06 08:31:32,859 p=204064 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-06 08:31:37,235 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:31:38,461 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:31:38,470 p=204064 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-06 08:31:39,242 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-06 08:31:39,293 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-06 08:31:39,957 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-06 08:31:40,015 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-06 08:31:40,026 p=204064 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-06 08:31:41,413 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:31:41,455 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:31:41,464 p=204064 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-06 08:31:41,512 p=204064 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-06 08:31:41,520 p=204064 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-06 08:31:42,780 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:31:42,941 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:31:42,948 p=204064 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-06 08:31:44,217 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:31:44,390 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:31:44,416 p=204064 u=morteza n=ansible | TASK [php-fpm : Install the latest version packages] *********************************************************************************************************
2023-06-06 08:31:47,139 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-06 08:31:47,546 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-06 08:31:47,560 p=204064 u=morteza n=ansible | TASK [php-fpm : Update all packages] *************************************************************************************************************************
2023-06-06 08:31:51,503 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:31:52,598 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:31:52,629 p=204064 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-06 08:31:52,673 p=204064 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'db.sudoer.net', 'db_charset': 'utf8'})
2023-06-06 08:31:52,681 p=204064 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-06 08:31:53,384 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:31:53,475 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:31:53,483 p=204064 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-06 08:31:54,343 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:31:54,403 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:31:54,414 p=204064 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-06 08:31:54,435 p=204064 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-06 08:31:54,445 p=204064 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-06 08:31:54,454 p=204064 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-06 08:31:54,474 p=204064 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-06 08:31:54,482 p=204064 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-06 08:31:54,492 p=204064 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-06 08:31:55,855 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-06 08:31:55,884 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-06 08:31:55,898 p=204064 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-06 08:31:57,276 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-06 08:31:57,277 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-06 08:31:57,291 p=204064 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-06 08:31:58,605 p=204064 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:31:58,752 p=204064 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:31:58,822 p=204064 u=morteza n=ansible | PLAY [lb] ****************************************************************************************************************************************************
2023-06-06 08:31:58,830 p=204064 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 08:32:00,751 p=204064 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:32:00,769 p=204064 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:32:02,944 p=204064 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 08:32:02,960 p=204064 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-06 08:32:06,429 p=204064 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:32:06,440 p=204064 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-06 08:32:07,519 p=204064 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:32:07,535 p=204064 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-06 08:32:08,995 p=204064 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:32:09,007 p=204064 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-06 08:32:09,696 p=204064 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:32:09,705 p=204064 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-06 08:32:11,014 p=204064 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=setup.sh)
2023-06-06 08:32:12,179 p=204064 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=config)
2023-06-06 08:32:12,200 p=204064 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:32:14,396 p=204064 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['fail2ban'])
2023-06-06 08:32:14,406 p=204064 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-06 08:32:17,802 p=204064 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:32:17,817 p=204064 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-06 08:32:19,126 p=204064 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:32:19,148 p=204064 u=morteza n=ansible | TASK [loadbalancer : Install the latest version packages] ****************************************************************************************************
2023-06-06 08:32:21,329 p=204064 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-06 08:32:21,342 p=204064 u=morteza n=ansible | TASK [loadbalancer : Update all packages] ********************************************************************************************************************
2023-06-06 08:32:24,792 p=204064 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:32:24,802 p=204064 u=morteza n=ansible | TASK [loadbalancer : Create directory if it does not exist] **************************************************************************************************
2023-06-06 08:32:25,511 p=204064 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-06 08:32:26,192 p=204064 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-06 08:32:26,204 p=204064 u=morteza n=ansible | TASK [loadbalancer : nginx config override] ******************************************************************************************************************
2023-06-06 08:32:27,423 p=204064 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:32:27,436 p=204064 u=morteza n=ansible | TASK [loadbalancer : nginx config conf.d] ********************************************************************************************************************
2023-06-06 08:32:28,751 p=204064 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:32:28,783 p=204064 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-06 08:32:28,783 p=204064 u=morteza n=ansible | app1.sudoer.net            : ok=25   changed=0    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-06-06 08:32:28,783 p=204064 u=morteza n=ansible | app2.sudoer.net            : ok=25   changed=0    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-06-06 08:32:28,783 p=204064 u=morteza n=ansible | db.sudoer.net              : ok=20   changed=0    unreachable=0    failed=0    skipped=6    rescued=0    ignored=0   
2023-06-06 08:32:28,783 p=204064 u=morteza n=ansible | lb.sudoer.net              : ok=15   changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-06 08:47:48,488 p=206750 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-06 08:47:48,501 p=206750 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 08:47:51,895 p=206750 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:47:51,913 p=206750 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:48:08,091 p=206750 u=morteza n=ansible | changed: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 08:48:08,100 p=206750 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-06 08:48:41,247 p=206750 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-06 08:48:41,256 p=206750 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-06 08:48:42,906 p=206750 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:48:42,915 p=206750 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-06 08:48:45,590 p=206750 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-06 08:48:45,597 p=206750 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-06 08:48:46,829 p=206750 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-06 08:48:46,837 p=206750 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-06 08:48:49,172 p=206750 u=morteza n=ansible | changed: [db.sudoer.net] => (item=setup.sh)
2023-06-06 08:48:51,500 p=206750 u=morteza n=ansible | changed: [db.sudoer.net] => (item=config)
2023-06-06 08:48:51,514 p=206750 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:48:58,224 p=206750 u=morteza n=ansible | changed: [db.sudoer.net] => (item=['fail2ban'])
2023-06-06 08:48:58,233 p=206750 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-06 08:49:02,427 p=206750 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:49:02,435 p=206750 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-06 08:49:05,031 p=206750 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-06 08:49:05,047 p=206750 u=morteza n=ansible | TASK [mariadb : set sysctl] **********************************************************************************************************************************
2023-06-06 08:49:06,270 p=206750 u=morteza n=ansible | changed: [db.sudoer.net] => (item={'name': 'net.ipv4.ip_forward', 'value': '0'})
2023-06-06 08:49:06,280 p=206750 u=morteza n=ansible | TASK [mariadb : Install the latest version packages] *********************************************************************************************************
2023-06-06 08:49:23,516 p=206750 u=morteza n=ansible | changed: [db.sudoer.net] => (item=['mariadb-server', 'mariadb-client', 'python3-mysqldb', 'percona-toolkit'])
2023-06-06 08:49:23,526 p=206750 u=morteza n=ansible | TASK [mariadb : Update all packages] *************************************************************************************************************************
2023-06-06 08:49:27,508 p=206750 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:49:27,516 p=206750 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-06 08:49:28,671 p=206750 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:49:28,680 p=206750 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-06 08:49:28,718 p=206750 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:49:28,727 p=206750 u=morteza n=ansible | TASK [mariadb : Removes anonymous users] *********************************************************************************************************************
2023-06-06 08:49:30,021 p=206750 u=morteza n=ansible | ok: [db.sudoer.net] => (item=127.0.0.1)
2023-06-06 08:49:31,098 p=206750 u=morteza n=ansible | ok: [db.sudoer.net] => (item=localhost)
2023-06-06 08:49:31,111 p=206750 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ instance.name }}] ***********************************************************************************************************
2023-06-06 08:49:33,419 p=206750 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-06 08:49:33,427 p=206750 u=morteza n=ansible | TASK [mariadb : Update MariaDB root password] ****************************************************************************************************************
2023-06-06 08:49:34,539 p=206750 u=morteza n=ansible | changed: [db.sudoer.net] => (item=127.0.0.1)
2023-06-06 08:49:35,634 p=206750 u=morteza n=ansible | changed: [db.sudoer.net] => (item=localhost)
2023-06-06 08:49:35,643 p=206750 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ user.name }}] ***************************************************************************************************************
2023-06-06 08:49:37,963 p=206750 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-06 08:49:37,971 p=206750 u=morteza n=ansible | TASK [mariadb : configuring instances] ***********************************************************************************************************************
2023-06-06 08:49:37,999 p=206750 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/database.yml for db.sudoer.net => (item={'name': 'sudoer_net'})
2023-06-06 08:49:38,010 p=206750 u=morteza n=ansible | TASK [mariadb : Create databases sudoer_net] *****************************************************************************************************************
2023-06-06 08:49:39,235 p=206750 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-06 08:49:39,245 p=206750 u=morteza n=ansible | TASK [mariadb : configuring users] ***************************************************************************************************************************
2023-06-06 08:49:39,270 p=206750 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/users.yml for db.sudoer.net => (item={'name': 'sudoer_user', 'priv': ['sudoer_net.*:ALL,GRANT']})
2023-06-06 08:49:39,281 p=206750 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-06 08:49:40,332 p=206750 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:49:40,341 p=206750 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-06 08:49:40,378 p=206750 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:49:40,390 p=206750 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf sudoer_user] *******************************************************************************************************************
2023-06-06 08:49:42,846 p=206750 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-06 08:49:42,857 p=206750 u=morteza n=ansible | TASK [mariadb : Create database user "sudoer_user"] **********************************************************************************************************
2023-06-06 08:49:44,275 p=206750 u=morteza n=ansible | changed: [db.sudoer.net] => (item=sudoer_net.*:ALL,GRANT)
2023-06-06 08:49:44,302 p=206750 u=morteza n=ansible | RUNNING HANDLER [iptables : restart iptables] ****************************************************************************************************************
2023-06-06 08:49:46,063 p=206750 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-06 08:49:46,072 p=206750 u=morteza n=ansible | RUNNING HANDLER [fail2ban : restart fail2ban] ****************************************************************************************************************
2023-06-06 08:49:48,216 p=206750 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-06 08:49:48,224 p=206750 u=morteza n=ansible | RUNNING HANDLER [mariadb : restart mariadb] ******************************************************************************************************************
2023-06-06 08:49:49,507 p=206750 u=morteza n=ansible | fatal: [db.sudoer.net]: FAILED! => {"changed": false, "msg": "value of state must be one of: reloaded, restarted, started, stopped, got: restart"}
2023-06-06 08:49:49,509 p=206750 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-06 08:49:49,509 p=206750 u=morteza n=ansible | db.sudoer.net              : ok=28   changed=17   unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-06-06 08:51:12,354 p=207647 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-06 08:51:12,367 p=207647 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 08:51:15,429 p=207647 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:51:15,448 p=207647 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:51:18,415 p=207647 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 08:51:18,428 p=207647 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-06 08:51:22,520 p=207647 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:51:22,536 p=207647 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-06 08:51:24,193 p=207647 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:51:24,204 p=207647 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-06 08:51:26,563 p=207647 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:51:26,572 p=207647 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-06 08:51:27,708 p=207647 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:51:27,716 p=207647 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-06 08:51:29,752 p=207647 u=morteza n=ansible | ok: [db.sudoer.net] => (item=setup.sh)
2023-06-06 08:51:31,958 p=207647 u=morteza n=ansible | ok: [db.sudoer.net] => (item=config)
2023-06-06 08:51:31,976 p=207647 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:51:34,716 p=207647 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['fail2ban'])
2023-06-06 08:51:34,732 p=207647 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-06 08:51:38,913 p=207647 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:51:38,928 p=207647 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-06 08:51:40,925 p=207647 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:51:40,940 p=207647 u=morteza n=ansible | TASK [mariadb : set sysctl] **********************************************************************************************************************************
2023-06-06 08:51:42,307 p=207647 u=morteza n=ansible | ok: [db.sudoer.net] => (item={'name': 'net.ipv4.ip_forward', 'value': '0'})
2023-06-06 08:51:42,316 p=207647 u=morteza n=ansible | TASK [mariadb : Install the latest version packages] *********************************************************************************************************
2023-06-06 08:51:45,248 p=207647 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['mariadb-server', 'mariadb-client', 'python3-mysqldb', 'percona-toolkit'])
2023-06-06 08:51:45,258 p=207647 u=morteza n=ansible | TASK [mariadb : Update all packages] *************************************************************************************************************************
2023-06-06 08:51:49,368 p=207647 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:51:49,376 p=207647 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-06 08:51:50,493 p=207647 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:51:50,500 p=207647 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-06 08:51:50,519 p=207647 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 08:51:50,526 p=207647 u=morteza n=ansible | TASK [mariadb : Removes anonymous users] *********************************************************************************************************************
2023-06-06 08:51:51,823 p=207647 u=morteza n=ansible | ok: [db.sudoer.net] => (item=127.0.0.1)
2023-06-06 08:51:52,902 p=207647 u=morteza n=ansible | ok: [db.sudoer.net] => (item=localhost)
2023-06-06 08:51:52,917 p=207647 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ instance.name }}] ***********************************************************************************************************
2023-06-06 08:51:52,933 p=207647 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 08:51:52,941 p=207647 u=morteza n=ansible | TASK [mariadb : Update MariaDB root password] ****************************************************************************************************************
2023-06-06 08:51:52,968 p=207647 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=127.0.0.1) 
2023-06-06 08:51:52,970 p=207647 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=localhost) 
2023-06-06 08:51:52,971 p=207647 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 08:51:52,980 p=207647 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ user.name }}] ***************************************************************************************************************
2023-06-06 08:51:54,909 p=207647 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:51:54,916 p=207647 u=morteza n=ansible | TASK [mariadb : configuring instances] ***********************************************************************************************************************
2023-06-06 08:51:54,943 p=207647 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/database.yml for db.sudoer.net => (item={'name': 'sudoer_net'})
2023-06-06 08:51:54,951 p=207647 u=morteza n=ansible | TASK [mariadb : Create databases sudoer_net] *****************************************************************************************************************
2023-06-06 08:51:56,334 p=207647 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:51:56,343 p=207647 u=morteza n=ansible | TASK [mariadb : configuring users] ***************************************************************************************************************************
2023-06-06 08:51:56,376 p=207647 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/users.yml for db.sudoer.net => (item={'name': 'sudoer_user', 'priv': ['sudoer_net.*:ALL,GRANT']})
2023-06-06 08:51:56,385 p=207647 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-06 08:51:57,487 p=207647 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 08:51:57,496 p=207647 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-06 08:51:57,516 p=207647 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 08:51:57,529 p=207647 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf sudoer_user] *******************************************************************************************************************
2023-06-06 08:51:57,548 p=207647 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 08:51:57,558 p=207647 u=morteza n=ansible | TASK [mariadb : Create database user "sudoer_user"] **********************************************************************************************************
2023-06-06 08:51:57,577 p=207647 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=sudoer_net.*:ALL,GRANT) 
2023-06-06 08:51:57,578 p=207647 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 08:51:57,610 p=207647 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-06 08:51:57,628 p=207647 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 08:52:00,193 p=207647 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:52:00,294 p=207647 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:52:00,329 p=207647 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:52:17,178 p=207647 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 08:52:21,027 p=207647 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 08:52:21,035 p=207647 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-06 08:52:27,369 p=207647 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:52:29,044 p=207647 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:52:29,050 p=207647 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-06 08:52:30,209 p=207647 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:52:30,362 p=207647 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:52:30,370 p=207647 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-06 08:52:32,052 p=207647 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:52:32,155 p=207647 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:52:32,162 p=207647 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-06 08:52:32,848 p=207647 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:52:32,925 p=207647 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:52:32,935 p=207647 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-06 08:52:34,422 p=207647 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=setup.sh)
2023-06-06 08:52:34,519 p=207647 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=setup.sh)
2023-06-06 08:52:35,741 p=207647 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=config)
2023-06-06 08:52:36,074 p=207647 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=config)
2023-06-06 08:52:36,100 p=207647 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:52:42,817 p=207647 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-06 08:52:44,808 p=207647 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-06 08:52:44,815 p=207647 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-06 08:52:48,824 p=207647 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:52:50,144 p=207647 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:52:50,151 p=207647 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-06 08:52:51,606 p=207647 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:52:51,757 p=207647 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:52:51,778 p=207647 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-06 08:53:06,970 p=207647 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-06 08:53:09,936 p=207647 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-06 08:53:09,946 p=207647 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-06 08:53:14,015 p=207647 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:53:15,192 p=207647 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:53:15,203 p=207647 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-06 08:53:16,066 p=207647 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-06 08:53:16,111 p=207647 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-06 08:53:16,736 p=207647 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-06 08:53:16,823 p=207647 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-06 08:53:16,831 p=207647 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-06 08:53:18,596 p=207647 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:53:18,723 p=207647 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:53:18,730 p=207647 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-06 08:53:18,775 p=207647 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-06 08:53:18,786 p=207647 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-06 08:53:20,294 p=207647 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:53:20,490 p=207647 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:53:20,503 p=207647 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-06 08:53:22,007 p=207647 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:53:22,097 p=207647 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:53:22,120 p=207647 u=morteza n=ansible | TASK [php-fpm : Install the latest version packages] *********************************************************************************************************
2023-06-06 08:53:43,711 p=207647 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-06 08:53:48,017 p=207647 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-06 08:53:48,025 p=207647 u=morteza n=ansible | TASK [php-fpm : Update all packages] *************************************************************************************************************************
2023-06-06 08:53:52,257 p=207647 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:53:53,434 p=207647 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:53:53,454 p=207647 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-06 08:53:53,504 p=207647 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'db.sudoer.net', 'db_charset': 'utf8'})
2023-06-06 08:53:53,512 p=207647 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-06 08:53:54,257 p=207647 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 08:53:54,323 p=207647 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 08:53:54,333 p=207647 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-06 08:53:55,052 p=207647 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:53:55,116 p=207647 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:53:55,124 p=207647 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-06 08:54:00,718 p=207647 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:54:01,119 p=207647 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:54:01,129 p=207647 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-06 08:54:02,094 p=207647 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:54:02,241 p=207647 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:54:02,248 p=207647 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-06 08:54:04,511 p=207647 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-06 08:54:04,513 p=207647 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-06 08:54:04,520 p=207647 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-06 08:54:05,808 p=207647 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-06 08:54:05,843 p=207647 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-06 08:54:05,853 p=207647 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-06 08:54:07,296 p=207647 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:54:07,464 p=207647 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:54:07,522 p=207647 u=morteza n=ansible | RUNNING HANDLER [iptables : restart iptables] ****************************************************************************************************************
2023-06-06 08:54:09,040 p=207647 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:54:09,186 p=207647 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:54:09,194 p=207647 u=morteza n=ansible | RUNNING HANDLER [fail2ban : restart fail2ban] ****************************************************************************************************************
2023-06-06 08:54:10,873 p=207647 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:54:10,890 p=207647 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:54:10,918 p=207647 u=morteza n=ansible | RUNNING HANDLER [nginx : reload nginx] ***********************************************************************************************************************
2023-06-06 08:54:12,403 p=207647 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-06 08:54:12,657 p=207647 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-06 08:54:12,691 p=207647 u=morteza n=ansible | PLAY [lb] ****************************************************************************************************************************************************
2023-06-06 08:54:12,702 p=207647 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 08:54:15,018 p=207647 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:54:15,035 p=207647 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:55:05,035 p=207647 u=morteza n=ansible | changed: [lb.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 08:55:05,046 p=207647 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-06 08:55:10,588 p=207647 u=morteza n=ansible | changed: [lb.sudoer.net]
2023-06-06 08:55:10,596 p=207647 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-06 08:55:11,585 p=207647 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:55:11,594 p=207647 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-06 08:55:13,077 p=207647 u=morteza n=ansible | changed: [lb.sudoer.net]
2023-06-06 08:55:13,086 p=207647 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-06 08:55:13,741 p=207647 u=morteza n=ansible | changed: [lb.sudoer.net]
2023-06-06 08:55:13,748 p=207647 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-06 08:55:15,056 p=207647 u=morteza n=ansible | changed: [lb.sudoer.net] => (item=setup.sh)
2023-06-06 08:55:16,426 p=207647 u=morteza n=ansible | changed: [lb.sudoer.net] => (item=config)
2023-06-06 08:55:16,443 p=207647 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-06 08:55:22,293 p=207647 u=morteza n=ansible | changed: [lb.sudoer.net] => (item=['fail2ban'])
2023-06-06 08:55:22,305 p=207647 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-06 08:55:25,871 p=207647 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:55:25,878 p=207647 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-06 08:55:27,308 p=207647 u=morteza n=ansible | changed: [lb.sudoer.net]
2023-06-06 08:55:27,323 p=207647 u=morteza n=ansible | TASK [loadbalancer : Install the latest version packages] ****************************************************************************************************
2023-06-06 08:55:41,300 p=207647 u=morteza n=ansible | changed: [lb.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-06 08:55:41,311 p=207647 u=morteza n=ansible | TASK [loadbalancer : Update all packages] ********************************************************************************************************************
2023-06-06 08:55:44,859 p=207647 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 08:55:44,867 p=207647 u=morteza n=ansible | TASK [loadbalancer : Create directory if it does not exist] **************************************************************************************************
2023-06-06 08:55:45,522 p=207647 u=morteza n=ansible | changed: [lb.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-06 08:55:46,174 p=207647 u=morteza n=ansible | changed: [lb.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-06 08:55:46,188 p=207647 u=morteza n=ansible | TASK [loadbalancer : nginx config override] ******************************************************************************************************************
2023-06-06 08:55:47,617 p=207647 u=morteza n=ansible | changed: [lb.sudoer.net]
2023-06-06 08:55:47,629 p=207647 u=morteza n=ansible | TASK [loadbalancer : nginx config conf.d] ********************************************************************************************************************
2023-06-06 08:55:49,002 p=207647 u=morteza n=ansible | changed: [lb.sudoer.net]
2023-06-06 08:55:49,028 p=207647 u=morteza n=ansible | RUNNING HANDLER [iptables : restart iptables] ****************************************************************************************************************
2023-06-06 08:55:49,984 p=207647 u=morteza n=ansible | changed: [lb.sudoer.net]
2023-06-06 08:55:49,992 p=207647 u=morteza n=ansible | RUNNING HANDLER [fail2ban : restart fail2ban] ****************************************************************************************************************
2023-06-06 08:55:51,634 p=207647 u=morteza n=ansible | changed: [lb.sudoer.net]
2023-06-06 08:55:51,652 p=207647 u=morteza n=ansible | RUNNING HANDLER [loadbalancer : reload nginx] ****************************************************************************************************************
2023-06-06 08:55:52,923 p=207647 u=morteza n=ansible | changed: [lb.sudoer.net]
2023-06-06 08:55:52,941 p=207647 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-06 08:55:52,941 p=207647 u=morteza n=ansible | app1.sudoer.net            : ok=30   changed=20   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-06 08:55:52,942 p=207647 u=morteza n=ansible | app2.sudoer.net            : ok=30   changed=20   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-06 08:55:52,942 p=207647 u=morteza n=ansible | db.sudoer.net              : ok=20   changed=0    unreachable=0    failed=0    skipped=6    rescued=0    ignored=0   
2023-06-06 08:55:52,942 p=207647 u=morteza n=ansible | lb.sudoer.net              : ok=18   changed=14   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-06 09:07:42,374 p=210881 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-06 09:07:42,389 p=210881 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 09:07:45,352 p=210881 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 09:07:45,374 p=210881 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-06 09:07:48,303 p=210881 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 09:07:48,315 p=210881 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-06 09:07:52,389 p=210881 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 09:07:52,396 p=210881 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-06 09:07:54,078 p=210881 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 09:07:54,085 p=210881 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-06 09:07:56,291 p=210881 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 09:07:56,299 p=210881 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-06 09:07:57,365 p=210881 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 09:07:57,372 p=210881 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-06 09:07:59,268 p=210881 u=morteza n=ansible | ok: [db.sudoer.net] => (item=setup.sh)
2023-06-06 09:08:01,199 p=210881 u=morteza n=ansible | ok: [db.sudoer.net] => (item=config)
2023-06-06 09:08:01,215 p=210881 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-06 09:08:03,954 p=210881 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['fail2ban'])
2023-06-06 09:08:03,965 p=210881 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-06 09:08:08,552 p=210881 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 09:08:08,559 p=210881 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-06 09:08:10,551 p=210881 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 09:08:10,569 p=210881 u=morteza n=ansible | TASK [mariadb : set sysctl] **********************************************************************************************************************************
2023-06-06 09:08:11,755 p=210881 u=morteza n=ansible | ok: [db.sudoer.net] => (item={'name': 'net.ipv4.ip_forward', 'value': '0'})
2023-06-06 09:08:11,763 p=210881 u=morteza n=ansible | TASK [mariadb : Install the latest version packages] *********************************************************************************************************
2023-06-06 09:08:14,637 p=210881 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['mariadb-server', 'mariadb-client', 'python3-mysqldb', 'percona-toolkit'])
2023-06-06 09:08:14,646 p=210881 u=morteza n=ansible | TASK [mariadb : Update all packages] *************************************************************************************************************************
2023-06-06 09:08:19,020 p=210881 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 09:08:19,026 p=210881 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-06 09:08:20,123 p=210881 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 09:08:20,130 p=210881 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-06 09:08:20,147 p=210881 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 09:08:20,154 p=210881 u=morteza n=ansible | TASK [mariadb : Removes anonymous users] *********************************************************************************************************************
2023-06-06 09:08:21,437 p=210881 u=morteza n=ansible | ok: [db.sudoer.net] => (item=127.0.0.1)
2023-06-06 09:08:22,506 p=210881 u=morteza n=ansible | ok: [db.sudoer.net] => (item=localhost)
2023-06-06 09:08:22,516 p=210881 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ instance.name }}] ***********************************************************************************************************
2023-06-06 09:08:22,532 p=210881 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 09:08:22,543 p=210881 u=morteza n=ansible | TASK [mariadb : Update MariaDB root password] ****************************************************************************************************************
2023-06-06 09:08:22,565 p=210881 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=127.0.0.1) 
2023-06-06 09:08:22,565 p=210881 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=localhost) 
2023-06-06 09:08:22,566 p=210881 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 09:08:22,578 p=210881 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ user.name }}] ***************************************************************************************************************
2023-06-06 09:08:24,582 p=210881 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 09:08:24,588 p=210881 u=morteza n=ansible | TASK [mariadb : configuring instances] ***********************************************************************************************************************
2023-06-06 09:08:24,611 p=210881 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/database.yml for db.sudoer.net => (item={'name': 'sudoer_net'})
2023-06-06 09:08:24,619 p=210881 u=morteza n=ansible | TASK [mariadb : Create databases sudoer_net] *****************************************************************************************************************
2023-06-06 09:08:25,907 p=210881 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 09:08:25,944 p=210881 u=morteza n=ansible | TASK [mariadb : configuring users] ***************************************************************************************************************************
2023-06-06 09:08:26,012 p=210881 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/users.yml for db.sudoer.net => (item={'name': 'sudoer_user', 'priv': ['sudoer_net.*:ALL,GRANT']})
2023-06-06 09:08:26,021 p=210881 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-06 09:08:27,120 p=210881 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-06 09:08:27,126 p=210881 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-06 09:08:27,142 p=210881 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 09:08:27,149 p=210881 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf sudoer_user] *******************************************************************************************************************
2023-06-06 09:08:27,163 p=210881 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 09:08:27,170 p=210881 u=morteza n=ansible | TASK [mariadb : Create database user "sudoer_user"] **********************************************************************************************************
2023-06-06 09:08:27,188 p=210881 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=sudoer_net.*:ALL,GRANT) 
2023-06-06 09:08:27,190 p=210881 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-06 09:08:27,216 p=210881 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-06 09:08:27,230 p=210881 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 09:08:29,298 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 09:08:29,490 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 09:08:29,521 p=210881 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-06 09:08:31,887 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 09:08:33,030 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 09:08:33,038 p=210881 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-06 09:08:37,081 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 09:08:38,842 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 09:08:38,848 p=210881 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-06 09:08:39,925 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 09:08:40,232 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 09:08:40,240 p=210881 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-06 09:08:41,600 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 09:08:41,776 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 09:08:41,784 p=210881 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-06 09:08:42,514 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 09:08:42,543 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 09:08:42,549 p=210881 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-06 09:08:43,897 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-06 09:08:43,992 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-06 09:08:45,077 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-06 09:08:45,330 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-06 09:08:45,350 p=210881 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-06 09:08:47,824 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-06 09:08:48,773 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-06 09:08:48,781 p=210881 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-06 09:08:52,504 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 09:08:54,025 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 09:08:54,030 p=210881 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-06 09:08:55,311 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 09:08:55,466 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 09:08:55,496 p=210881 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-06 09:08:58,008 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-06 09:08:58,767 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-06 09:08:58,777 p=210881 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-06 09:09:03,133 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 09:09:04,041 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 09:09:04,048 p=210881 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-06 09:09:04,765 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-06 09:09:04,842 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-06 09:09:05,417 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-06 09:09:05,579 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-06 09:09:05,591 p=210881 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-06 09:09:06,783 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 09:09:06,926 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 09:09:06,933 p=210881 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-06 09:09:06,991 p=210881 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-06 09:09:07,006 p=210881 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-06 09:09:08,334 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 09:09:08,444 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 09:09:08,451 p=210881 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-06 09:09:09,728 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 09:09:09,839 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 09:09:09,858 p=210881 u=morteza n=ansible | TASK [php-fpm : Install the latest version packages] *********************************************************************************************************
2023-06-06 09:09:12,474 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-06 09:09:12,984 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-06 09:09:12,993 p=210881 u=morteza n=ansible | TASK [php-fpm : Update all packages] *************************************************************************************************************************
2023-06-06 09:09:16,839 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 09:09:18,348 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 09:09:18,368 p=210881 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-06 09:09:18,413 p=210881 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'db.sudoer.net', 'db_charset': 'utf8'})
2023-06-06 09:09:18,421 p=210881 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-06 09:09:19,187 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 09:09:19,244 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 09:09:19,254 p=210881 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-06 09:09:20,044 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 09:09:20,093 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 09:09:20,100 p=210881 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-06 09:09:20,122 p=210881 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-06 09:09:20,131 p=210881 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-06 09:09:20,144 p=210881 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-06 09:09:20,169 p=210881 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-06 09:09:20,179 p=210881 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-06 09:09:20,189 p=210881 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-06 09:09:21,613 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-06 09:09:21,614 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-06 09:09:21,621 p=210881 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-06 09:09:22,908 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-06 09:09:22,928 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-06 09:09:22,934 p=210881 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-06 09:09:24,175 p=210881 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-06 09:09:24,281 p=210881 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-06 09:09:24,336 p=210881 u=morteza n=ansible | PLAY [lb] ****************************************************************************************************************************************************
2023-06-06 09:09:24,348 p=210881 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-06 09:09:26,240 p=210881 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 09:09:26,260 p=210881 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-06 09:09:28,796 p=210881 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-06 09:09:28,807 p=210881 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-06 09:09:32,801 p=210881 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 09:09:32,808 p=210881 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-06 09:09:33,798 p=210881 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 09:09:33,809 p=210881 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-06 09:09:35,043 p=210881 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 09:09:35,050 p=210881 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-06 09:09:35,728 p=210881 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 09:09:35,733 p=210881 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-06 09:09:36,994 p=210881 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=setup.sh)
2023-06-06 09:09:38,145 p=210881 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=config)
2023-06-06 09:09:38,162 p=210881 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-06 09:09:40,560 p=210881 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['fail2ban'])
2023-06-06 09:09:40,567 p=210881 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-06 09:09:44,007 p=210881 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 09:09:44,014 p=210881 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-06 09:09:45,192 p=210881 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 09:09:45,203 p=210881 u=morteza n=ansible | TASK [loadbalancer : Install the latest version packages] ****************************************************************************************************
2023-06-06 09:09:47,311 p=210881 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-06 09:09:47,317 p=210881 u=morteza n=ansible | TASK [loadbalancer : Update all packages] ********************************************************************************************************************
2023-06-06 09:09:50,774 p=210881 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 09:09:50,784 p=210881 u=morteza n=ansible | TASK [loadbalancer : Create directory if it does not exist] **************************************************************************************************
2023-06-06 09:09:51,439 p=210881 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-06 09:09:52,031 p=210881 u=morteza n=ansible | ok: [lb.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-06 09:09:52,042 p=210881 u=morteza n=ansible | TASK [loadbalancer : nginx config override] ******************************************************************************************************************
2023-06-06 09:09:53,333 p=210881 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 09:09:53,339 p=210881 u=morteza n=ansible | TASK [loadbalancer : nginx config conf.d] ********************************************************************************************************************
2023-06-06 09:09:54,473 p=210881 u=morteza n=ansible | ok: [lb.sudoer.net]
2023-06-06 09:09:54,498 p=210881 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-06 09:09:54,498 p=210881 u=morteza n=ansible | app1.sudoer.net            : ok=25   changed=0    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-06-06 09:09:54,498 p=210881 u=morteza n=ansible | app2.sudoer.net            : ok=25   changed=0    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-06-06 09:09:54,498 p=210881 u=morteza n=ansible | db.sudoer.net              : ok=20   changed=0    unreachable=0    failed=0    skipped=6    rescued=0    ignored=0   
2023-06-06 09:09:54,498 p=210881 u=morteza n=ansible | lb.sudoer.net              : ok=15   changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
