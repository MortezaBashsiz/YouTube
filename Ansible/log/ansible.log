2023-06-05 15:44:03,819 p=148370 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 15:44:03,830 p=148370 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 15:44:06,382 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:44:06,420 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:06,453 p=148370 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 15:44:09,033 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 15:44:09,218 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 15:44:09,239 p=148370 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 15:44:12,833 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:13,254 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:44:13,272 p=148370 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 15:44:14,585 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:14,619 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:44:14,633 p=148370 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 15:44:16,322 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:16,370 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:44:16,390 p=148370 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 15:44:17,133 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:17,181 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:44:17,204 p=148370 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 15:44:18,606 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 15:44:18,638 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 15:44:20,089 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-05 15:44:20,179 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-05 15:44:20,217 p=148370 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 15:44:22,655 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-05 15:44:22,659 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-05 15:44:22,681 p=148370 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 15:44:26,262 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:26,457 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:44:26,476 p=148370 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 15:44:27,943 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:27,957 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:44:27,998 p=148370 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-05 15:44:30,485 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 15:44:30,497 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 15:44:30,522 p=148370 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-05 15:44:34,247 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:34,275 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:44:34,291 p=148370 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-05 15:44:35,110 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 15:44:35,145 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 15:44:35,880 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 15:44:35,885 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 15:44:35,911 p=148370 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-05 15:44:37,266 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:37,346 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:44:37,365 p=148370 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-05 15:44:37,411 p=148370 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-05 15:44:37,418 p=148370 u=morteza n=ansible | TASK [nginx : check if www dir exists {{ instance.name }}] ***************************************************************************************************
2023-06-05 15:44:38,211 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:44:38,215 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:38,231 p=148370 u=morteza n=ansible | TASK [nginx : get certificates] ******************************************************************************************************************************
2023-06-05 15:44:38,250 p=148370 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 15:44:42,317 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:42,326 p=148370 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 15:44:43,817 p=148370 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:44:43,960 p=148370 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:44:43,984 p=148370 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 15:44:45,973 p=148370 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 15:44:46,060 p=148370 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 15:44:46,118 p=148370 u=morteza n=ansible | RUNNING HANDLER [nginx : reload nginx] ***********************************************************************************************************************
2023-06-05 15:44:48,012 p=148370 u=morteza n=ansible | fatal: [app2.sudoer.net]: FAILED! => {"changed": false, "msg": "Unable to start service nginx: Job for nginx.service failed because the control process exited with error code.\nSee \"systemctl status nginx.service\" and \"journalctl -xe\" for details.\n"}
2023-06-05 15:44:48,018 p=148370 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 15:44:48,027 p=148370 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 15:44:48,027 p=148370 u=morteza n=ansible | app1.sudoer.net            : ok=19   changed=2    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-06-05 15:44:48,027 p=148370 u=morteza n=ansible | app2.sudoer.net            : ok=19   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2023-06-05 15:45:38,362 p=148870 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 15:45:38,374 p=148870 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 15:45:40,502 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:45:40,511 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:45:40,536 p=148870 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 15:45:43,124 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 15:45:43,282 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 15:45:43,303 p=148870 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 15:45:46,878 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:45:47,084 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:45:47,093 p=148870 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 15:45:48,318 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:45:48,384 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:45:48,407 p=148870 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 15:45:50,152 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:45:50,299 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:45:50,324 p=148870 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 15:45:51,111 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:45:51,117 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:45:51,124 p=148870 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 15:45:52,628 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 15:45:52,723 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 15:45:53,996 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-05 15:45:54,193 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-05 15:45:54,226 p=148870 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 15:45:56,880 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-05 15:45:56,963 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-05 15:45:56,985 p=148870 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 15:46:00,657 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:46:00,720 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:46:00,734 p=148870 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 15:46:02,194 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:46:02,222 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:46:02,238 p=148870 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-05 15:46:04,647 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 15:46:04,655 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 15:46:04,665 p=148870 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-05 15:46:08,368 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:46:08,700 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:46:08,708 p=148870 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-05 15:46:09,489 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 15:46:09,543 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 15:46:10,247 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 15:46:10,366 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 15:46:10,395 p=148870 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-05 15:46:11,763 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:46:11,793 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:46:11,814 p=148870 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-05 15:46:11,855 p=148870 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-05 15:46:11,863 p=148870 u=morteza n=ansible | TASK [nginx : check if www dir exists {{ instance.name }}] ***************************************************************************************************
2023-06-05 15:46:12,583 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:46:12,629 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:46:12,651 p=148870 u=morteza n=ansible | TASK [nginx : get certificates] ******************************************************************************************************************************
2023-06-05 15:46:12,673 p=148870 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 15:46:12,680 p=148870 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 15:46:12,688 p=148870 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 15:46:14,010 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:46:14,091 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:46:14,120 p=148870 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 15:46:15,462 p=148870 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:46:15,600 p=148870 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:46:15,695 p=148870 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 15:46:15,695 p=148870 u=morteza n=ansible | app1.sudoer.net            : ok=18   changed=0    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-06-05 15:46:15,695 p=148870 u=morteza n=ansible | app2.sudoer.net            : ok=18   changed=0    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-06-05 15:53:10,512 p=150135 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 15:53:10,524 p=150135 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 15:53:12,857 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:12,952 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:12,996 p=150135 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 15:53:15,478 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 15:53:15,602 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 15:53:15,625 p=150135 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 15:53:19,240 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:19,398 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:19,419 p=150135 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 15:53:20,677 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:20,680 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:20,702 p=150135 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 15:53:22,481 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:22,484 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:22,508 p=150135 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 15:53:23,264 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:23,305 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:23,327 p=150135 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 15:53:24,775 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 15:53:24,802 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 15:53:26,186 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-05 15:53:26,221 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-05 15:53:26,263 p=150135 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 15:53:29,051 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-05 15:53:29,801 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-05 15:53:29,811 p=150135 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 15:53:33,442 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:33,794 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:33,802 p=150135 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 15:53:35,303 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:35,334 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:35,365 p=150135 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-05 15:53:37,801 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 15:53:37,862 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 15:53:37,883 p=150135 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-05 15:53:41,444 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:41,829 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:41,852 p=150135 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-05 15:53:42,647 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 15:53:42,678 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 15:53:43,549 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 15:53:43,623 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 15:53:43,653 p=150135 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-05 15:53:44,973 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:45,091 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:45,115 p=150135 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-05 15:53:45,156 p=150135 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-05 15:53:45,163 p=150135 u=morteza n=ansible | TASK [nginx : check if www dir exists {{ instance.name }}] ***************************************************************************************************
2023-06-05 15:53:45,904 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:45,980 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:46,001 p=150135 u=morteza n=ansible | TASK [nginx : get certificates] ******************************************************************************************************************************
2023-06-05 15:53:46,020 p=150135 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 15:53:46,029 p=150135 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 15:53:46,036 p=150135 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 15:53:47,347 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:47,510 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:47,535 p=150135 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 15:53:49,060 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:53:49,169 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:53:49,206 p=150135 u=morteza n=ansible | TASK [php-fpm : Install the latest version packages] *********************************************************************************************************
2023-06-05 15:54:07,562 p=150135 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 15:54:07,855 p=150135 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 15:54:07,878 p=150135 u=morteza n=ansible | TASK [php-fpm : Update all packages] *************************************************************************************************************************
2023-06-05 15:54:11,367 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:54:11,832 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:54:11,872 p=150135 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-05 15:54:11,908 p=150135 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'localhost', 'db_charset': 'utf8'})
2023-06-05 15:54:11,915 p=150135 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-05 15:54:12,672 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:54:12,714 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:54:12,738 p=150135 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-05 15:54:13,535 p=150135 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 15:54:13,581 p=150135 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 15:54:13,607 p=150135 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-05 15:54:18,949 p=150135 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 15:54:19,109 p=150135 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 15:54:19,137 p=150135 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-05 15:54:20,139 p=150135 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 15:54:20,143 p=150135 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 15:54:20,168 p=150135 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-05 15:54:22,006 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 15:54:22,010 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 15:54:22,028 p=150135 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-05 15:54:23,295 p=150135 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 15:54:23,296 p=150135 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 15:54:23,318 p=150135 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-05 15:54:25,043 p=150135 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 15:54:25,078 p=150135 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 15:54:25,145 p=150135 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 15:54:25,145 p=150135 u=morteza n=ansible | app1.sudoer.net            : ok=28   changed=5    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-06-05 15:54:25,145 p=150135 u=morteza n=ansible | app2.sudoer.net            : ok=28   changed=5    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-06-05 15:56:00,038 p=150995 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 15:56:00,050 p=150995 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 15:56:00,769 p=150995 u=morteza n=ansible |  [ERROR]: User interrupted execution

2023-06-05 15:56:05,908 p=151020 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 15:56:05,920 p=151020 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 15:56:07,888 p=151020 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:56:07,998 p=151020 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:56:08,048 p=151020 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 15:56:10,491 p=151020 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 15:56:10,613 p=151020 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 15:56:10,663 p=151020 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 15:56:14,501 p=151020 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:56:14,742 p=151020 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:56:14,764 p=151020 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 15:56:16,018 p=151020 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:56:16,076 p=151020 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:56:16,099 p=151020 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 15:56:18,097 p=151020 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 15:56:18,100 p=151020 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 15:56:18,121 p=151020 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 15:56:19,011 p=151020 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:56:19,050 p=151020 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:56:19,070 p=151020 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 15:56:20,453 p=151020 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 15:56:20,511 p=151020 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 15:56:21,830 p=151020 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-05 15:56:21,971 p=151020 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-05 15:56:22,059 p=151020 u=morteza n=ansible | RUNNING HANDLER [iptables : restart iptables] ****************************************************************************************************************
2023-06-05 15:56:23,413 p=151020 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 15:56:23,495 p=151020 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 15:56:23,524 p=151020 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 15:56:23,524 p=151020 u=morteza n=ansible | app1.sudoer.net            : ok=8    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 15:56:23,525 p=151020 u=morteza n=ansible | app2.sudoer.net            : ok=8    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 15:56:42,482 p=151246 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 15:56:42,494 p=151246 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 15:56:44,577 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:56:44,706 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:56:44,738 p=151246 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 15:56:47,351 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 15:56:47,730 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 15:56:47,751 p=151246 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 15:56:51,329 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:56:51,469 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:56:51,492 p=151246 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 15:56:52,724 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:56:52,726 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:56:52,747 p=151246 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 15:56:54,411 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:56:54,429 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:56:54,454 p=151246 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 15:56:55,219 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:56:55,250 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:56:55,270 p=151246 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 15:56:56,626 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 15:56:56,846 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 15:56:57,886 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-05 15:56:58,289 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-05 15:56:58,325 p=151246 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 15:57:00,730 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-05 15:57:00,743 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-05 15:57:00,755 p=151246 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 15:57:04,345 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:57:04,711 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:57:04,719 p=151246 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 15:57:06,184 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:57:06,186 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:57:06,261 p=151246 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-05 15:57:08,654 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 15:57:08,752 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 15:57:08,782 p=151246 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-05 15:57:12,403 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:57:12,555 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:57:12,579 p=151246 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-05 15:57:13,353 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 15:57:13,455 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 15:57:14,064 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 15:57:14,226 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 15:57:14,259 p=151246 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-05 15:57:15,583 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:57:15,765 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:57:15,789 p=151246 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-05 15:57:15,830 p=151246 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-05 15:57:15,838 p=151246 u=morteza n=ansible | TASK [nginx : check if www dir exists {{ instance.name }}] ***************************************************************************************************
2023-06-05 15:57:16,643 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:57:16,683 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:57:16,704 p=151246 u=morteza n=ansible | TASK [nginx : get certificates] ******************************************************************************************************************************
2023-06-05 15:57:16,725 p=151246 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 15:57:16,733 p=151246 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 15:57:16,741 p=151246 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 15:57:18,134 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:57:18,185 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:57:18,209 p=151246 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 15:57:19,580 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:57:19,673 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:57:19,713 p=151246 u=morteza n=ansible | TASK [php-fpm : Install the latest version packages] *********************************************************************************************************
2023-06-05 15:57:22,193 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 15:57:22,246 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 15:57:22,268 p=151246 u=morteza n=ansible | TASK [php-fpm : Update all packages] *************************************************************************************************************************
2023-06-05 15:57:25,783 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:57:26,106 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:57:26,146 p=151246 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-05 15:57:26,184 p=151246 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'localhost', 'db_charset': 'utf8'})
2023-06-05 15:57:26,191 p=151246 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-05 15:57:26,940 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:57:26,980 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:57:26,992 p=151246 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-05 15:57:27,807 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 15:57:27,834 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 15:57:27,855 p=151246 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-05 15:57:27,879 p=151246 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 15:57:27,886 p=151246 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 15:57:27,893 p=151246 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-05 15:57:28,750 p=151246 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 15:57:28,845 p=151246 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 15:57:28,869 p=151246 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-05 15:57:30,914 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 15:57:30,916 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 15:57:30,940 p=151246 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-05 15:57:32,328 p=151246 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 15:57:32,331 p=151246 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 15:57:32,353 p=151246 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-05 15:57:33,745 p=151246 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 15:57:33,880 p=151246 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 15:57:33,946 p=151246 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 15:57:33,946 p=151246 u=morteza n=ansible | app1.sudoer.net            : ok=27   changed=2    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-06-05 15:57:33,946 p=151246 u=morteza n=ansible | app2.sudoer.net            : ok=27   changed=2    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-06-05 16:11:20,893 p=152713 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 16:11:20,905 p=152713 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 16:11:23,798 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:11:24,033 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:11:24,082 p=152713 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 16:11:26,661 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 16:11:26,795 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 16:11:26,815 p=152713 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 16:11:30,350 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:11:30,508 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:11:30,530 p=152713 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 16:11:31,842 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:11:31,856 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:11:31,878 p=152713 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 16:11:33,554 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:11:33,562 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:11:33,589 p=152713 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 16:11:34,444 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:11:34,453 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:11:34,476 p=152713 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 16:11:35,943 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 16:11:35,950 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 16:11:37,342 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-05 16:11:37,449 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-05 16:11:37,491 p=152713 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 16:11:39,937 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-05 16:11:39,980 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-05 16:11:39,995 p=152713 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 16:11:43,861 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:11:43,863 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:11:43,882 p=152713 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 16:11:45,260 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:11:45,396 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:11:45,432 p=152713 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-05 16:11:47,777 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 16:11:47,823 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 16:11:47,836 p=152713 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-05 16:11:51,439 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:11:51,479 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:11:51,500 p=152713 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-05 16:11:52,326 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 16:11:52,328 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 16:11:53,123 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 16:11:53,160 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 16:11:53,187 p=152713 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-05 16:11:54,518 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:11:54,560 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:11:54,582 p=152713 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-05 16:11:54,625 p=152713 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-05 16:11:54,632 p=152713 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 16:11:55,993 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:11:56,090 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:11:56,113 p=152713 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 16:11:57,832 p=152713 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:11:57,889 p=152713 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:11:57,930 p=152713 u=morteza n=ansible | TASK [php-fpm : Install the latest version packages] *********************************************************************************************************
2023-06-05 16:12:00,362 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 16:12:00,415 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 16:12:00,440 p=152713 u=morteza n=ansible | TASK [php-fpm : Update all packages] *************************************************************************************************************************
2023-06-05 16:12:04,209 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:12:04,283 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:12:04,313 p=152713 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-05 16:12:04,352 p=152713 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'localhost', 'db_charset': 'utf8'})
2023-06-05 16:12:04,358 p=152713 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-05 16:12:05,160 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:12:05,217 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:12:05,238 p=152713 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-05 16:12:06,026 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:12:06,095 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:12:06,119 p=152713 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-05 16:12:06,144 p=152713 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 16:12:06,152 p=152713 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 16:12:06,161 p=152713 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-05 16:12:07,070 p=152713 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:12:07,120 p=152713 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:12:07,145 p=152713 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-05 16:12:09,001 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 16:12:09,003 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 16:12:09,026 p=152713 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-05 16:12:10,484 p=152713 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 16:12:10,485 p=152713 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 16:12:10,492 p=152713 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-05 16:12:11,883 p=152713 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:12:11,931 p=152713 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:12:11,985 p=152713 u=morteza n=ansible | RUNNING HANDLER [nginx : reload nginx] ***********************************************************************************************************************
2023-06-05 16:12:13,786 p=152713 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:12:13,852 p=152713 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:12:13,887 p=152713 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 16:12:13,887 p=152713 u=morteza n=ansible | app1.sudoer.net            : ok=27   changed=4    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-06-05 16:12:13,888 p=152713 u=morteza n=ansible | app2.sudoer.net            : ok=27   changed=4    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-06-05 16:14:40,604 p=153485 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 16:14:40,617 p=153485 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 16:14:43,730 p=153485 u=morteza n=ansible | fatal: [db.sudoer.net]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host db.sudoer.net port 22: No route to host", "unreachable": true}
2023-06-05 16:14:43,733 p=153485 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 16:14:43,734 p=153485 u=morteza n=ansible | db.sudoer.net              : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 16:14:45,936 p=153493 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 16:14:45,948 p=153493 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 16:14:45,986 p=153493 u=morteza n=ansible | fatal: [db.sudoer.net]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host db.sudoer.net port 22: Connection refused", "unreachable": true}
2023-06-05 16:14:45,987 p=153493 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 16:14:45,987 p=153493 u=morteza n=ansible | db.sudoer.net              : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 16:14:47,438 p=153501 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 16:14:47,451 p=153501 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 16:14:50,254 p=153501 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:14:50,270 p=153501 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 16:15:06,642 p=153501 u=morteza n=ansible | changed: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 16:15:06,662 p=153501 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 16:15:10,443 p=153501 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:15:10,467 p=153501 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 16:15:11,736 p=153501 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:15:11,762 p=153501 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 16:15:13,689 p=153501 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 16:15:13,712 p=153501 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 16:15:14,537 p=153501 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 16:15:14,559 p=153501 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 16:15:16,115 p=153501 u=morteza n=ansible | changed: [db.sudoer.net] => (item=setup.sh)
2023-06-05 16:15:17,684 p=153501 u=morteza n=ansible | changed: [db.sudoer.net] => (item=config)
2023-06-05 16:15:17,718 p=153501 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 16:15:24,224 p=153501 u=morteza n=ansible | changed: [db.sudoer.net] => (item=['fail2ban'])
2023-06-05 16:15:24,246 p=153501 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 16:15:28,198 p=153501 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:15:28,218 p=153501 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 16:15:29,837 p=153501 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 16:15:29,870 p=153501 u=morteza n=ansible | TASK [mariadb : set sysctl] **********************************************************************************************************************************
2023-06-05 16:15:30,731 p=153501 u=morteza n=ansible | changed: [db.sudoer.net] => (item={'name': 'net.ipv4.ip_forward', 'value': '0'})
2023-06-05 16:15:30,754 p=153501 u=morteza n=ansible | TASK [mariadb : Install the latest version packages] *********************************************************************************************************
2023-06-05 16:15:48,530 p=153501 u=morteza n=ansible | changed: [db.sudoer.net] => (item=['mariadb-server', 'mariadb-client', 'python3-mysqldb', 'percona-toolkit'])
2023-06-05 16:15:48,552 p=153501 u=morteza n=ansible | TASK [mariadb : Update all packages] *************************************************************************************************************************
2023-06-05 16:15:52,706 p=153501 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:15:52,721 p=153501 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 16:15:53,487 p=153501 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:15:53,505 p=153501 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 16:15:53,536 p=153501 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:15:53,544 p=153501 u=morteza n=ansible | TASK [mariadb : Removes anonymous users] *********************************************************************************************************************
2023-06-05 16:15:54,440 p=153501 u=morteza n=ansible | ok: [db.sudoer.net] => (item=127.0.0.1)
2023-06-05 16:15:55,290 p=153501 u=morteza n=ansible | ok: [db.sudoer.net] => (item=localhost)
2023-06-05 16:15:55,320 p=153501 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ instance.name }}] ***********************************************************************************************************
2023-06-05 16:15:56,864 p=153501 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 16:15:56,886 p=153501 u=morteza n=ansible | TASK [mariadb : Update MariaDB root password] ****************************************************************************************************************
2023-06-05 16:15:57,651 p=153501 u=morteza n=ansible | changed: [db.sudoer.net] => (item=127.0.0.1)
2023-06-05 16:15:58,446 p=153501 u=morteza n=ansible | changed: [db.sudoer.net] => (item=localhost)
2023-06-05 16:15:58,467 p=153501 u=morteza n=ansible | TASK [mariadb : configuring instances] ***********************************************************************************************************************
2023-06-05 16:15:58,501 p=153501 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/database.yml for db.sudoer.net => (item={'name': 'sudoer_net'})
2023-06-05 16:15:58,509 p=153501 u=morteza n=ansible | TASK [mariadb : Create databases sudoer_net] *****************************************************************************************************************
2023-06-05 16:15:59,355 p=153501 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 16:15:59,374 p=153501 u=morteza n=ansible | TASK [mariadb : configuring users] ***************************************************************************************************************************
2023-06-05 16:15:59,403 p=153501 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/users.yml for db.sudoer.net => (item={'name': 'sudoer_user', 'priv': ['sudoer_net.*:ALL,GRANT']})
2023-06-05 16:15:59,412 p=153501 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 16:16:00,128 p=153501 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:16:00,151 p=153501 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 16:16:00,191 p=153501 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:16:00,199 p=153501 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf sudoer_user] *******************************************************************************************************************
2023-06-05 16:16:01,712 p=153501 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 16:16:01,735 p=153501 u=morteza n=ansible | TASK [mariadb : Create database user "sudoer_user"] **********************************************************************************************************
2023-06-05 16:16:02,541 p=153501 u=morteza n=ansible | changed: [db.sudoer.net] => (item=sudoer_net.*:ALL,GRANT)
2023-06-05 16:16:02,583 p=153501 u=morteza n=ansible | RUNNING HANDLER [iptables : restart iptables] ****************************************************************************************************************
2023-06-05 16:16:03,951 p=153501 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 16:16:03,972 p=153501 u=morteza n=ansible | RUNNING HANDLER [fail2ban : restart fail2ban] ****************************************************************************************************************
2023-06-05 16:16:05,962 p=153501 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 16:16:05,998 p=153501 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 16:16:05,998 p=153501 u=morteza n=ansible | db.sudoer.net              : ok=27   changed=15   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 16:16:10,918 p=153809 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 16:16:10,933 p=153809 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 16:16:13,548 p=153809 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:16:13,565 p=153809 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:16:13,608 p=153809 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 16:16:28,659 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 16:16:30,310 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 16:16:30,321 p=153809 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 16:16:36,052 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:16:36,315 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:16:36,337 p=153809 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 16:16:37,638 p=153809 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:16:37,696 p=153809 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:16:37,721 p=153809 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 16:16:39,792 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:16:39,895 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:16:39,916 p=153809 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 16:16:40,782 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:16:40,940 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:16:40,952 p=153809 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 16:16:42,553 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 16:16:42,645 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 16:16:44,145 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=config)
2023-06-05 16:16:44,347 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=config)
2023-06-05 16:16:44,387 p=153809 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 16:16:50,231 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-05 16:16:51,303 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-05 16:16:51,327 p=153809 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 16:16:55,102 p=153809 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:16:55,348 p=153809 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:16:55,367 p=153809 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 16:16:57,026 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:16:57,049 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:16:57,087 p=153809 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-05 16:17:10,747 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 16:17:11,069 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 16:17:11,080 p=153809 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-05 16:17:14,839 p=153809 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:17:15,035 p=153809 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:17:15,061 p=153809 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-05 16:17:15,870 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 16:17:15,895 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 16:17:16,605 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 16:17:16,677 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 16:17:16,706 p=153809 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-05 16:17:18,284 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:17:18,356 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:17:18,378 p=153809 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-05 16:17:18,421 p=153809 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-05 16:17:18,428 p=153809 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 16:17:20,001 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:17:20,090 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:17:20,105 p=153809 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 16:17:21,712 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:17:21,735 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:17:21,771 p=153809 u=morteza n=ansible | TASK [php-fpm : Install the latest version packages] *********************************************************************************************************
2023-06-05 16:17:40,069 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 16:17:40,954 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 16:17:40,978 p=153809 u=morteza n=ansible | TASK [php-fpm : Update all packages] *************************************************************************************************************************
2023-06-05 16:17:44,747 p=153809 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:17:44,782 p=153809 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:17:44,820 p=153809 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-05 16:17:44,858 p=153809 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'localhost', 'db_charset': 'utf8'})
2023-06-05 16:17:44,864 p=153809 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-05 16:17:45,630 p=153809 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:17:45,653 p=153809 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:17:45,680 p=153809 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-05 16:17:46,480 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:17:46,480 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:17:46,487 p=153809 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-05 16:17:51,930 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:17:52,008 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:17:52,025 p=153809 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-05 16:17:52,988 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:17:53,004 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:17:53,022 p=153809 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-05 16:17:54,521 p=153809 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 16:17:54,623 p=153809 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 16:17:54,647 p=153809 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-05 16:17:55,896 p=153809 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 16:17:55,897 p=153809 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 16:17:55,906 p=153809 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-05 16:17:57,618 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:17:57,622 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:17:57,679 p=153809 u=morteza n=ansible | RUNNING HANDLER [iptables : restart iptables] ****************************************************************************************************************
2023-06-05 16:17:59,123 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:17:59,249 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:17:59,267 p=153809 u=morteza n=ansible | RUNNING HANDLER [fail2ban : restart fail2ban] ****************************************************************************************************************
2023-06-05 16:18:01,003 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:18:01,300 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:18:01,320 p=153809 u=morteza n=ansible | RUNNING HANDLER [nginx : reload nginx] ***********************************************************************************************************************
2023-06-05 16:18:02,843 p=153809 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:18:02,886 p=153809 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:18:02,920 p=153809 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 16:18:02,920 p=153809 u=morteza n=ansible | app1.sudoer.net            : ok=30   changed=20   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 16:18:02,920 p=153809 u=morteza n=ansible | app2.sudoer.net            : ok=30   changed=20   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 16:22:37,191 p=155251 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 16:22:37,203 p=155251 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 16:22:38,934 p=155251 u=morteza n=ansible |  [ERROR]: User interrupted execution

2023-06-05 16:22:44,635 p=155281 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 16:22:44,648 p=155281 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 16:22:46,566 p=155281 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:22:46,936 p=155281 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:22:47,016 p=155281 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-05 16:22:47,054 p=155281 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'db.sudoer.net', 'db_charset': 'utf8'})
2023-06-05 16:22:47,061 p=155281 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-05 16:22:47,950 p=155281 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:22:47,987 p=155281 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:22:48,011 p=155281 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-05 16:22:49,045 p=155281 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 16:22:49,096 p=155281 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 16:22:49,114 p=155281 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-05 16:22:49,133 p=155281 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 16:22:49,140 p=155281 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 16:22:49,148 p=155281 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-05 16:22:50,014 p=155281 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:22:50,094 p=155281 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:22:50,117 p=155281 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-05 16:22:51,903 p=155281 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 16:22:51,908 p=155281 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 16:22:51,926 p=155281 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-05 16:22:53,451 p=155281 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 16:22:53,455 p=155281 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 16:22:53,479 p=155281 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-05 16:22:55,325 p=155281 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 16:22:55,441 p=155281 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 16:22:55,506 p=155281 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 16:22:55,507 p=155281 u=morteza n=ansible | app1.sudoer.net            : ok=8    changed=2    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-06-05 16:22:55,507 p=155281 u=morteza n=ansible | app2.sudoer.net            : ok=8    changed=2    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-06-05 16:54:26,523 p=158078 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 16:54:26,536 p=158078 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 16:54:28,417 p=158078 u=morteza n=ansible |  [ERROR]: User interrupted execution

2023-06-05 16:54:33,561 p=158139 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 16:54:33,573 p=158139 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 16:54:34,064 p=158139 u=morteza n=ansible |  [ERROR]: User interrupted execution

2023-06-05 16:54:36,417 p=158149 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 16:54:36,430 p=158149 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 16:54:38,525 p=158149 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:54:38,554 p=158149 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 16:54:42,685 p=158149 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 16:54:42,698 p=158149 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 16:54:47,548 p=158149 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:54:47,563 p=158149 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 16:54:48,794 p=158149 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:54:48,815 p=158149 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 16:54:50,393 p=158149 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:54:50,402 p=158149 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 16:54:51,367 p=158149 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:54:51,389 p=158149 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 16:54:52,783 p=158149 u=morteza n=ansible | ok: [db.sudoer.net] => (item=setup.sh)
2023-06-05 16:54:54,017 p=158149 u=morteza n=ansible | ok: [db.sudoer.net] => (item=config)
2023-06-05 16:54:54,053 p=158149 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 16:54:56,714 p=158149 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['fail2ban'])
2023-06-05 16:54:56,737 p=158149 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 16:55:01,601 p=158149 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:55:01,615 p=158149 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 16:55:02,989 p=158149 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:55:03,022 p=158149 u=morteza n=ansible | TASK [mariadb : set sysctl] **********************************************************************************************************************************
2023-06-05 16:55:04,227 p=158149 u=morteza n=ansible | ok: [db.sudoer.net] => (item={'name': 'net.ipv4.ip_forward', 'value': '0'})
2023-06-05 16:55:04,252 p=158149 u=morteza n=ansible | TASK [mariadb : Install the latest version packages] *********************************************************************************************************
2023-06-05 16:55:06,699 p=158149 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['mariadb-server', 'mariadb-client', 'python3-mysqldb', 'percona-toolkit'])
2023-06-05 16:55:06,722 p=158149 u=morteza n=ansible | TASK [mariadb : Update all packages] *************************************************************************************************************************
2023-06-05 16:55:10,782 p=158149 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:55:10,803 p=158149 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 16:55:11,541 p=158149 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:55:11,562 p=158149 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 16:55:11,581 p=158149 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 16:55:11,588 p=158149 u=morteza n=ansible | TASK [mariadb : Removes anonymous users] *********************************************************************************************************************
2023-06-05 16:55:12,529 p=158149 u=morteza n=ansible | ok: [db.sudoer.net] => (item=127.0.0.1)
2023-06-05 16:55:13,307 p=158149 u=morteza n=ansible | ok: [db.sudoer.net] => (item=localhost)
2023-06-05 16:55:13,336 p=158149 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ instance.name }}] ***********************************************************************************************************
2023-06-05 16:55:13,354 p=158149 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 16:55:13,362 p=158149 u=morteza n=ansible | TASK [mariadb : Update MariaDB root password] ****************************************************************************************************************
2023-06-05 16:55:13,381 p=158149 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=127.0.0.1) 
2023-06-05 16:55:13,382 p=158149 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=localhost) 
2023-06-05 16:55:13,383 p=158149 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 16:55:13,388 p=158149 u=morteza n=ansible | TASK [mariadb : configuring instances] ***********************************************************************************************************************
2023-06-05 16:55:13,408 p=158149 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/database.yml for db.sudoer.net => (item={'name': 'sudoer_net'})
2023-06-05 16:55:13,415 p=158149 u=morteza n=ansible | TASK [mariadb : Create databases sudoer_net] *****************************************************************************************************************
2023-06-05 16:55:14,356 p=158149 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:55:14,379 p=158149 u=morteza n=ansible | TASK [mariadb : configuring users] ***************************************************************************************************************************
2023-06-05 16:55:14,406 p=158149 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/users.yml for db.sudoer.net => (item={'name': 'sudoer_user', 'priv': ['sudoer_net.*:ALL,GRANT']})
2023-06-05 16:55:14,414 p=158149 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 16:55:15,216 p=158149 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:55:15,238 p=158149 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 16:55:15,258 p=158149 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 16:55:15,268 p=158149 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf sudoer_user] *******************************************************************************************************************
2023-06-05 16:55:15,281 p=158149 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 16:55:15,289 p=158149 u=morteza n=ansible | TASK [mariadb : Create database user "sudoer_user"] **********************************************************************************************************
2023-06-05 16:55:15,304 p=158149 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=sudoer_net.*:ALL,GRANT) 
2023-06-05 16:55:15,305 p=158149 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 16:55:15,328 p=158149 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 16:55:15,328 p=158149 u=morteza n=ansible | db.sudoer.net              : ok=19   changed=0    unreachable=0    failed=0    skipped=6    rescued=0    ignored=0   
2023-06-05 16:56:47,058 p=158486 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 16:56:47,071 p=158486 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 16:56:49,410 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:56:49,445 p=158486 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 16:56:52,037 p=158486 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 16:56:52,064 p=158486 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 16:56:56,107 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:56:56,128 p=158486 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 16:56:57,455 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:56:57,479 p=158486 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 16:56:59,114 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:56:59,139 p=158486 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 16:56:59,928 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:56:59,955 p=158486 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 16:57:01,292 p=158486 u=morteza n=ansible | ok: [db.sudoer.net] => (item=setup.sh)
2023-06-05 16:57:02,980 p=158486 u=morteza n=ansible | ok: [db.sudoer.net] => (item=config)
2023-06-05 16:57:03,017 p=158486 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 16:57:05,770 p=158486 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['fail2ban'])
2023-06-05 16:57:05,791 p=158486 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 16:57:10,521 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:57:10,538 p=158486 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 16:57:11,944 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:57:11,976 p=158486 u=morteza n=ansible | TASK [mariadb : set sysctl] **********************************************************************************************************************************
2023-06-05 16:57:12,898 p=158486 u=morteza n=ansible | ok: [db.sudoer.net] => (item={'name': 'net.ipv4.ip_forward', 'value': '0'})
2023-06-05 16:57:12,920 p=158486 u=morteza n=ansible | TASK [mariadb : Install the latest version packages] *********************************************************************************************************
2023-06-05 16:57:15,704 p=158486 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['mariadb-server', 'mariadb-client', 'python3-mysqldb', 'percona-toolkit'])
2023-06-05 16:57:15,727 p=158486 u=morteza n=ansible | TASK [mariadb : Update all packages] *************************************************************************************************************************
2023-06-05 16:57:19,542 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:57:19,562 p=158486 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 16:57:20,297 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:57:20,323 p=158486 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 16:57:20,346 p=158486 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 16:57:20,354 p=158486 u=morteza n=ansible | TASK [mariadb : Removes anonymous users] *********************************************************************************************************************
2023-06-05 16:57:21,256 p=158486 u=morteza n=ansible | ok: [db.sudoer.net] => (item=127.0.0.1)
2023-06-05 16:57:22,021 p=158486 u=morteza n=ansible | ok: [db.sudoer.net] => (item=localhost)
2023-06-05 16:57:22,055 p=158486 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ instance.name }}] ***********************************************************************************************************
2023-06-05 16:57:22,071 p=158486 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 16:57:22,078 p=158486 u=morteza n=ansible | TASK [mariadb : Update MariaDB root password] ****************************************************************************************************************
2023-06-05 16:57:22,098 p=158486 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=127.0.0.1) 
2023-06-05 16:57:22,099 p=158486 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=localhost) 
2023-06-05 16:57:22,100 p=158486 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 16:57:22,106 p=158486 u=morteza n=ansible | TASK [mariadb : configuring instances] ***********************************************************************************************************************
2023-06-05 16:57:22,127 p=158486 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/database.yml for db.sudoer.net => (item={'name': 'sudoer_net'})
2023-06-05 16:57:22,134 p=158486 u=morteza n=ansible | TASK [mariadb : Create databases sudoer_net] *****************************************************************************************************************
2023-06-05 16:57:23,077 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:57:23,097 p=158486 u=morteza n=ansible | TASK [mariadb : configuring users] ***************************************************************************************************************************
2023-06-05 16:57:23,137 p=158486 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/users.yml for db.sudoer.net => (item={'name': 'sudoer_user', 'priv': ['sudoer_net.*:ALL,GRANT']})
2023-06-05 16:57:23,145 p=158486 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 16:57:23,919 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:57:23,942 p=158486 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 16:57:23,977 p=158486 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 16:57:23,984 p=158486 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf sudoer_user] *******************************************************************************************************************
2023-06-05 16:57:25,622 p=158486 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 16:57:25,647 p=158486 u=morteza n=ansible | TASK [mariadb : Create database user "sudoer_user"] **********************************************************************************************************
2023-06-05 16:57:26,443 p=158486 u=morteza n=ansible | changed: [db.sudoer.net] => (item=sudoer_net.*:ALL,GRANT)
2023-06-05 16:57:26,497 p=158486 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 16:57:26,497 p=158486 u=morteza n=ansible | db.sudoer.net              : ok=22   changed=2    unreachable=0    failed=0    skipped=3    rescued=0    ignored=0   
2023-06-05 17:22:59,045 p=160123 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 17:22:59,057 p=160123 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:23:01,415 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:01,451 p=160123 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:23:04,308 p=160123 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:23:04,333 p=160123 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:23:08,469 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:08,490 p=160123 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 17:23:09,727 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:09,733 p=160123 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 17:23:11,436 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:11,457 p=160123 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 17:23:12,177 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:12,199 p=160123 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 17:23:13,530 p=160123 u=morteza n=ansible | ok: [db.sudoer.net] => (item=setup.sh)
2023-06-05 17:23:14,835 p=160123 u=morteza n=ansible | ok: [db.sudoer.net] => (item=config)
2023-06-05 17:23:14,851 p=160123 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:23:17,442 p=160123 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:23:17,464 p=160123 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 17:23:21,302 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:21,321 p=160123 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 17:23:22,853 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:22,883 p=160123 u=morteza n=ansible | TASK [mariadb : set sysctl] **********************************************************************************************************************************
2023-06-05 17:23:23,699 p=160123 u=morteza n=ansible | ok: [db.sudoer.net] => (item={'name': 'net.ipv4.ip_forward', 'value': '0'})
2023-06-05 17:23:23,719 p=160123 u=morteza n=ansible | TASK [mariadb : Install the latest version packages] *********************************************************************************************************
2023-06-05 17:23:26,191 p=160123 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['mariadb-server', 'mariadb-client', 'python3-mysqldb', 'percona-toolkit'])
2023-06-05 17:23:26,208 p=160123 u=morteza n=ansible | TASK [mariadb : Update all packages] *************************************************************************************************************************
2023-06-05 17:23:30,041 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:30,063 p=160123 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 17:23:30,848 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:30,870 p=160123 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 17:23:30,896 p=160123 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:23:30,905 p=160123 u=morteza n=ansible | TASK [mariadb : Removes anonymous users] *********************************************************************************************************************
2023-06-05 17:23:31,821 p=160123 u=morteza n=ansible | ok: [db.sudoer.net] => (item=127.0.0.1)
2023-06-05 17:23:32,603 p=160123 u=morteza n=ansible | ok: [db.sudoer.net] => (item=localhost)
2023-06-05 17:23:32,632 p=160123 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ instance.name }}] ***********************************************************************************************************
2023-06-05 17:23:32,645 p=160123 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:23:32,652 p=160123 u=morteza n=ansible | TASK [mariadb : Update MariaDB root password] ****************************************************************************************************************
2023-06-05 17:23:32,667 p=160123 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=127.0.0.1) 
2023-06-05 17:23:32,668 p=160123 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=localhost) 
2023-06-05 17:23:32,669 p=160123 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:23:32,675 p=160123 u=morteza n=ansible | TASK [mariadb : configuring instances] ***********************************************************************************************************************
2023-06-05 17:23:32,693 p=160123 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/database.yml for db.sudoer.net => (item={'name': 'sudoer_net'})
2023-06-05 17:23:32,701 p=160123 u=morteza n=ansible | TASK [mariadb : Create databases sudoer_net] *****************************************************************************************************************
2023-06-05 17:23:33,562 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:33,582 p=160123 u=morteza n=ansible | TASK [mariadb : configuring users] ***************************************************************************************************************************
2023-06-05 17:23:33,622 p=160123 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/users.yml for db.sudoer.net => (item={'name': 'sudoer_user', 'priv': ['sudoer_net.*:ALL,GRANT']})
2023-06-05 17:23:33,630 p=160123 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 17:23:34,337 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:34,358 p=160123 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 17:23:34,394 p=160123 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:23:34,401 p=160123 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf sudoer_user] *******************************************************************************************************************
2023-06-05 17:23:36,268 p=160123 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 17:23:36,276 p=160123 u=morteza n=ansible | TASK [mariadb : Create database user "sudoer_user"] **********************************************************************************************************
2023-06-05 17:23:37,063 p=160123 u=morteza n=ansible | changed: [db.sudoer.net] => (item=sudoer_net.*:ALL,GRANT)
2023-06-05 17:23:37,105 p=160123 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 17:23:37,105 p=160123 u=morteza n=ansible | db.sudoer.net              : ok=22   changed=2    unreachable=0    failed=0    skipped=3    rescued=0    ignored=0   
2023-06-05 17:25:03,095 p=160580 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 17:25:03,109 p=160580 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:25:05,797 p=160580 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:05,803 p=160580 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:05,904 p=160580 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 17:25:05,904 p=160580 u=morteza n=ansible | app1.sudoer.net            : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 17:25:05,904 p=160580 u=morteza n=ansible | app2.sudoer.net            : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 17:25:09,520 p=160614 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 17:25:09,532 p=160614 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:25:11,510 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:11,514 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:11,534 p=160614 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:25:14,819 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:25:15,091 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:25:15,113 p=160614 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:25:18,651 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:18,765 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:18,786 p=160614 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 17:25:19,924 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:20,032 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:20,053 p=160614 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 17:25:21,916 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:21,948 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:21,965 p=160614 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 17:25:22,771 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:22,973 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:22,995 p=160614 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 17:25:24,475 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 17:25:24,526 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 17:25:25,864 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-05 17:25:25,871 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-05 17:25:25,898 p=160614 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:25:28,271 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:25:28,377 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:25:28,403 p=160614 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 17:25:32,105 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:32,145 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:32,156 p=160614 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 17:25:33,553 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:33,564 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:33,603 p=160614 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-05 17:25:35,985 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 17:25:36,084 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 17:25:36,106 p=160614 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-05 17:25:39,679 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:39,914 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:39,938 p=160614 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-05 17:25:40,818 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 17:25:40,858 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 17:25:41,548 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 17:25:41,603 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 17:25:41,631 p=160614 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-05 17:25:43,084 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:43,088 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:43,111 p=160614 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-05 17:25:43,154 p=160614 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-05 17:25:43,162 p=160614 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 17:25:44,496 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:44,561 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:44,584 p=160614 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 17:25:45,955 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:46,041 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:46,083 p=160614 u=morteza n=ansible | TASK [php-fpm : Install the latest version packages] *********************************************************************************************************
2023-06-05 17:25:48,409 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 17:25:48,526 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 17:25:48,545 p=160614 u=morteza n=ansible | TASK [php-fpm : Update all packages] *************************************************************************************************************************
2023-06-05 17:25:52,026 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:52,180 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:52,219 p=160614 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-05 17:25:52,256 p=160614 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'db.sudoer.net', 'db_charset': 'utf8'})
2023-06-05 17:25:52,263 p=160614 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-05 17:25:53,078 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:53,087 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:53,111 p=160614 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-05 17:25:53,873 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:25:53,894 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:25:53,912 p=160614 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-05 17:25:53,930 p=160614 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 17:25:53,938 p=160614 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 17:25:53,947 p=160614 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-05 17:25:54,790 p=160614 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:25:54,847 p=160614 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:25:54,870 p=160614 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-05 17:25:56,569 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 17:25:56,573 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 17:25:56,595 p=160614 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-05 17:25:58,013 p=160614 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 17:25:58,015 p=160614 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 17:25:58,036 p=160614 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-05 17:25:59,774 p=160614 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:25:59,835 p=160614 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:25:59,896 p=160614 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 17:25:59,896 p=160614 u=morteza n=ansible | app1.sudoer.net            : ok=26   changed=2    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-06-05 17:25:59,896 p=160614 u=morteza n=ansible | app2.sudoer.net            : ok=26   changed=2    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2023-06-05 17:32:12,571 p=161714 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 17:32:12,583 p=161714 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:32:14,961 p=161714 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:32:14,975 p=161714 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:32:15,033 p=161714 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-05 17:32:15,069 p=161714 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'db.sudoer.net', 'db_charset': 'utf8'})
2023-06-05 17:32:15,077 p=161714 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-05 17:32:15,978 p=161714 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:32:15,992 p=161714 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:32:16,010 p=161714 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-05 17:32:16,956 p=161714 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:32:16,978 p=161714 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:32:16,988 p=161714 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-05 17:32:17,010 p=161714 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 17:32:17,019 p=161714 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 17:32:17,026 p=161714 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-05 17:32:17,043 p=161714 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 17:32:17,051 p=161714 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 17:32:17,058 p=161714 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-05 17:32:18,754 p=161714 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 17:32:18,757 p=161714 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 17:32:18,776 p=161714 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-05 17:32:20,202 p=161714 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 17:32:20,204 p=161714 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 17:32:20,228 p=161714 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-05 17:32:21,639 p=161714 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:32:21,702 p=161714 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:32:21,766 p=161714 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 17:32:21,766 p=161714 u=morteza n=ansible | app1.sudoer.net            : ok=7    changed=0    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-06-05 17:32:21,766 p=161714 u=morteza n=ansible | app2.sudoer.net            : ok=7    changed=0    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-06-05 17:32:28,134 p=161863 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 17:32:28,146 p=161863 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:32:30,170 p=161863 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:32:30,321 p=161863 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:32:30,370 p=161863 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:32:32,818 p=161863 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:32:32,905 p=161863 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:32:32,926 p=161863 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:32:36,570 p=161863 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:32:36,673 p=161863 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:32:36,695 p=161863 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 17:32:37,929 p=161863 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:32:38,012 p=161863 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:32:38,017 p=161863 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 17:32:39,621 p=161863 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:32:39,647 p=161863 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:32:39,659 p=161863 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 17:32:40,431 p=161863 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:32:40,434 p=161863 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:32:40,458 p=161863 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 17:32:41,874 p=161863 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 17:32:41,892 p=161863 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 17:32:43,217 p=161863 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-05 17:32:43,345 p=161863 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-05 17:32:43,385 p=161863 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:32:45,803 p=161863 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:32:45,834 p=161863 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:32:45,853 p=161863 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 17:32:49,360 p=161863 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:32:49,624 p=161863 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:32:49,649 p=161863 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 17:32:50,430 p=161863 u=morteza n=ansible |  [ERROR]: User interrupted execution

2023-06-05 17:33:28,365 p=162131 u=morteza n=ansible | [WARNING]: While constructing a mapping from /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/playbooks/all.yml, line 3, column 1, found a duplicate
dict key (include). Using last defined value only.

2023-06-05 17:33:28,366 p=162131 u=morteza n=ansible | ERROR! A playbook must be a list of plays, got a <class 'ansible.parsing.yaml.objects.AnsibleMapping'> instead: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/playbooks/all.yml

The error appears to be in '/home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/playbooks/all.yml': line 3, column 1, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:


include: db.yml
^ here

2023-06-05 17:34:30,810 p=162300 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 17:34:30,821 p=162300 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:34:33,136 p=162300 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:34:33,163 p=162300 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:34:35,758 p=162300 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:34:35,780 p=162300 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:34:36,461 p=162300 u=morteza n=ansible |  [ERROR]: User interrupted execution

2023-06-05 17:37:34,258 p=162495 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 17:37:34,270 p=162495 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:37:36,971 p=162495 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:37:37,013 p=162495 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:37:51,712 p=162495 u=morteza n=ansible | changed: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:37:51,736 p=162495 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:37:55,260 p=162495 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:37:55,270 p=162495 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 17:37:56,506 p=162495 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:37:56,529 p=162495 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 17:37:58,367 p=162495 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 17:37:58,381 p=162495 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 17:37:59,194 p=162495 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 17:37:59,217 p=162495 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 17:38:00,743 p=162495 u=morteza n=ansible |  [ERROR]: User interrupted execution

2023-06-05 17:38:27,849 p=162611 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 17:38:27,861 p=162611 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:38:29,870 p=162611 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:38:29,893 p=162611 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:38:32,521 p=162611 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:38:32,543 p=162611 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:38:36,252 p=162611 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:38:36,267 p=162611 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 17:38:37,504 p=162611 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:38:37,529 p=162611 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 17:38:39,144 p=162611 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:38:39,162 p=162611 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 17:38:39,826 p=162611 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:38:39,853 p=162611 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 17:38:41,502 p=162611 u=morteza n=ansible | changed: [db.sudoer.net] => (item=setup.sh)
2023-06-05 17:38:42,942 p=162611 u=morteza n=ansible | changed: [db.sudoer.net] => (item=config)
2023-06-05 17:38:42,975 p=162611 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:38:49,154 p=162611 u=morteza n=ansible | changed: [db.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:38:49,177 p=162611 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 17:38:53,018 p=162611 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:38:53,035 p=162611 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 17:38:54,548 p=162611 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 17:38:54,579 p=162611 u=morteza n=ansible | TASK [mariadb : set sysctl] **********************************************************************************************************************************
2023-06-05 17:38:55,439 p=162611 u=morteza n=ansible | changed: [db.sudoer.net] => (item={'name': 'net.ipv4.ip_forward', 'value': '0'})
2023-06-05 17:38:55,450 p=162611 u=morteza n=ansible | TASK [mariadb : Install the latest version packages] *********************************************************************************************************
2023-06-05 17:39:12,307 p=162611 u=morteza n=ansible | changed: [db.sudoer.net] => (item=['mariadb-server', 'mariadb-client', 'python3-mysqldb', 'percona-toolkit'])
2023-06-05 17:39:12,329 p=162611 u=morteza n=ansible | TASK [mariadb : Update all packages] *************************************************************************************************************************
2023-06-05 17:39:15,908 p=162611 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:39:15,929 p=162611 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 17:39:16,599 p=162611 u=morteza n=ansible |  [ERROR]: User interrupted execution

2023-06-05 17:42:40,969 p=163053 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 17:42:40,981 p=163053 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:42:43,258 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:42:43,285 p=163053 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:47:48,457 p=163053 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:47:48,468 p=163053 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:47:52,388 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:47:52,401 p=163053 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 17:47:53,556 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:47:53,569 p=163053 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 17:47:55,090 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:47:55,113 p=163053 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 17:47:55,807 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:47:55,815 p=163053 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 17:47:57,003 p=163053 u=morteza n=ansible | ok: [db.sudoer.net] => (item=setup.sh)
2023-06-05 17:47:58,211 p=163053 u=morteza n=ansible | ok: [db.sudoer.net] => (item=config)
2023-06-05 17:47:58,244 p=163053 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:48:01,212 p=163053 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:48:01,233 p=163053 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 17:48:04,925 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:48:04,930 p=163053 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 17:48:06,285 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:48:06,313 p=163053 u=morteza n=ansible | TASK [mariadb : set sysctl] **********************************************************************************************************************************
2023-06-05 17:48:07,094 p=163053 u=morteza n=ansible | ok: [db.sudoer.net] => (item={'name': 'net.ipv4.ip_forward', 'value': '0'})
2023-06-05 17:48:07,113 p=163053 u=morteza n=ansible | TASK [mariadb : Install the latest version packages] *********************************************************************************************************
2023-06-05 17:48:09,373 p=163053 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['mariadb-server', 'mariadb-client', 'python3-mysqldb', 'percona-toolkit'])
2023-06-05 17:48:09,381 p=163053 u=morteza n=ansible | TASK [mariadb : Update all packages] *************************************************************************************************************************
2023-06-05 17:48:13,146 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:48:13,165 p=163053 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 17:48:13,840 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:48:13,856 p=163053 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 17:48:13,893 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:48:13,899 p=163053 u=morteza n=ansible | TASK [mariadb : Removes anonymous users] *********************************************************************************************************************
2023-06-05 17:48:14,773 p=163053 u=morteza n=ansible | ok: [db.sudoer.net] => (item=127.0.0.1)
2023-06-05 17:48:15,495 p=163053 u=morteza n=ansible | ok: [db.sudoer.net] => (item=localhost)
2023-06-05 17:48:15,508 p=163053 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ instance.name }}] ***********************************************************************************************************
2023-06-05 17:48:17,036 p=163053 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 17:48:17,059 p=163053 u=morteza n=ansible | TASK [mariadb : Update MariaDB root password] ****************************************************************************************************************
2023-06-05 17:48:17,766 p=163053 u=morteza n=ansible | changed: [db.sudoer.net] => (item=127.0.0.1)
2023-06-05 17:48:18,459 p=163053 u=morteza n=ansible | changed: [db.sudoer.net] => (item=localhost)
2023-06-05 17:48:18,485 p=163053 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ user.name }}] ***************************************************************************************************************
2023-06-05 17:48:19,975 p=163053 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 17:48:20,000 p=163053 u=morteza n=ansible | TASK [mariadb : configuring instances] ***********************************************************************************************************************
2023-06-05 17:48:20,032 p=163053 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/database.yml for db.sudoer.net => (item={'name': 'sudoer_net'})
2023-06-05 17:48:20,041 p=163053 u=morteza n=ansible | TASK [mariadb : Create databases sudoer_net] *****************************************************************************************************************
2023-06-05 17:48:21,159 p=163053 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 17:48:21,165 p=163053 u=morteza n=ansible | TASK [mariadb : configuring users] ***************************************************************************************************************************
2023-06-05 17:48:21,192 p=163053 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/users.yml for db.sudoer.net => (item={'name': 'sudoer_user', 'priv': ['sudoer_net.*:ALL,GRANT']})
2023-06-05 17:48:21,200 p=163053 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 17:48:21,874 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:48:21,880 p=163053 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 17:48:21,916 p=163053 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:48:21,924 p=163053 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf sudoer_user] *******************************************************************************************************************
2023-06-05 17:48:23,226 p=163053 u=morteza n=ansible | changed: [db.sudoer.net]
2023-06-05 17:48:23,253 p=163053 u=morteza n=ansible | TASK [mariadb : Create database user "sudoer_user"] **********************************************************************************************************
2023-06-05 17:48:23,963 p=163053 u=morteza n=ansible | changed: [db.sudoer.net] => (item=sudoer_net.*:ALL,GRANT)
2023-06-05 17:48:24,025 p=163053 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 17:48:24,037 p=163053 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:48:26,343 p=163053 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:48:26,413 p=163053 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:48:26,449 p=163053 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:48:40,446 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:48:42,034 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:48:42,046 p=163053 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:48:47,563 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:48:48,161 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:48:48,172 p=163053 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 17:48:49,287 p=163053 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:48:49,379 p=163053 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:48:49,400 p=163053 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 17:48:51,279 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:48:51,340 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:48:51,359 p=163053 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 17:48:52,044 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:48:52,084 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:48:52,096 p=163053 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 17:48:53,746 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 17:48:53,846 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 17:48:55,312 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=config)
2023-06-05 17:48:55,492 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=config)
2023-06-05 17:48:55,534 p=163053 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:49:01,184 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:49:01,544 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:49:01,570 p=163053 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 17:49:05,108 p=163053 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:49:05,206 p=163053 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:49:05,225 p=163053 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 17:49:06,787 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:49:06,917 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:49:06,955 p=163053 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-05 17:49:20,005 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 17:49:20,640 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 17:49:20,650 p=163053 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-05 17:49:24,141 p=163053 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:49:24,187 p=163053 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:49:24,193 p=163053 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-05 17:49:24,962 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 17:49:24,964 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 17:49:25,723 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 17:49:25,727 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 17:49:25,737 p=163053 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-05 17:49:27,336 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:49:27,395 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:49:27,407 p=163053 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-05 17:49:27,445 p=163053 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-05 17:49:27,453 p=163053 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 17:49:29,012 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:49:29,022 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:49:29,030 p=163053 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 17:49:30,561 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:49:30,693 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:49:30,725 p=163053 u=morteza n=ansible | TASK [php-fpm : Install the latest version packages] *********************************************************************************************************
2023-06-05 17:49:48,151 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 17:49:49,822 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 17:49:49,848 p=163053 u=morteza n=ansible | TASK [php-fpm : Update all packages] *************************************************************************************************************************
2023-06-05 17:49:53,310 p=163053 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:49:53,761 p=163053 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:49:53,796 p=163053 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-05 17:49:53,838 p=163053 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'db.sudoer.net', 'db_charset': 'utf8'})
2023-06-05 17:49:53,845 p=163053 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-05 17:49:54,562 p=163053 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:49:54,616 p=163053 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:49:54,629 p=163053 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-05 17:49:55,366 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:49:55,400 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:49:55,408 p=163053 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-05 17:50:00,599 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:50:00,741 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:50:00,763 p=163053 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-05 17:50:01,718 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:50:01,722 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:50:01,743 p=163053 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-05 17:50:03,154 p=163053 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 17:50:03,155 p=163053 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 17:50:03,167 p=163053 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-05 17:50:04,274 p=163053 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 17:50:04,275 p=163053 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 17:50:04,288 p=163053 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-05 17:50:05,831 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:50:05,905 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:50:05,955 p=163053 u=morteza n=ansible | RUNNING HANDLER [iptables : restart iptables] ****************************************************************************************************************
2023-06-05 17:50:07,371 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:50:07,375 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:50:07,383 p=163053 u=morteza n=ansible | RUNNING HANDLER [fail2ban : restart fail2ban] ****************************************************************************************************************
2023-06-05 17:50:08,824 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:50:09,436 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:50:09,444 p=163053 u=morteza n=ansible | RUNNING HANDLER [nginx : reload nginx] ***********************************************************************************************************************
2023-06-05 17:50:10,949 p=163053 u=morteza n=ansible | changed: [app2.sudoer.net]
2023-06-05 17:50:11,071 p=163053 u=morteza n=ansible | changed: [app1.sudoer.net]
2023-06-05 17:50:11,113 p=163053 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 17:50:11,113 p=163053 u=morteza n=ansible | app1.sudoer.net            : ok=30   changed=20   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 17:50:11,113 p=163053 u=morteza n=ansible | app2.sudoer.net            : ok=30   changed=20   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 17:50:11,113 p=163053 u=morteza n=ansible | db.sudoer.net              : ok=26   changed=6    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2023-06-05 17:51:27,312 p=164487 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 17:51:27,323 p=164487 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:51:29,555 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:51:29,571 p=164487 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:51:32,314 p=164487 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:51:32,338 p=164487 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:51:36,600 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:51:36,610 p=164487 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 17:51:37,804 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:51:37,823 p=164487 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 17:51:39,349 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:51:39,355 p=164487 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 17:51:40,010 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:51:40,017 p=164487 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 17:51:41,257 p=164487 u=morteza n=ansible | ok: [db.sudoer.net] => (item=setup.sh)
2023-06-05 17:51:42,367 p=164487 u=morteza n=ansible | ok: [db.sudoer.net] => (item=config)
2023-06-05 17:51:42,386 p=164487 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:51:44,766 p=164487 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:51:44,776 p=164487 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 17:51:48,335 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:51:48,349 p=164487 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 17:51:49,661 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:51:49,683 p=164487 u=morteza n=ansible | TASK [mariadb : set sysctl] **********************************************************************************************************************************
2023-06-05 17:51:50,457 p=164487 u=morteza n=ansible | ok: [db.sudoer.net] => (item={'name': 'net.ipv4.ip_forward', 'value': '0'})
2023-06-05 17:51:50,464 p=164487 u=morteza n=ansible | TASK [mariadb : Install the latest version packages] *********************************************************************************************************
2023-06-05 17:51:52,728 p=164487 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['mariadb-server', 'mariadb-client', 'python3-mysqldb', 'percona-toolkit'])
2023-06-05 17:51:52,749 p=164487 u=morteza n=ansible | TASK [mariadb : Update all packages] *************************************************************************************************************************
2023-06-05 17:51:56,451 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:51:56,473 p=164487 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 17:51:57,231 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:51:57,249 p=164487 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 17:51:57,271 p=164487 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:51:57,277 p=164487 u=morteza n=ansible | TASK [mariadb : Removes anonymous users] *********************************************************************************************************************
2023-06-05 17:51:58,146 p=164487 u=morteza n=ansible | ok: [db.sudoer.net] => (item=127.0.0.1)
2023-06-05 17:51:58,844 p=164487 u=morteza n=ansible | ok: [db.sudoer.net] => (item=localhost)
2023-06-05 17:51:58,874 p=164487 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ instance.name }}] ***********************************************************************************************************
2023-06-05 17:51:58,890 p=164487 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:51:58,896 p=164487 u=morteza n=ansible | TASK [mariadb : Update MariaDB root password] ****************************************************************************************************************
2023-06-05 17:51:58,913 p=164487 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=127.0.0.1) 
2023-06-05 17:51:58,914 p=164487 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=localhost) 
2023-06-05 17:51:58,915 p=164487 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:51:58,922 p=164487 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ user.name }}] ***************************************************************************************************************
2023-06-05 17:52:00,249 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:52:00,266 p=164487 u=morteza n=ansible | TASK [mariadb : configuring instances] ***********************************************************************************************************************
2023-06-05 17:52:00,293 p=164487 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/database.yml for db.sudoer.net => (item={'name': 'sudoer_net'})
2023-06-05 17:52:00,302 p=164487 u=morteza n=ansible | TASK [mariadb : Create databases sudoer_net] *****************************************************************************************************************
2023-06-05 17:52:01,172 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:52:01,188 p=164487 u=morteza n=ansible | TASK [mariadb : configuring users] ***************************************************************************************************************************
2023-06-05 17:52:01,220 p=164487 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/users.yml for db.sudoer.net => (item={'name': 'sudoer_user', 'priv': ['sudoer_net.*:ALL,GRANT']})
2023-06-05 17:52:01,228 p=164487 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 17:52:01,934 p=164487 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:52:01,942 p=164487 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 17:52:01,957 p=164487 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:52:01,967 p=164487 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf sudoer_user] *******************************************************************************************************************
2023-06-05 17:52:01,981 p=164487 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:52:01,989 p=164487 u=morteza n=ansible | TASK [mariadb : Create database user "sudoer_user"] **********************************************************************************************************
2023-06-05 17:52:02,007 p=164487 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=sudoer_net.*:ALL,GRANT) 
2023-06-05 17:52:02,008 p=164487 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:52:02,041 p=164487 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 17:52:02,051 p=164487 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:52:04,185 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:04,350 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:04,391 p=164487 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:52:06,675 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:52:06,852 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:52:06,860 p=164487 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:52:10,257 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:10,679 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:10,699 p=164487 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 17:52:11,709 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:11,858 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:11,873 p=164487 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 17:52:13,338 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:13,370 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:13,390 p=164487 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 17:52:14,179 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:14,180 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:14,199 p=164487 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 17:52:15,432 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 17:52:15,526 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 17:52:16,638 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-05 17:52:16,859 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-05 17:52:16,893 p=164487 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:52:19,131 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:52:19,612 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:52:19,622 p=164487 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 17:52:23,061 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:23,290 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:23,311 p=164487 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 17:52:24,646 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:24,721 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:24,742 p=164487 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-05 17:52:27,062 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 17:52:27,083 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 17:52:27,097 p=164487 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-05 17:52:30,893 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:30,928 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:30,948 p=164487 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-05 17:52:31,641 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 17:52:31,697 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 17:52:32,421 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 17:52:32,475 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 17:52:32,485 p=164487 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-05 17:52:33,765 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:33,813 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:33,820 p=164487 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-05 17:52:33,860 p=164487 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-05 17:52:33,867 p=164487 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 17:52:35,077 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:35,168 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:35,178 p=164487 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 17:52:36,470 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:36,498 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:36,527 p=164487 u=morteza n=ansible | TASK [php-fpm : Install the latest version packages] *********************************************************************************************************
2023-06-05 17:52:38,891 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 17:52:39,057 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 17:52:39,077 p=164487 u=morteza n=ansible | TASK [php-fpm : Update all packages] *************************************************************************************************************************
2023-06-05 17:52:42,631 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:43,619 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:43,635 p=164487 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-05 17:52:43,675 p=164487 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'db.sudoer.net', 'db_charset': 'utf8'})
2023-06-05 17:52:43,682 p=164487 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-05 17:52:44,497 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:44,513 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:44,525 p=164487 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-05 17:52:45,289 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:45,315 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:45,325 p=164487 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-05 17:52:45,345 p=164487 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 17:52:45,357 p=164487 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 17:52:45,369 p=164487 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-05 17:52:45,389 p=164487 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 17:52:45,399 p=164487 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 17:52:45,411 p=164487 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-05 17:52:46,392 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 17:52:46,396 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 17:52:46,413 p=164487 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-05 17:52:47,345 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 17:52:47,347 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 17:52:47,356 p=164487 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-05 17:52:48,669 p=164487 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:52:48,726 p=164487 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:52:48,788 p=164487 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 17:52:48,788 p=164487 u=morteza n=ansible | app1.sudoer.net            : ok=25   changed=0    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-06-05 17:52:48,788 p=164487 u=morteza n=ansible | app2.sudoer.net            : ok=25   changed=0    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-06-05 17:52:48,788 p=164487 u=morteza n=ansible | db.sudoer.net              : ok=20   changed=0    unreachable=0    failed=0    skipped=6    rescued=0    ignored=0   
2023-06-05 17:55:55,341 p=165484 u=morteza n=ansible | PLAY [db] ****************************************************************************************************************************************************
2023-06-05 17:55:55,354 p=165484 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:55:57,789 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:55:57,817 p=165484 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:56:00,437 p=165484 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:56:00,458 p=165484 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:56:04,250 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:56:04,268 p=165484 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 17:56:05,566 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:56:05,577 p=165484 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 17:56:07,164 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:56:07,171 p=165484 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 17:56:07,822 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:56:07,828 p=165484 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 17:56:09,303 p=165484 u=morteza n=ansible | ok: [db.sudoer.net] => (item=setup.sh)
2023-06-05 17:56:10,555 p=165484 u=morteza n=ansible | ok: [db.sudoer.net] => (item=config)
2023-06-05 17:56:10,588 p=165484 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:56:13,419 p=165484 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:56:13,440 p=165484 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 17:56:17,145 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:56:17,166 p=165484 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 17:56:18,523 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:56:18,557 p=165484 u=morteza n=ansible | TASK [mariadb : set sysctl] **********************************************************************************************************************************
2023-06-05 17:56:19,449 p=165484 u=morteza n=ansible | ok: [db.sudoer.net] => (item={'name': 'net.ipv4.ip_forward', 'value': '0'})
2023-06-05 17:56:19,473 p=165484 u=morteza n=ansible | TASK [mariadb : Install the latest version packages] *********************************************************************************************************
2023-06-05 17:56:21,848 p=165484 u=morteza n=ansible | ok: [db.sudoer.net] => (item=['mariadb-server', 'mariadb-client', 'python3-mysqldb', 'percona-toolkit'])
2023-06-05 17:56:21,873 p=165484 u=morteza n=ansible | TASK [mariadb : Update all packages] *************************************************************************************************************************
2023-06-05 17:56:26,040 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:56:26,061 p=165484 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 17:56:26,767 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:56:26,788 p=165484 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 17:56:26,809 p=165484 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:56:26,817 p=165484 u=morteza n=ansible | TASK [mariadb : Removes anonymous users] *********************************************************************************************************************
2023-06-05 17:56:27,687 p=165484 u=morteza n=ansible | ok: [db.sudoer.net] => (item=127.0.0.1)
2023-06-05 17:56:28,473 p=165484 u=morteza n=ansible | ok: [db.sudoer.net] => (item=localhost)
2023-06-05 17:56:28,502 p=165484 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ instance.name }}] ***********************************************************************************************************
2023-06-05 17:56:28,517 p=165484 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:56:28,525 p=165484 u=morteza n=ansible | TASK [mariadb : Update MariaDB root password] ****************************************************************************************************************
2023-06-05 17:56:28,541 p=165484 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=127.0.0.1) 
2023-06-05 17:56:28,542 p=165484 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=localhost) 
2023-06-05 17:56:28,543 p=165484 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:56:28,550 p=165484 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf {{ user.name }}] ***************************************************************************************************************
2023-06-05 17:56:29,837 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:56:29,844 p=165484 u=morteza n=ansible | TASK [mariadb : configuring instances] ***********************************************************************************************************************
2023-06-05 17:56:29,874 p=165484 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/database.yml for db.sudoer.net => (item={'name': 'sudoer_net'})
2023-06-05 17:56:29,886 p=165484 u=morteza n=ansible | TASK [mariadb : Create databases sudoer_net] *****************************************************************************************************************
2023-06-05 17:56:30,770 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:56:30,790 p=165484 u=morteza n=ansible | TASK [mariadb : configuring users] ***************************************************************************************************************************
2023-06-05 17:56:30,829 p=165484 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/mariadb/tasks/users.yml for db.sudoer.net => (item={'name': 'sudoer_user', 'priv': ['sudoer_net.*:ALL,GRANT']})
2023-06-05 17:56:30,837 p=165484 u=morteza n=ansible | TASK [mariadb : check if config file exist] ******************************************************************************************************************
2023-06-05 17:56:31,528 p=165484 u=morteza n=ansible | ok: [db.sudoer.net]
2023-06-05 17:56:31,534 p=165484 u=morteza n=ansible | TASK [mariadb : Generate mysql root pass] ********************************************************************************************************************
2023-06-05 17:56:31,554 p=165484 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:56:31,562 p=165484 u=morteza n=ansible | TASK [mariadb : mysql .my.cnf sudoer_user] *******************************************************************************************************************
2023-06-05 17:56:31,576 p=165484 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:56:31,584 p=165484 u=morteza n=ansible | TASK [mariadb : Create database user "sudoer_user"] **********************************************************************************************************
2023-06-05 17:56:31,605 p=165484 u=morteza n=ansible | skipping: [db.sudoer.net] => (item=sudoer_net.*:ALL,GRANT) 
2023-06-05 17:56:31,606 p=165484 u=morteza n=ansible | skipping: [db.sudoer.net]
2023-06-05 17:56:31,634 p=165484 u=morteza n=ansible | PLAY [app] ***************************************************************************************************************************************************
2023-06-05 17:56:31,644 p=165484 u=morteza n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************************
2023-06-05 17:56:33,716 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:56:34,015 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:56:34,041 p=165484 u=morteza n=ansible | TASK [iptables : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:56:36,639 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:56:36,892 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['htop', 'net-tools', 'iptables-persistent', 'vim'])
2023-06-05 17:56:36,916 p=165484 u=morteza n=ansible | TASK [iptables : Update all packages] ************************************************************************************************************************
2023-06-05 17:56:40,577 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:56:41,109 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:56:41,115 p=165484 u=morteza n=ansible | TASK [iptables : reload iptables] ****************************************************************************************************************************
2023-06-05 17:56:42,401 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:56:42,495 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:56:42,515 p=165484 u=morteza n=ansible | TASK [iptables : iptables config] ****************************************************************************************************************************
2023-06-05 17:56:43,870 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:56:43,902 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:56:43,911 p=165484 u=morteza n=ansible | TASK [iptables : Create directory if it does not exist] ******************************************************************************************************
2023-06-05 17:56:44,639 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:56:44,669 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:56:44,676 p=165484 u=morteza n=ansible | TASK [iptables : Copy internal scripts] **********************************************************************************************************************
2023-06-05 17:56:45,972 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=setup.sh)
2023-06-05 17:56:46,052 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=setup.sh)
2023-06-05 17:56:47,285 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=config)
2023-06-05 17:56:47,412 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=config)
2023-06-05 17:56:47,437 p=165484 u=morteza n=ansible | TASK [fail2ban : Install the latest version packages] ********************************************************************************************************
2023-06-05 17:56:49,756 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:56:49,858 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['fail2ban'])
2023-06-05 17:56:49,879 p=165484 u=morteza n=ansible | TASK [fail2ban : Update all packages] ************************************************************************************************************************
2023-06-05 17:56:53,355 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:56:53,525 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:56:53,545 p=165484 u=morteza n=ansible | TASK [fail2ban : fail2ban config for ssh] ********************************************************************************************************************
2023-06-05 17:56:54,846 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:56:54,905 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:56:54,931 p=165484 u=morteza n=ansible | TASK [nginx : Install the latest version packages] ***********************************************************************************************************
2023-06-05 17:56:57,522 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 17:56:57,636 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['nginx', 'certbot', 'python3-certbot-nginx'])
2023-06-05 17:56:57,659 p=165484 u=morteza n=ansible | TASK [nginx : Update all packages] ***************************************************************************************************************************
2023-06-05 17:57:01,163 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:57:01,174 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:57:01,190 p=165484 u=morteza n=ansible | TASK [nginx : Create directory if it does not exist] *********************************************************************************************************
2023-06-05 17:57:01,962 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 17:57:01,964 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/nginx/specific-conf.d/)
2023-06-05 17:57:02,620 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 17:57:02,708 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=/etc/systemd/system/nginx.service.d/)
2023-06-05 17:57:02,718 p=165484 u=morteza n=ansible | TASK [nginx : nginx config for {{ instance.domain }}] ********************************************************************************************************
2023-06-05 17:57:04,027 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:57:04,174 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:57:04,192 p=165484 u=morteza n=ansible | TASK [nginx : configuring instances] *************************************************************************************************************************
2023-06-05 17:57:04,277 p=165484 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/nginx/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'domain': 'app.sudoer.net', 'email': 'morteza.bashsiz@gmail.com', 'root': '/home/www-data/app.sudoer.net/www/wordpress'})
2023-06-05 17:57:04,289 p=165484 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 17:57:05,719 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:57:05,813 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:57:05,837 p=165484 u=morteza n=ansible | TASK [nginx : nginx config for app.sudoer.net] ***************************************************************************************************************
2023-06-05 17:57:07,244 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:57:07,326 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:57:07,340 p=165484 u=morteza n=ansible | TASK [php-fpm : Install the latest version packages] *********************************************************************************************************
2023-06-05 17:57:09,718 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 17:57:09,730 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net] => (item=['php7.4-fpm', 'php7.4-mysql', 'php7.4-gd'])
2023-06-05 17:57:09,753 p=165484 u=morteza n=ansible | TASK [php-fpm : Update all packages] *************************************************************************************************************************
2023-06-05 17:57:13,271 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:57:13,324 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:57:13,356 p=165484 u=morteza n=ansible | TASK [wordpress : configuring instances] *********************************************************************************************************************
2023-06-05 17:57:13,404 p=165484 u=morteza n=ansible | included: /home/morteza/data/git/MortezaBashsiz/YouTube/Ansible/roles/wordpress/tasks/instances.yml for app1.sudoer.net, app2.sudoer.net => (item={'name': 'app.sudoer.net', 'db': 'sudoer_net', 'db_user': 'sudoer_user', 'db_host': 'db.sudoer.net', 'db_charset': 'utf8'})
2023-06-05 17:57:13,411 p=165484 u=morteza n=ansible | TASK [wordpress : check if www dir exists app.sudoer.net] ****************************************************************************************************
2023-06-05 17:57:14,171 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:57:14,185 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:57:14,207 p=165484 u=morteza n=ansible | TASK [wordpress : Create home directory for instance app.sudoer.net] *****************************************************************************************
2023-06-05 17:57:14,923 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:57:14,947 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:57:14,966 p=165484 u=morteza n=ansible | TASK [wordpress : Unarchive wordpress latest] ****************************************************************************************************************
2023-06-05 17:57:14,988 p=165484 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 17:57:14,997 p=165484 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 17:57:15,005 p=165484 u=morteza n=ansible | TASK [wordpress : change owner of wordpress instance app.sudoer.net] *****************************************************************************************
2023-06-05 17:57:15,019 p=165484 u=morteza n=ansible | skipping: [app1.sudoer.net]
2023-06-05 17:57:15,026 p=165484 u=morteza n=ansible | skipping: [app2.sudoer.net]
2023-06-05 17:57:15,033 p=165484 u=morteza n=ansible | TASK [wordpress : check if config file exists app.sudoer.net] ************************************************************************************************
2023-06-05 17:57:16,096 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 17:57:16,101 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 17:57:16,125 p=165484 u=morteza n=ansible | TASK [wordpress : Get wp pass] *******************************************************************************************************************************
2023-06-05 17:57:17,207 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net -> db.sudoer.net]
2023-06-05 17:57:17,211 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net -> db.sudoer.net]
2023-06-05 17:57:17,226 p=165484 u=morteza n=ansible | TASK [wordpress : wordpress config file] *********************************************************************************************************************
2023-06-05 17:57:18,627 p=165484 u=morteza n=ansible | ok: [app1.sudoer.net]
2023-06-05 17:57:18,631 p=165484 u=morteza n=ansible | ok: [app2.sudoer.net]
2023-06-05 17:57:18,692 p=165484 u=morteza n=ansible | PLAY RECAP ***************************************************************************************************************************************************
2023-06-05 17:57:18,692 p=165484 u=morteza n=ansible | app1.sudoer.net            : ok=25   changed=0    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-06-05 17:57:18,692 p=165484 u=morteza n=ansible | app2.sudoer.net            : ok=25   changed=0    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2023-06-05 17:57:18,692 p=165484 u=morteza n=ansible | db.sudoer.net              : ok=20   changed=0    unreachable=0    failed=0    skipped=6    rescued=0    ignored=0   
